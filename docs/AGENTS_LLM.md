# –ê–≥–µ–Ω—Ç—ã —Å LLM - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏–∑ —Ç—Ä–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (LLM) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤—Å—Ç—Ä–µ—á–∏
        ‚Üì
[1] Process Extractor (LLM) ‚Üí AS-IS –ø—Ä–æ—Ü–µ—Å—Å (JSON)
        ‚Üì
[2] Architect Agent (LLM + MCP) ‚Üí –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Ç–µ–∫—Å—Ç)
        ‚Üì
[3] Scope Agent (LLM) ‚Üí –ö—Ä–∞—Ç–∫–æ–µ –¢–ó (—Ç–µ–∫—Å—Ç)
```

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –î–ª—è OpenAI
pip install openai

# –î–ª—è Anthropic
pip install anthropic
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```env
# OpenAI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
OPENAI_API_KEY=sk-...

# –ò–ª–∏ Anthropic
ANTHROPIC_API_KEY=sk-ant-...

# –í—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
LLM_PROVIDER=openai  # –∏–ª–∏ anthropic
LLM_MODEL=gpt-4o-mini  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

## üß© –ê–≥–µ–Ω—Ç—ã

### 1. Process Extractor

**–†–æ–ª—å:** –ê–Ω–∞–ª–∏—Ç–∏–∫, –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ö–∞–æ—Å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É

**–í—Ö–æ–¥:** –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤—Å—Ç—Ä–µ—á–∏ (—Ç–µ–∫—Å—Ç)

**–í—ã—Ö–æ–¥:** –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π AS-IS –ø—Ä–æ—Ü–µ—Å—Å (JSON)

**–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞:**
```json
{
  "process_name": "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤",
  "goal": "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è",
  "actors": [
    {"name": "–ú–µ–Ω–µ–¥–∂–µ—Ä", "role": "–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä"}
  ],
  "entities": [
    {"name": "–î–æ–≥–æ–≤–æ—Ä", "description": "–î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è"}
  ],
  "steps": [
    {
      "id": "AS1",
      "actor": "–ú–µ–Ω–µ–¥–∂–µ—Ä",
      "action": "–°–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫—É –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ",
      "input": "–î–æ–≥–æ–≤–æ—Ä",
      "output": "–ó–∞—è–≤–∫–∞",
      "business_rules": [],
      "timeframe": "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
      "next": "AS2",
      "source_fragment": "–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫—É..."
    }
  ],
  "pain_points": ["–í—Å–µ –¥–µ–ª–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é"]
}
```

### 2. Architect Agent

**–†–æ–ª—å:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä ELMA365

**–í—Ö–æ–¥:** AS-IS –ø—Ä–æ—Ü–µ—Å—Å

**–í—ã—Ö–æ–¥:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç MCP –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ELMA365
- –û–±–æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –≤—ã–±–æ—Ä
- –ù–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∏—á–µ–≥–æ —Å–≤–µ—Ä—Ö AS-IS

**–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞:**
```
–ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –†–ï–®–ï–ù–ò–ï

1. –û–±—â–∏–π –ø—Ä–∏–Ω—Ü–∏–ø —Ä–µ—à–µ–Ω–∏—è
...

2. –°—É—â–Ω–æ—Å—Ç–∏ ELMA365
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –î–æ–≥–æ–≤–æ—Ä—ã ‚Äî –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
- –ë–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ ‚Äî –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
...

3. –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞
...

4. –í–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏
...

5. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞
...
```

### 3. Scope Agent

**–†–æ–ª—å:** –ü–æ–¥—Ä—è–¥—á–∏–∫, –ø–∏—à–µ—Ç –∫—Ä–∞—Ç–∫–æ–µ –¢–ó

**–í—Ö–æ–¥:** AS-IS –ø—Ä–æ—Ü–µ—Å—Å + –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–í—ã—Ö–æ–¥:** –ö—Ä–∞—Ç–∫–æ–µ –¢–ó –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è (—Ç–µ–∫—Å—Ç)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–æ—Ä–º–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
- 1-2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ù–µ –≤–∫–ª—é—á–∞–µ—Ç –¥–∏–∑–∞–π–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, –ø–æ–ª—è —Ñ–æ—Ä–º, TO-BE –ø—Ä–æ—Ü–µ—Å—Å—ã

**–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞:**
```
–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï –î–õ–Ø –°–û–ì–õ–ê–°–û–í–ê–ù–ò–Ø

1. –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
...

2. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (AS-IS)
...

3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è
...

4. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
...

5. –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞
...

6. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
...
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω

```bash
POST /api/agents/full-pipeline
```

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "transcript": "–£ –Ω–∞—Å –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤. –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫—É, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä—É..."
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "as_is": {
    "process_name": "–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤",
    "steps": [...],
    ...
  },
  "architecture": "–ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –†–ï–®–ï–ù–ò–ï\n\n1. –û–±—â–∏–π –ø—Ä–∏–Ω—Ü–∏–ø...",
  "scope": "–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï –î–õ–Ø –°–û–ì–õ–ê–°–û–í–ê–ù–ò–Ø\n\n1. –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞...",
  "metadata": {
    "extraction": {...},
    "architecture": {...},
    "scope": {...}
  }
}
```

### –û—Ç–¥–µ–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã

```bash
# –¢–æ–ª—å–∫–æ Process Extractor
POST /api/agents/process-extract
{
  "transcript": "..."
}
```

## üîß MCP Integration

–ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

```python
# –í –ø—Ä–æ–º–ø—Ç–µ –∞–≥–µ–Ω—Ç–∞
MCP.request("–Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é –æ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö")
MCP.request("–Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö ELMA365")
```

MCP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

## üìù –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `app/agents/prompts.py`:

- `PROCESS_EXTRACTOR_SYSTEM_PROMPT`
- `ARCHITECT_AGENT_SYSTEM_PROMPT`
- `SCOPE_AGENT_SYSTEM_PROMPT`

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LLM

### –í—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

```python
from app.agents.llm_client import LLMClient

# OpenAI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
client = LLMClient(provider="openai", model="gpt-4o-mini")

# Anthropic
client = LLMClient(provider="anthropic", model="claude-3-haiku-20240307")
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```python
response = await client.generate(
    system_prompt="...",
    user_prompt="...",
    temperature=0.3,  # –ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
    max_tokens=4000
)
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ LLM –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ –∑–∞–≥–ª—É—à–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –æ—à–∏–±–∫–æ–π.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ API –∫–ª—é—á –≤ `.env`
2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (`openai` –∏–ª–∏ `anthropic`)
3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —É–∫–∞–∑–∞–Ω `LLM_PROVIDER`

## üìä –ü—Ä–∏–º–µ—Ä—ã

–°–º. `examples/agents/` –¥–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞.

