{
  "doc_id": "worker-pools",
  "url": "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/worker-pools.html",
  "title": "Настройка отдельных пулов worker для обработки скриптов",
  "breadcrumbs": [
    "ELMA365 On-Premises"
  ],
  "section": "ELMA365 On-Premises | [business_solutions]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>Настройка отдельных пулов worker для обработки скриптов</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"В ELMA365 за валидацию, компиляцию и исполнение серверных скриптов отвечает сервис worker. Чтобы повысить его производительность, вы можете выделить отдельные пулы исполнения:\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/worker-pools.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p><a href=\"elma365-on-premises.html\">ELMA365 On-Premises</a> &gt; Администрирование ELMA365 Enterprise / Настройка отдельных пулов worker для обработки скриптов</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Настройка отдельных пулов worker для обработки скриптов</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p style=\"margin: 19px 0 19px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">В ELMA365 за валидацию, компиляцию и исполнение серверных скриптов отвечает сервис </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">. Чтобы повысить его производительность, вы можете выделить отдельные пулы исполнения:</span></p>\n<ul style=\"\">\n<li style=\"margin-top: 19px; margin-right: 0; margin-bottom: 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">для структур системы, где инициируются скрипты. Например, для скриптов виджетов или определённого бизнес-процесса;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 19px;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">для отдельных типов запросов на обработку скриптов. Например, для их публикации или исполнения.</span></li></ul>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало внимание</span></p>\n<p style=\"margin: 0 0 19px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">Настройка отдельных пулов </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> доступна для поставки ELMA365 On‑Premises Enterprise начиная с версии 2025.6.</span></p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец внимание</span></p>\n<p style=\"margin: 0 0 19px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">В статье рассмотрим, как в системе:</span></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 19px;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"><a class=\"topiclink\" href=\"worker-pools.html#script-processing\">обрабатываются скрипты</a>;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 19px;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"><a class=\"topiclink\" href=\"worker-pools.html#configure-pools\">настроить отдельные пулы worker для определённых скриптов</a>.</span></li></ul>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"script-processing\"></a><span class=\"f_Heading2\">Алгоритм обработки скриптов в сервисе worker </span></h2>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Для распределения нагрузки на сервис </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> используются инструменты:</span></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Kubernetes</span><span style=\"font-size: 13px; font-family: 'Times New Roman',Times,Georgia,serif; color: #394149;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— обеспечивает масштабирование экземпляров сервиса, в которых выполняются скрипты;</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">RabbitMQ — выступает в качестве маршрутизатора, распределяя запросы на выполнение скриптов между доступными экземплярами </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ul>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">При стандартной конфигурации </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> запросы на обработку скриптов поступают в RabbitMQ и распределяются в рамках общей очереди. Это повышает нагрузку на сервис и замедляет выполнение скриптов.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Настройка отдельных пулов для скриптов определённого типа помогает оптимизировать распределение этой нагрузки. </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">После такой настройки :</span></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 19px; margin-right: 0; margin-bottom: 19px;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">в Kubernetes </span><span style=\"font-size: 13px; font-family: 'Times New Roman',Times,Georgia,serif; color: #394149;\">—</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> </span><span style=\"font-size: 13px; font-family: 'Times New Roman',Times,Georgia,serif; color: #394149;\">передаются данные, по которым будут разворачиваться пулы;</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">в RabbitMQ</span><span style=\"font-size: 13px; font-family: 'Times New Roman',Times,Georgia,serif; color: #394149;\"> —</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> автоматически добавляется отдельная очередь для каждого настроенного пула.</span></li></ul>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Рассмотрим подробнее, как происходит маршрутизация запросов на скрипты:</span></p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Определение ключа маршрутизации</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ol>\n<p style=\"background: #ffffff; margin: 0 0 0 34px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">При запуске скрипта автоматически формируется запрос, содержащий его параметры: имя компании, публикация или исполнение скрипта, структура системы, из которой направлен скрипт, и т. д. На основе этих данных вычисляется ключ маршрутизации:</span></p>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">если вы <a class=\"topiclink\" href=\"worker-pools.html#configure-pools\">настроили для определённых скриптов отдельные пулы</a>, запросу присваивается ключ, равный идентификатору пула </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">;</span></li><li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">если подходящего пула нет </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">—</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> присваивается ключ </span><code><b>default</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ul></ul>\n<ol start=\"2\" style=\"list-style-type:decimal\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Распределение запросов</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ol>\n<p style=\"background: #ffffff; margin: 0 0 0 34px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Запросы с присвоенным ключом поступают в RabbitMQ, где происходит их маршрутизация:</span></p>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">если вы задали для отдельных скриптов свои пулы </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">, в RabbitMQ</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">автоматически создаются очереди для таких пулов. Запросы распределятся в эту очередь по присвоенному ключу;</span></li><li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">запросы с ключом</span> <code><b>default</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">  попадают в общую очередь </span><code><b>script.default</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ul></ul>\n<ol start=\"3\" style=\"list-style-type:decimal\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Обработка запросов</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 34px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Из очередей запросы распределяются между экземплярами </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></p>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">из выделенных очередей запросы на обработку скриптов передаются на настроенные пулы </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">;</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">из очереди </span><code><b>script.default</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\"> </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">— распределяются между общими экземплярами </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ul></ul>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"configure-pools\"></a><span class=\"f_Heading2\">Настроить пулы worker</span></h2>\n<p style=\"margin: 19px 0 19px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">Настройка пулов </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> состоит из двух этапов:</span></p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"margin-top: 19px; margin-right: 0; margin-bottom: 19px;\" value=\"1\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"><a class=\"topiclink\" href=\"worker-pools.html#pool-parameters\">Задать конфигурацию пулов worker</a>.</span></li><li style=\"margin-top: 19px; margin-right: 0; margin-bottom: 19px;\" value=\"2\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"><a class=\"topiclink\" href=\"worker-pools.html#apply-pool-parameters\">Применить настроенную конфигурацию</a>.</span></li></ol>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"pool-parameters\"></a><span class=\"f_Heading3\">Шаг 1. Задать конфигурацию пулов worker</span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">Чтобы создать отдельный пул </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> для определённых скриптов, в файле </span><code><b>values-elma365.yaml</b></code><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> задайте его конфигурацию. В ней определите критерии отбора скриптов, параметры автомасштабирования экземпляров в пуле, а также время ожидания выполнения скриптов.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">Для этого:</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Создайте резервную копию файла </span><code><b>values-elma365.yaml</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">, заполненного при установке ELMA365. Это требуется перед редактированием, так как некорректная настройка параметров может привести к сбоям в работе приложения ELMA365.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">В конфигурационном файле </span><code><b>values-elma365.yaml</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> перейдите к блоку </span><code><b>global</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> и заполните параметры в секции </span><code><b>workerPoolCfg</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало примечание</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Пример настройки параметров в секции workerPoolCfg</span></p>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">global:</span><br/>\n<span class=\"f_CodeExample\">   workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">     pools:</span><br/>\n<span class=\"f_CodeExample\">       namespacepool: # Наименование пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов </span><br/>\n<span class=\"f_CodeExample\">         sources: # Фильтры для отбора скриптов, которые будут распределяться на пул</span><br/>\n<span class=\"f_CodeExample\">         - company: head</span><br/>\n<span class=\"f_CodeExample\">           operation: execute</span><br/>\n<span class=\"f_CodeExample\">           type: process</span><br/>\n<span class=\"f_CodeExample\">           namespace: crm</span><br/>\n<span class=\"f_CodeExample\">           code: createlead</span><br/>\n<span class=\"f_CodeExample\">         autoscaling: # Параметры автомасштабирования для пула</span><br/>\n<span class=\"f_CodeExample\">           enabled: true</span><br/>\n<span class=\"f_CodeExample\">           type: \"hpa\"</span><br/>\n<span class=\"f_CodeExample\">           minReplicas: 1</span><br/>\n<span class=\"f_CodeExample\">           maxReplicas: 9</span><br/>\n<span class=\"f_CodeExample\">         options: # Дополнительные опции для пула — таймауты</span><br/>\n<span class=\"f_CodeExample\">           defaultScriptTimeoutSeconds: 180</span><br/>\n<span class=\"f_CodeExample\">           maxScriptTimeoutSeconds: 1200</span></p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец примечание</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 9px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Для этого укажите:</span></p>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Идентификатор пула</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> (</span><code><b>pools</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">) — наименование пула </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">. Задайте пользовательское название для пула, используя строчные латинские буквы и цифры длиной до 20 символов.</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\" value=\"2\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Источники запросов на обработку скриптов</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> (</span><code><b>sources</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">). </span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> </span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Когда в системе запускается скрипт, автоматически генерируется запрос на его обработку. В этом запросе передаются параметры скрипта. Укажите, по каким параметрам отбирать скрипты для настраиваемого пула:</span></li></ol>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>сompany</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — имя компании в кластере;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>operation</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — тип запроса: публикация или исполнение скрипта. Добавьте одно из доступных значений: </span><code><b>compile</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> или</span><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><code><b>execute</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">. Например, обрабатывать только публикацию скриптов, указав конфигурацию: </span></li></ul></ul>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">   pools:</span><br/>\n<span class=\"f_CodeExample\">     publishpool:</span><br/>\n<span class=\"f_CodeExample\">       sources:</span><br/>\n<span class=\"f_CodeExample\">       - operation: compile</span></p>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>type</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — структура системы, из которой направлен запрос на обработку скрипта. Укажите одно из доступных значений:</span><ul style=\"list-style-type:square\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>process</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— бизнес-процесс;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>customactivity</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— действие БП в модуле;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>widget</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— виджет;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>eventhandler</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— обработчик события;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>apihandler</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— обработчик методов API;</span></li></ul>\n</li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>namespace</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — название пространства имён для структуры системы, из которой направлен запрос на обработку скрипта. Например, для раздела — это его код;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><code><b>code</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — код структуры системы, из которой направлен запрос на обработку скрипта. Например, код бизнес-процесса, действия БП в модуле и т. д.</span></li></ul></ul>\n<p style=\"margin: 0 0 0 124px;\"><span style=\"font-size: 13px; color: #000000;\"> </span></p>\n<p style=\"margin: 0 0 0 7px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Чем больше условий задано, тем точнее отбор скриптов для пула. Если параметр не заполнен, он не учитывается.</span></p>\n<p style=\"margin: 0 0 0 8px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"><a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A1')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Примеры конфигураций для отбора скриптов</a></span></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A1\" style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 104px;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p style=\"margin: 0 0 0 76px;\"><span style=\"font-size: 13px; color: #000000;\"> </span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Рассмотрим варианты настройки пулов, демонстрирующие разные уровни отбора скриптов:</span></p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\" value=\"1\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Самый широкий охват — на выделенном пуле </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> публикуются и исполняются все скрипты раздела </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">CRM</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">   pools:</span><br/>\n<span class=\"f_CodeExample\">     namespacepool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов</span><br/>\n<span class=\"f_CodeExample\">       sources:</span><br/>\n<span class=\"f_CodeExample\">       - company: head # Имя компании</span><br/>\n<span class=\"f_CodeExample\">         namespace: crm # Код раздела</span></p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\" value=\"2\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Умеренный отбор — на выделенном пуле </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">исполняются скрипты только из бизнес-процессов раздела </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">CRM</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">   pools:</span><br/>\n<span class=\"f_CodeExample\">     namespacepool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов</span><br/>\n<span class=\"f_CodeExample\">       sources:</span><br/>\n<span class=\"f_CodeExample\">       - company: head # Имя компании</span><br/>\n<span class=\"f_CodeExample\">         namespace: crm # Код раздела</span><br/>\n<span class=\"f_CodeExample\">         operation: execute # Тип операции — исполнение скриптов</span><br/>\n<span class=\"f_CodeExample\">         type: process # Отбираются только скрипты из бизнес-процессов</span></p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\" value=\"3\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Более точный отбор — на выделенном пуле </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">исполняются скрипты бизнес-процессов, созданных на уровне приложения с кодом </span><code><b>clientapp</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> из раздела </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">CRM</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">   pools:</span><br/>\n<span class=\"f_CodeExample\">     applicationpool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов</span><br/>\n<span class=\"f_CodeExample\">       sources:</span><br/>\n<span class=\"f_CodeExample\">       - company: head # Имя компании</span><br/>\n<span class=\"f_CodeExample\">         namespace: crm.clientapp # `{код раздела}.{код приложения}`</span><br/>\n<span class=\"f_CodeExample\">         operation: execute # Тип операции — исполнение скриптов</span><br/>\n<span class=\"f_CodeExample\">         type: process # Отбираются только скрипты из бизнес-процессов</span></p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\" value=\"4\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Максимально точный отбор — на выделенном пуле </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">исполняются скрипты только из бизнес-процесса </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Создание лида</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">   pools:</span><br/>\n<span class=\"f_CodeExample\">     processpool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов</span><br/>\n<span class=\"f_CodeExample\">       sources:</span><br/>\n<span class=\"f_CodeExample\">       - company: head # Имя компании</span><br/>\n<span class=\"f_CodeExample\">         namespace: crm.clientapp # `{код раздела}.{код приложения}`</span><br/>\n<span class=\"f_CodeExample\">         operation: execute # Тип операции — исполнение скриптов</span><br/>\n<span class=\"f_CodeExample\">         type: process # Отбираются только скрипты из бизнес-процесса</span><br/>\n<span class=\"f_CodeExample\">         code: createlead # Код бизнес-процесса, из которого отбираются скрипты</span></p>\n</td>\n</tr>\n</table>\n</div>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Параметры для автомасштабирования пула </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">(</span><code><b>autoscaling</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\">)</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> </span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">В зависимости от нагрузки на пул </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">, задайте настройки для его автоматического масштабирования. На их основе в оркестраторе Kubernetes будет создаваться указанное количество экземпляров </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">. Для этого заполните параметры в блоке </span><code><b>autoscaling</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></li></ol>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>enabled</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— значение </span><code><b>true</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> включает автомасштабирование;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>type</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — выбор метода автомасштабирования. Определите, какой инструмент использовать. Доступные значения: </span><ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>\"hpa\"</b></code><span style=\"font-size: 13px; font-family: Cambria; color: #394149;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— </span><span style=\"font-size: 13px; font-family: Cambria; color: #394149;\">Horizontal Pod Autoscaler.</span><span style=\"font-size: 13px; font-family: Inter; color: #394149;\"> </span><span style=\"font-size: 13px; font-family: Cambria; color: #394149;\">Используется</span><span style=\"font-size: 13px; font-family: Inter; color: #394149;\"> </span><span style=\"font-size: 13px; font-family: Cambria; color: #394149;\">по</span><span style=\"font-size: 13px; font-family: Inter; color: #394149;\"> </span><span style=\"font-size: 13px; font-family: Cambria; color: #394149;\">умолчанию. Не требуется дополнительных настроек;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>\"keda\"</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— </span><span style=\"font-size: 13px; font-family: Cambria; color: #394149;\">Kubernetes Event-driven Autoscaling. Используется, если настроен дополнительный компонент </span><span style=\"font-size: 13px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #3f8fc8;\"><a class=\"topiclink\" href=\"install-keda.html\">KEDA</a></span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">;</span></li></ul>\n</li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>minReplicas</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— минимальное количество экземпляров в пуле;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>maxReplicas</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— максимальное количество экземпляров в пуле.</span></li></ul></ul>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">Дополнительные опции для пула  </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">(</span><code><b>options</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\">)</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> </span><br/>\n<span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Для серверных скриптов существует время ожидания их исполнения — таймаут. Если скрипт не выполнился в течение этого времени, он прерывается. Таким образом работа пула не блокируется из‑за долгого выполнения скриптов. Для установки таймаутов в секции </span><code><b>options</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> заполните параметры:</span></li></ol>\n<ul style=\"list-style-type:disc\"><ul style=\"list-style-type:circle\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>defaultScriptTimeoutSeconds</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">— стандартное время ожидания исполнения скрипта в секундах. После истечения этого времени исполнение скрипта прерывается;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>maxScriptTimeoutSeconds</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> — максимальное время ожидания исполнения скрипта в секундах. После истечения этого времени исполнение скрипта прерывается. </span></li></ul></ul>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"apply-pool-parameters\"></a><span class=\"f_Heading3\">Шаг 2. Применить настроенную конфигурацию пулов worker</span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">Когда в файле </span><code><b>values-elma365.yaml</b></code><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> вы задали конфигурацию для отбора скриптов и для автомасштабировния пулов </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">, </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif; color: #0000ff;\"><a class=\"topiclink\" href=\"change-settings-enterprise.html#apply-new-parameters\">примените обновлённые параметры</a></span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">. </span></p>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Пример настройки отдельного пула для обработки скриптов бизнес-процесса</span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Допустим, в </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">файле </span><code><b>values-elma365.yaml</b></code><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">мы настроили отдельный пул </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> для бизнес-процесса по созданию лида в разделе </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">CRM</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">:</span></p>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">workerPoolCfg:</span><br/>\n<span class=\"f_CodeExample\">   pools:</span><br/>\n<span class=\"f_CodeExample\">     processpool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов</span><br/>\n<span class=\"f_CodeExample\">       sources:</span><br/>\n<span class=\"f_CodeExample\">       - company: head # Имя компании</span><br/>\n<span class=\"f_CodeExample\">         namespace: crm # Код раздела, на уровне которого создан бизнес-процесс</span><br/>\n<span class=\"f_CodeExample\">         operation: execute # Тип операции — исполнение скриптов</span><br/>\n<span class=\"f_CodeExample\">         type: process # Отбираются только скрипты из бизнес-процесса</span><br/>\n<span class=\"f_CodeExample\">         code: createlead # Отбираются только скрипты с кодом бизнес-процесса для создания лида</span><br/>\n<span class=\"f_CodeExample\">       autoscaling: </span><br/>\n<span class=\"f_CodeExample\">         enabled: true</span><br/>\n<span class=\"f_CodeExample\">         type: \"hpa\"</span><br/>\n<span class=\"f_CodeExample\">         minReplicas: 1</span><br/>\n<span class=\"f_CodeExample\">         maxReplicas: 9</span></p>\n<p style=\"margin: 0 0 0 100px;\"><span style=\"font-size: 13px; color: #000000;\"> </span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">После применения этих настроек автоматически создались:</span></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">в Kubernetes пул </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">;</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">в RabbitMQ отдельная очередь для этого пула, чтобы распределять запросы на обработку скриптов по бизнес-процессу для создания лида.</span></li></ul>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Когда в системе запустился процесс для создания лида, автоматически сгенерировался запрос на обработку скрипта. В этом запросе передались данные:</span></p>\n<ul style=\"\">\n<li style=\"margin-top: 19px; margin-right: 0; margin-bottom: 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">компания: </span><code><b>head</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\">;</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> </span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">операция: </span><code><b>execute</b></code><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">тип структуры системы: </span><code><b>process</b></code><span style=\"font-size: 13px; font-family: 'Courier New',Courier,monospace;\">;</span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> </span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">пространство имён структуры системы: </span><code><b>crm</b></code><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">;</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 0;\"><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">код структуры системы: </span><code><b>createlead</b></code><span style=\"font-size: 13px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></li></ul>\n<p><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Поскольку мы указали эти данные в настройках выделенного пула </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">, запрос автоматически ставится в отдельную очередь этого пула и выполняется в нём.</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Удалить созданный пул worker</span></h2>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">Чтобы удалить настроенный пул </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">, </span><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\">в файле </span><code><b>values-elma365.yaml</b></code><span style=\"font-family: 'Times New Roman',Times,Georgia,serif;\"> уберите</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> ранее заданные параметры и </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; color: #0000ff;\"><a class=\"topiclink\" href=\"change-settings-enterprise.html#apply-new-parameters\">примените</a></span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\"> их. После этого в RabbitMQ все необработанные запросы на обработку скриптов из его очереди перенаправятся в очередь </span><code><b>script.default</b></code><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">. Из неё распределятся на общие экземпляры </span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif; font-weight: bold;\">worker</span><span style=\"font-size: 15px; font-family: 'Times New Roman',Times,Georgia,serif;\">.</span></p>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"autoscaling-service-enterprise.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">autoscaling-service-enterprise.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"enable-monitoring-enterprise.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">enable-monitoring-enterprise.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n<script type=\"text/javascript\">\nHMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');\n</script>\n</body>\n</html>\n",
  "plain_text": "Настройка отдельных пулов worker для обработки скриптов ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 ELMA365 On-Premises > Администрирование ELMA365 Enterprise / Настройка отдельных пулов worker для обработки скриптов Настройка отдельных пулов worker для обработки скриптов В ELMA365 за валидацию, компиляцию и исполнение серверных скриптов отвечает сервис worker . Чтобы повысить его производительность, вы можете выделить отдельные пулы исполнения: для структур системы, где инициируются скрипты. Например, для скриптов виджетов или определённого бизнес-процесса; для отдельных типов запросов на обработку скриптов. Например, для их публикации или исполнения. начало внимание Настройка отдельных пулов worker доступна для поставки ELMA365 On‑Premises Enterprise начиная с версии 2025.6. конец внимание В статье рассмотрим, как в системе: обрабатываются скрипты ; настроить отдельные пулы worker для определённых скриптов . Алгоритм обработки скриптов в сервисе worker Для распределения нагрузки на сервис worker используются инструменты: Kubernetes — обеспечивает масштабирование экземпляров сервиса, в которых выполняются скрипты; RabbitMQ — выступает в качестве маршрутизатора, распределяя запросы на выполнение скриптов между доступными экземплярами worker . При стандартной конфигурации worker запросы на обработку скриптов поступают в RabbitMQ и распределяются в рамках общей очереди. Это повышает нагрузку на сервис и замедляет выполнение скриптов. Настройка отдельных пулов для скриптов определённого типа помогает оптимизировать распределение этой нагрузки. После такой настройки : в Kubernetes — передаются данные, по которым будут разворачиваться пулы; в RabbitMQ — автоматически добавляется отдельная очередь для каждого настроенного пула. Рассмотрим подробнее, как происходит маршрутизация запросов на скрипты: Определение ключа маршрутизации . При запуске скрипта автоматически формируется запрос, содержащий его параметры: имя компании, публикация или исполнение скрипта, структура системы, из которой направлен скрипт, и т. д. На основе этих данных вычисляется ключ маршрутизации: если вы настроили для определённых скриптов отдельные пулы , запросу присваивается ключ, равный идентификатору пула worker ; если подходящего пула нет — присваивается ключ default . Распределение запросов . Запросы с присвоенным ключом поступают в RabbitMQ, где происходит их маршрутизация: если вы задали для отдельных скриптов свои пулы worker , в RabbitMQ автоматически создаются очереди для таких пулов. Запросы распределятся в эту очередь по присвоенному ключу; запросы с ключом default попадают в общую очередь script.default . Обработка запросов . Из очередей запросы распределяются между экземплярами worker : из выделенных очередей запросы на обработку скриптов передаются на настроенные пулы worker ; из очереди script.default — распределяются между общими экземплярами worker . Настроить пулы worker Настройка пулов worker состоит из двух этапов: Задать конфигурацию пулов worker . Применить настроенную конфигурацию . Шаг 1. Задать конфигурацию пулов worker Чтобы создать отдельный пул worker для определённых скриптов, в файле values-elma365.yaml задайте его конфигурацию. В ней определите критерии отбора скриптов, параметры автомасштабирования экземпляров в пуле, а также время ожидания выполнения скриптов. Для этого: Создайте резервную копию файла values-elma365.yaml , заполненного при установке ELMA365. Это требуется перед редактированием, так как некорректная настройка параметров может привести к сбоям в работе приложения ELMA365. В конфигурационном файле values-elma365.yaml перейдите к блоку global и заполните параметры в секции workerPoolCfg . начало примечание Пример настройки параметров в секции workerPoolCfg global: workerPoolCfg: pools: namespacepool: # Наименование пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов sources: # Фильтры для отбора скриптов, которые будут распределяться на пул - company: head operation: execute type: process namespace: crm code: createlead autoscaling: # Параметры автомасштабирования для пула enabled: true type: \"hpa\" minReplicas: 1 maxReplicas: 9 options: # Дополнительные опции для пула — таймауты defaultScriptTimeoutSeconds: 180 maxScriptTimeoutSeconds: 1200 конец примечание Для этого укажите: Идентификатор пула ( pools ) — наименование пула worker . Задайте пользовательское название для пула, используя строчные латинские буквы и цифры длиной до 20 символов. Источники запросов на обработку скриптов ( sources ). Когда в системе запускается скрипт, автоматически генерируется запрос на его обработку. В этом запросе передаются параметры скрипта. Укажите, по каким параметрам отбирать скрипты для настраиваемого пула: сompany — имя компании в кластере; operation — тип запроса: публикация или исполнение скрипта. Добавьте одно из доступных значений: compile или execute . Например, обрабатывать только публикацию скриптов, указав конфигурацию: workerPoolCfg: pools: publishpool: sources: - operation: compile type — структура системы, из которой направлен запрос на обработку скрипта. Укажите одно из доступных значений: process — бизнес-процесс; customactivity — действие БП в модуле; widget — виджет; eventhandler — обработчик события; apihandler — обработчик методов API; namespace — название пространства имён для структуры системы, из которой направлен запрос на обработку скрипта. Например, для раздела — это его код; code — код структуры системы, из которой направлен запрос на обработку скрипта. Например, код бизнес-процесса, действия БП в модуле и т. д. Чем больше условий задано, тем точнее отбор скриптов для пула. Если параметр не заполнен, он не учитывается. Примеры конфигураций для отбора скриптов Рассмотрим варианты настройки пулов, демонстрирующие разные уровни отбора скриптов: Самый широкий охват — на выделенном пуле worker публикуются и исполняются все скрипты раздела CRM : workerPoolCfg: pools: namespacepool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов sources: - company: head # Имя компании namespace: crm # Код раздела Умеренный отбор — на выделенном пуле worker исполняются скрипты только из бизнес-процессов раздела CRM : workerPoolCfg: pools: namespacepool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов sources: - company: head # Имя компании namespace: crm # Код раздела operation: execute # Тип операции — исполнение скриптов type: process # Отбираются только скрипты из бизнес-процессов Более точный отбор — на выделенном пуле worker исполняются скрипты бизнес-процессов, созданных на уровне приложения с кодом clientapp из раздела CRM : workerPoolCfg: pools: applicationpool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов sources: - company: head # Имя компании namespace: crm.clientapp # `{код раздела}.{код приложения}` operation: execute # Тип операции — исполнение скриптов type: process # Отбираются только скрипты из бизнес-процессов Максимально точный отбор — на выделенном пуле worker исполняются скрипты только из бизнес-процесса Создание лида : workerPoolCfg: pools: processpool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов sources: - company: head # Имя компании namespace: crm.clientapp # `{код раздела}.{код приложения}` operation: execute # Тип операции — исполнение скриптов type: process # Отбираются только скрипты из бизнес-процесса code: createlead # Код бизнес-процесса, из которого отбираются скрипты Параметры для автомасштабирования пула ( autoscaling ) . В зависимости от нагрузки на пул worker , задайте настройки для его автоматического масштабирования. На их основе в оркестраторе Kubernetes будет создаваться указанное количество экземпляров worker . Для этого заполните параметры в блоке autoscaling : enabled — значение true включает автомасштабирование; type — выбор метода автомасштабирования. Определите, какой инструмент использовать. Доступные значения: \"hpa\" — Horizontal Pod Autoscaler. Используется по умолчанию. Не требуется дополнительных настроек; \"keda\" — Kubernetes Event-driven Autoscaling. Используется, если настроен дополнительный компонент KEDA ; minReplicas — минимальное количество экземпляров в пуле; maxReplicas — максимальное количество экземпляров в пуле. Дополнительные опции для пула ( options ) . Для серверных скриптов существует время ожидания их исполнения — таймаут. Если скрипт не выполнился в течение этого времени, он прерывается. Таким образом работа пула не блокируется из‑за долгого выполнения скриптов. Для установки таймаутов в секции options заполните параметры: defaultScriptTimeoutSeconds — стандартное время ожидания исполнения скрипта в секундах. После истечения этого времени исполнение скрипта прерывается; maxScriptTimeoutSeconds — максимальное время ожидания исполнения скрипта в секундах. После истечения этого времени исполнение скрипта прерывается. Шаг 2. Применить настроенную конфигурацию пулов worker Когда в файле values-elma365.yaml вы задали конфигурацию для отбора скриптов и для автомасштабировния пулов worker , примените обновлённые параметры . Пример настройки отдельного пула для обработки скриптов бизнес-процесса Допустим, в файле values-elma365.yaml мы настроили отдельный пул worker для бизнес-процесса по созданию лида в разделе CRM : workerPoolCfg: pools: processpool: # Идентификатор пула задаётся в свободной форме строчными латинскими буквами и цифрами длиной до 20 символов sources: - company: head # Имя компании namespace: crm # Код раздела, на уровне которого создан бизнес-процесс operation: execute # Тип операции — исполнение скриптов type: process # Отбираются только скрипты из бизнес-процесса code: createlead # Отбираются только скрипты с кодом бизнес-процесса для создания лида autoscaling: enabled: true type: \"hpa\" minReplicas: 1 maxReplicas: 9 После применения этих настроек автоматически создались: в Kubernetes пул worker ; в RabbitMQ отдельная очередь для этого пула, чтобы распределять запросы на обработку скриптов по бизнес-процессу для создания лида. Когда в системе запустился процесс для создания лида, автоматически сгенерировался запрос на обработку скрипта. В этом запросе передались данные: компания: head ; операция: execute ; тип структуры системы: process ; пространство имён структуры системы: crm ; код структуры системы: createlead . Поскольку мы указали эти данные в настройках выделенного пула worker , запрос автоматически ставится в отдельную очередь этого пула и выполняется в нём. Удалить созданный пул worker Чтобы удалить настроенный пул worker , в файле values-elma365.yaml уберите ранее заданные параметры и примените их. После этого в RabbitMQ все необработанные запросы на обработку скриптов из его очереди перенаправятся в очередь script.default . Из неё распределятся на общие экземпляры worker . autoscaling-service-enterprise.html enable-monitoring-enterprise.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/elma365-on-premises.html",
    "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/worker-pools.html",
    "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/install-keda.html",
    "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/change-settings-enterprise.html",
    "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/autoscaling-service-enterprise.html",
    "https://elma365.com/ru/help/business_solutions/ /ru/help/platform/enable-monitoring-enterprise.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T22:03:28.070460",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T22:03:28.085851"
  }
}