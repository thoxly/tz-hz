{
  "doc_id": "postgresql",
  "url": "https://elma365.com/ru/help/business_solutions/ru/help/crm/postgresql.html",
  "title": "PostgreSQL",
  "breadcrumbs": [
    "ELMA365 On-Premises",
    "Подготовка инфраструктуры ELMA365 On-Premises"
  ],
  "section": "ELMA365 On-Premises > Подготовка инфраструктуры ELMA365 On-Premises | [business_solutions]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>PostgreSQL</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"В статье описаны: установка PostgreSQL для ОС Ubuntu Linux 20.04. Вы также можете ознакомиться с кратким руководством в официальной документации PostgreSQL; подготовка базы...\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/postgresql.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p><a href=\"elma365-on-premises.html\">ELMA365 On-Premises</a> &gt; <a href=\"infrastructure-preparation.html\">Подготовка инфраструктуры ELMA365 On-Premises</a> &gt; Базы данных &gt; Подготовка внешних баз данных / PostgreSQL</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">PostgreSQL</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p class=\"p_Normal\">В статье описаны:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">установка PostgreSQL для ОС Ubuntu Linux 20.04. Вы также можете ознакомиться с кратким руководством в <a class=\"weblink\" href=\"https://www.postgresql.org/download/linux/ubuntu/\" target=\"_blank\">официальной документации PostgreSQL</a>;</li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"postgresql.html#prepare-to-recovery\">подготовка базы данных в PostgreSQL к восстановлению</a>.</li></ul>\n<p class=\"p_Normal\">Перед установкой СУБД:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">проверьте поддерживаемые версии PostgreSQL для корректной работы системы в статье <a class=\"topiclink\" href=\"elma365-enterprise-on-premises.html#postgresql\">«Системные требования ELMA365 On-Premises»</a>;</li><li class=\"p_Normal\"><span style=\"font-size: 13px; color: #394149;\">оцените планируемую нагрузку. При больших объёмах данных рекомендуется устанавливать СУБД на отдельной виртуальной машине. Это позволит избежать конкуренции за ресурсы и обеспечить стабильную работу системы ELMA365. Подробнее о вариантах организации инфраструктуры читайте в статьях </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0000ff;\"><a class=\"topiclink\" href=\"elma365-on-premises-standard.html\">«ELMA365 On-Premises Standard»</a></span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> и </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0000ff;\"><a class=\"topiclink\" href=\"elma365-enterprise.html\">«ELMA365 On-Premises Enterprise»</a></span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">.</span></li></ul>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало внимание</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Для примера в статье используется имя базы <span style=\"font-weight: bold;\">elma365</span>, пользователь <span style=\"font-weight: bold;\">elma365 </span>и пароль <span style=\"font-weight: bold;\">SecretPassword</span>.<span style=\"font-weight: bold;\"> </span>При настройке задайте эти данные согласно политике безопасности, принятой в вашей организации.</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец внимание</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Установка состоит из шести этапов:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\"><a class=\"topiclink\" href=\"postgresql.html#install-postgresql\">Установка PostgreSQL</a>.</li><li class=\"p_Normal\" value=\"2\"><a class=\"topiclink\" href=\"postgresql.html#set-up-postgresql\">Настройка PostgreSQL</a>.</li><li class=\"p_Normal\" value=\"3\"><a class=\"topiclink\" href=\"postgresql.html#set-up-connection-to-postgresql\">Настройка подключения к PostgreSQL</a>.</li><li class=\"p_Normal\" value=\"4\"><a class=\"topiclink\" href=\"postgresql.html#set-limits-to-postgresql\">Настройка ограничений и лимитов к PostgreSQL</a>.</li><li class=\"p_Normal\" value=\"5\"><a class=\"topiclink\" href=\"postgresql.html#prepare-pgbouncer\">Подготовка PGBouncer (опционально)</a>.</li><li class=\"p_Normal\" value=\"6\"><a class=\"topiclink\" href=\"postgresql.html#connect-to-postgresql\">Подключение к PostgreSQL</a>.</li></ol>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"install-postgresql\"></a><span class=\"f_Heading2\">Шаг 1. Установка PostgreSQL</span></h2>\n<p class=\"p_Normal\">Для установки PostgreSQL добавьте официальный репозиторий:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo sh -c 'echo \"deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main\" &gt; /etc/apt/sources.list.d/pgdg.list'</span><br/>\n<span class=\"f_CodeExample\">wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -</span><br/>\n<span class=\"f_CodeExample\">sudo apt update</span></p>\n<p class=\"p_Normal\">Далее установите PostgreSQL:</p>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo apt install postgresql-15</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"set-up-postgresql\"></a><span class=\"f_Heading2\">Шаг 2. Настройка PostgreSQL</span></h2>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">Начало примечание</span></p>\n<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Примечание</span></p>\n<p class=\"p_Normal\">Для пароля разрешается применять следующие символы: </p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">заглавные латинские буквы: от A до Z;</li><li class=\"p_Normal\">строчные латинские буквы: от a до z; </li><li class=\"p_Normal\">цифры от 0 до 9; </li><li class=\"p_Normal\">символы: -_.</li></ul>\n<p class=\"p_Normal\">Зарезервированные (недопустимые) символы:</p>\n<p class=\"p_Normal\">! * ' ( ) ; : @ &amp; = + $ , / ? % # [ ]</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">Конец примечание</span></p>\n<p class=\"p_Normal\">Для настройки PostgreSQL используйте следующие команды:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Создайте отдельного пользователя <span style=\"font-weight: bold;\">elma365</span> с паролем <span style=\"font-weight: bold;\">SecretPassword</span> для работы с БД. Имя пользователя и пароль приведены для примера:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo -u postgres psql -c \"CREATE ROLE elma365 WITH login password 'SecretPassword';\"</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\"><a class=\"hmanchor\" id=\"create-db\"></a>Создайте отдельную базу данных <span style=\"font-weight: bold;\">elma365</span> с базовой локалью и назначьте выделенного пользователя <span style=\"font-weight: bold;\">elma365</span> её владельцем. Нельзя использовать существующую базу, так как система создаёт таблицы и схемы:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo -u postgres psql -c \"CREATE DATABASE elma365 WITH OWNER elma365;\"</span></p>\n<p class=\"p_Normal\"><a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A1')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Создание базы данных с локалью ru_RU.UTF-8</a></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A1\" style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p class=\"p_Normal\"> <br/>\nВы можете создать базу данных <span style=\"font-weight: bold;\">elma365</span> с локалью<span style=\"font-weight: bold;\"> ru_RU.UTF-8</span>. Это позволит улучшить работу механизмов сортировки и индексирования русскоязычных данных, а также ускорить выполнение поисковых и текстовых операций. Для этого:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\">Убедитесь, что локаль <span style=\"font-weight: bold;\">ru_RU.UTF-8</span> доступна в системе:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">locale -a | grep ru_RU</span></p>\n<p class=\"p_Normal\"> <br/>\nПри наличии локали отобразится её название.</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"2\">Если в системе отсутствует локаль <span style=\"font-weight: bold;\">ru_RU.UTF-8</span>, установите её, выполнив команду:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo locale-gen ru_RU.UTF-8 &amp;&amp; sudo update-locale</span></p>\n<p class=\"p_Normal\"> <br/>\nПосле установки перезагрузите сервис PostgreSQL для применения изменений:</p>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid; margin: 0 0 0 33px;\"><span class=\"f_CodeExample\">sudo systemctl restart postgresql</span></p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"3\">Создайте базу данных с локалью<span style=\"font-weight: bold;\"> ru_RU.UTF-8</span>:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo -u postgres psql -c \"CREATE DATABASE elma365 WITH OWNER = elma365</span><br/>\n<span class=\"f_CodeExample\">LOCALE_PROVIDER = icu ICU_LOCALE = 'ru-RU' ENCODING = 'UTF8' LC_COLLATE =</span><br/>\n<span class=\"f_CodeExample\">'ru_RU.UTF-8' LC_CTYPE = 'ru_RU.UTF-8' TEMPLATE = template0;\"</span></p>\n</td>\n</tr>\n</table>\n</div>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Добавьте необходимые расширения для базы данных <span style=\"font-weight: bold;\">elma365</span>:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo -u postgres psql -d elma365 -c \"CREATE EXTENSION \\\"uuid-ossp\\\"; CREATE EXTENSION pg_trgm;\"</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"set-up-connection-to-postgresql\"></a><span class=\"f_Heading2\">Шаг 3. Настройка подключения к PostgreSQL</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Добавьте IP-адрес сервера, на котором запущен PostgreSQL, в конфигурационный файл <code><b>/etc/postgresql/15/main/postgresql.conf</b></code> в параметр<span style=\"font-weight: bold;\"> </span><code><b>listen_addresses</b></code>, например, <code><b>192.168.10.10</b></code>:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo nano /etc/postgresql/15/main/postgresql.conf</span><br/>\n<span class=\"f_CodeExample\">listen_addresses = 'localhost, 192.168.10.10'</span></p>\n<p class=\"p_Normal\"><a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A2')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Настройка включения TLS/SSL в PostgreSQL</a></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A2\" style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p class=\"p_Normal\"> <br/>\nДля включения поддержки TLS/SSL в PostgreSQL в файле конфигурации <code><b>postgresql.conf</b></code><span style=\"font-weight: bold;\"> </span>нужно:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\">Включить поддержку SSL, установив значение <code><b>on</b></code> в параметре <code><b>ssl</b></code>.</li></ol>\n<ol start=\"2\" style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"2\">В параметре <code><b>ssl_ca_file</b></code> указать путь до файла корневого CA.</li></ol>\n<ol start=\"3\" style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"3\">В параметре <code><b>ssl_cert_file</b></code> указать путь до файла сертификата сервера.</li></ol>\n<ol start=\"4\" style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"4\">В параметре <code><b>ssl_key_file</b></code> указать путь до файла закрытого ключа.</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">ssl = on</span><br/>\n<span class=\"f_CodeExample\">ssl_ca_file = '/etc/ssl/certs/CA.pem'</span><br/>\n<span class=\"f_CodeExample\">ssl_cert_file = '/etc/ssl/certs/ssl-cert.pem'</span><br/>\n<span class=\"f_CodeExample\">ssl_key_file = '/etc/ssl/private/server.key'</span></p>\n<p class=\"p_Normal\"> <br/>\nПодробнее о настройке TLS/SSL в PostgreSQL читайте в <a class=\"weblink\" href=\"https://www.postgresql.org/docs/13/ssl-tcp.html\" target=\"_blank\">официальной документации PostgreSQL</a>.</p>\n</td>\n</tr>\n</table>\n</div>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">Добавьте в конец конфигурационного файла авторизации <code><b>/etc/postgresql/15/main/pg_hba.conf</b></code> адрес сети, в которой работают ноды elma365:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo nano /etc/postgresql/15/main/pg_hba.conf</span><br/>\n<span class=\"f_CodeExample\">host    all             all             192.168.0.0/16              md5</span></p>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Перезагрузите сервис PostgreSQL:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo systemctl restart postgresql</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"set-limits-to-postgresql\"></a><span class=\"f_Heading2\">Шаг 4. Настройка ограничений и лимитов к PostgreSQL</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Откройте для редактирования конфигурационный файл <code><b>/etc/postgresql/15/main/postgresql.conf</b></code>:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo nano /etc/postgresql/15/main/postgresql.conf</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">Увеличьте максимальное количество подключений, изменив значение параметра <code><b>max_connections</b></code> на <code><b>2000</b></code>:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">max_connections = 2000</span></p>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Увеличьте максимальное количество блокировок на транзакцию, изменив значение параметра <code><b>max_locks_per_transaction</b></code> на <code><b>512</b></code>. Также нужно раскомментировать эту строку (убрать знак решётки #):</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">max_locks_per_transaction = 512</span></p>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Перезагрузите сервис PostgreSQL:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo systemctl restart postgresql</span></p>\n<ol start=\"5\" style=\"list-style-type:upper-roman\">\n<li class=\"p_CodeExample\" style=\"page-break-inside: avoid;\" value=\"5\">В некоторых дистрибутивах PostgreSQL параметр <code><b>standard_conforming_strings,</b></code> отвечающий за интерпретацию символов backslash, выключен. Проверьте и включите параметр:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">standard_conforming_strings = on</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"prepare-pgbouncer\"></a><span class=\"f_Heading2\">Шаг 5. Подготовка PGBouncer (опционально)</span></h2>\n<p class=\"p_Normal\">PGBouncer предназначен для управления пулом соединений к PostgreSQL и позволяет минимизировать издержки, связанные с установлением новых подключений к PostgreSQL.</p>\n<p class=\"p_Normal\">Про установку и настройку PGBouncer читайте в статье <a class=\"topiclink\" href=\"pgbouncer-installation.html\">«Установка PGBouncer»</a>.</p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"connect-to-postgresql\"></a><span class=\"f_Heading2\">Шаг 6. Подключение к PostgreSQL</span></h2>\n<p class=\"p_Normal\">Строка подключения к PostgreSQL:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">postgresql://elma365:SecretPassword@&lt;postgresql-server-address&gt;:5432/elma365?sslmode=disable</span></p>\n<p class=\"p_Normal\">Строка подключения PostgreSQL с TLS/SSL:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">postgresql:</span><span class=\"f_CodeExample\">//elma365:SecretPassword@&lt;postgresql-server-address&gt;:5432/elma365?sslmode=require</span></p>\n<p class=\"p_Normal\"><a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A3')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Подключение к PostgreSQL через PGBouncer</a></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A3\" style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p class=\"p_Normal\"> <br/>\nСтрока подключения к PGBouncer:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">postgresql:</span><span class=\"f_CodeExample\">//elma365:SecretPassword@&lt;postgresql-server-address&gt;:6432/elma365?sslmode=disable</span></p>\n<p class=\"p_Normal\"> <br/>\nСтрока подключения PGBouncer с TLS/SSL:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">postgresql:</span><span class=\"f_CodeExample\">//elma365:SecretPassword@&lt;postgresql-server-address&gt;:6432/elma365?sslmode=require</span></p>\n</td>\n</tr>\n</table>\n</div>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"prepare-to-recovery\"></a><span class=\"f_Heading2\">Подготовка базы данных в PostgreSQL к восстановлению</span></h2>\n<p class=\"p_Normal\">Если вам потребовалось восстановить базу данных из резервной копии, сначала подготовьте БД к восстановлению.</p>\n<p class=\"p_Normal\">Подробнее про резервное копирование читайте в статьях:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><a class=\"topiclink\" href=\"dump_db.html#backup-posgresql\">«Резервное копирование внешними средствами»</a>;</li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"database-backup-and-recovery.html#backup-database\">«Резервное копирование и восстановление баз данных: утилита Elma365-Backupper»</a>;</li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"backup-restore-elma365standard.html#backup\">«Резервное копирование и восстановление данных ELMA365 Standard»</a>.</li></ul>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">Начало внимание</span></p>\n<p class=\"p_Normal\">Предварительно убедитесь, что у вас есть резервная копия удаляемой базы данных. Только после этого приступайте к удалению БД.</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">Конец внимание</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Удалите базу данных <span style=\"font-weight: bold;\">elma365</span>:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">sudo -u postgres psql -c \"DROP DATABASE elma365 WITH (FORCE);\"</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">Создайте пустую базу данных <span style=\"font-weight: bold;\">elma365</span> для последующего восстановления БД из резервной копии. Для этого выполните действия из <a class=\"topiclink\" href=\"postgresql.html#create-db\">шага 2 в настройках PostgreSQL</a>.</li><li class=\"p_Normal\" value=\"3\">После этого выполните восстановление данных, в зависимости от вашей поставки ELMA365 On-Premises и способа резервного копирования:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><a class=\"topiclink\" href=\"database-backup-and-recovery.html#recovery-database\">восстановление резервной копии с помощью утилиты Elma365-Backupper</a>;</li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"backup-and-recovery-with-wal-g-and-rclone.html#wal-g-in-postgres\">восстановление резервной копии с помощью WAL-G</a>;</li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"dump_db.html#recovery-posgresql\">восстановление для резервного копирования внешними средствами</a>;</li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"backup-restore-elma365standard.html#restore-data\">восстановление резервной копии в поставке Standard</a>.</li></ul>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"embedded-databases-settings.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">embedded-databases-settings.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"mongodb.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">mongodb.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n<script type=\"text/javascript\">\nHMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');\nHMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');\nHMInitToggle('TOGGLE0186A3','hm.type','dropdown','hm.state','0');\n</script>\n</body>\n</html>\n",
  "plain_text": "PostgreSQL ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 ELMA365 On-Premises > Подготовка инфраструктуры ELMA365 On-Premises > Базы данных > Подготовка внешних баз данных / PostgreSQL PostgreSQL В статье описаны: установка PostgreSQL для ОС Ubuntu Linux 20.04. Вы также можете ознакомиться с кратким руководством в официальной документации PostgreSQL ; подготовка базы данных в PostgreSQL к восстановлению . Перед установкой СУБД: проверьте поддерживаемые версии PostgreSQL для корректной работы системы в статье «Системные требования ELMA365 On-Premises» ; оцените планируемую нагрузку. При больших объёмах данных рекомендуется устанавливать СУБД на отдельной виртуальной машине. Это позволит избежать конкуренции за ресурсы и обеспечить стабильную работу системы ELMA365. Подробнее о вариантах организации инфраструктуры читайте в статьях «ELMA365 On-Premises Standard» и «ELMA365 On-Premises Enterprise» . начало внимание Для примера в статье используется имя базы elma365 , пользователь elma365 и пароль SecretPassword . При настройке задайте эти данные согласно политике безопасности, принятой в вашей организации. конец внимание Установка состоит из шести этапов: Установка PostgreSQL . Настройка PostgreSQL . Настройка подключения к PostgreSQL . Настройка ограничений и лимитов к PostgreSQL . Подготовка PGBouncer (опционально) . Подключение к PostgreSQL . Шаг 1. Установка PostgreSQL Для установки PostgreSQL добавьте официальный репозиторий: sudo sh -c 'echo \"deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main\" > /etc/apt/sources.list.d/pgdg.list' wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add - sudo apt update Далее установите PostgreSQL: sudo apt install postgresql-15 Шаг 2. Настройка PostgreSQL Начало примечание Примечание Для пароля разрешается применять следующие символы: заглавные латинские буквы: от A до Z; строчные латинские буквы: от a до z; цифры от 0 до 9; символы: -_. Зарезервированные (недопустимые) символы: ! * ' ( ) ; : @ & = + $ , / ? % # [ ] Конец примечание Для настройки PostgreSQL используйте следующие команды: Создайте отдельного пользователя elma365 с паролем SecretPassword для работы с БД. Имя пользователя и пароль приведены для примера: sudo -u postgres psql -c \"CREATE ROLE elma365 WITH login password 'SecretPassword';\" Создайте отдельную базу данных elma365 с базовой локалью и назначьте выделенного пользователя elma365 её владельцем. Нельзя использовать существующую базу, так как система создаёт таблицы и схемы: sudo -u postgres psql -c \"CREATE DATABASE elma365 WITH OWNER elma365;\" Создание базы данных с локалью ru_RU.UTF-8 Вы можете создать базу данных elma365 с локалью ru_RU.UTF-8 . Это позволит улучшить работу механизмов сортировки и индексирования русскоязычных данных, а также ускорить выполнение поисковых и текстовых операций. Для этого: Убедитесь, что локаль ru_RU.UTF-8 доступна в системе: locale -a | grep ru_RU При наличии локали отобразится её название. Если в системе отсутствует локаль ru_RU.UTF-8 , установите её, выполнив команду: sudo locale-gen ru_RU.UTF-8 && sudo update-locale После установки перезагрузите сервис PostgreSQL для применения изменений: sudo systemctl restart postgresql Создайте базу данных с локалью ru_RU.UTF-8 : sudo -u postgres psql -c \"CREATE DATABASE elma365 WITH OWNER = elma365 LOCALE_PROVIDER = icu ICU_LOCALE = 'ru-RU' ENCODING = 'UTF8' LC_COLLATE = 'ru_RU.UTF-8' LC_CTYPE = 'ru_RU.UTF-8' TEMPLATE = template0;\" Добавьте необходимые расширения для базы данных elma365 : sudo -u postgres psql -d elma365 -c \"CREATE EXTENSION \\\"uuid-ossp\\\"; CREATE EXTENSION pg_trgm;\" Шаг 3. Настройка подключения к PostgreSQL Добавьте IP-адрес сервера, на котором запущен PostgreSQL, в конфигурационный файл /etc/postgresql/15/main/postgresql.conf в параметр listen_addresses , например, 192.168.10.10 : sudo nano /etc/postgresql/15/main/postgresql.conf listen_addresses = 'localhost, 192.168.10.10' Настройка включения TLS/SSL в PostgreSQL Для включения поддержки TLS/SSL в PostgreSQL в файле конфигурации postgresql.conf нужно: Включить поддержку SSL, установив значение on в параметре ssl . В параметре ssl_ca_file указать путь до файла корневого CA. В параметре ssl_cert_file указать путь до файла сертификата сервера. В параметре ssl_key_file указать путь до файла закрытого ключа. ssl = on ssl_ca_file = '/etc/ssl/certs/CA.pem' ssl_cert_file = '/etc/ssl/certs/ssl-cert.pem' ssl_key_file = '/etc/ssl/private/server.key' Подробнее о настройке TLS/SSL в PostgreSQL читайте в официальной документации PostgreSQL . Добавьте в конец конфигурационного файла авторизации /etc/postgresql/15/main/pg_hba.conf адрес сети, в которой работают ноды elma365: sudo nano /etc/postgresql/15/main/pg_hba.conf host all all 192.168.0.0/16 md5 Перезагрузите сервис PostgreSQL: sudo systemctl restart postgresql Шаг 4. Настройка ограничений и лимитов к PostgreSQL Откройте для редактирования конфигурационный файл /etc/postgresql/15/main/postgresql.conf : sudo nano /etc/postgresql/15/main/postgresql.conf Увеличьте максимальное количество подключений, изменив значение параметра max_connections на 2000 : max_connections = 2000 Увеличьте максимальное количество блокировок на транзакцию, изменив значение параметра max_locks_per_transaction на 512 . Также нужно раскомментировать эту строку (убрать знак решётки #): max_locks_per_transaction = 512 Перезагрузите сервис PostgreSQL: sudo systemctl restart postgresql В некоторых дистрибутивах PostgreSQL параметр standard_conforming_strings, отвечающий за интерпретацию символов backslash, выключен. Проверьте и включите параметр: standard_conforming_strings = on Шаг 5. Подготовка PGBouncer (опционально) PGBouncer предназначен для управления пулом соединений к PostgreSQL и позволяет минимизировать издержки, связанные с установлением новых подключений к PostgreSQL. Про установку и настройку PGBouncer читайте в статье «Установка PGBouncer» . Шаг 6. Подключение к PostgreSQL Строка подключения к PostgreSQL: postgresql://elma365:SecretPassword@<postgresql-server-address>:5432/elma365?sslmode=disable Строка подключения PostgreSQL с TLS/SSL: postgresql: //elma365:SecretPassword@<postgresql-server-address>:5432/elma365?sslmode=require Подключение к PostgreSQL через PGBouncer Строка подключения к PGBouncer: postgresql: //elma365:SecretPassword@<postgresql-server-address>:6432/elma365?sslmode=disable Строка подключения PGBouncer с TLS/SSL: postgresql: //elma365:SecretPassword@<postgresql-server-address>:6432/elma365?sslmode=require Подготовка базы данных в PostgreSQL к восстановлению Если вам потребовалось восстановить базу данных из резервной копии, сначала подготовьте БД к восстановлению. Подробнее про резервное копирование читайте в статьях: «Резервное копирование внешними средствами» ; «Резервное копирование и восстановление баз данных: утилита Elma365-Backupper» ; «Резервное копирование и восстановление данных ELMA365 Standard» . Начало внимание Предварительно убедитесь, что у вас есть резервная копия удаляемой базы данных. Только после этого приступайте к удалению БД. Конец внимание Удалите базу данных elma365 : sudo -u postgres psql -c \"DROP DATABASE elma365 WITH (FORCE);\" Создайте пустую базу данных elma365 для последующего восстановления БД из резервной копии. Для этого выполните действия из шага 2 в настройках PostgreSQL . После этого выполните восстановление данных, в зависимости от вашей поставки ELMA365 On-Premises и способа резервного копирования: восстановление резервной копии с помощью утилиты Elma365-Backupper ; восстановление резервной копии с помощью WAL-G ; восстановление для резервного копирования внешними средствами ; восстановление резервной копии в поставке Standard . embedded-databases-settings.html mongodb.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/elma365-on-premises.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/infrastructure-preparation.html",
    "https://www.postgresql.org/download/linux/ubuntu/",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/postgresql.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/elma365-enterprise-on-premises.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/elma365-on-premises-standard.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/elma365-enterprise.html",
    "https://www.postgresql.org/docs/13/ssl-tcp.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/pgbouncer-installation.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/dump_db.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/database-backup-and-recovery.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/backup-restore-elma365standard.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/backup-and-recovery-with-wal-g-and-rclone.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/embedded-databases-settings.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/mongodb.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T22:03:59.103512",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T22:03:59.206143"
  }
}