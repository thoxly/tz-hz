{
  "doc_id": "batch-actions",
  "url": "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/batch-actions.html",
  "title": "Массовые действия с элементами приложений в скрипте",
  "breadcrumbs": [
    "Приложение",
    "Работа с приложением в скриптах"
  ],
  "section": "Приложение > Работа с приложением в скриптах | [kedo]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>Массовые действия с элементами приложений в скрипте</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"В ELMA365 вы можете массово добавлять или удалять элементы, а также обновлять их поля через скрипт, используя методы на языке TypeScript. Это позволяет снизить нагрузку на...\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/batch-actions.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p>Low-code дизайнер &gt; <a href=\"360006963072.html\">Приложение</a> &gt; <a href=\"app-data-in-scripts.html\">Работа с приложением в скриптах</a> / Массовые действия с элементами приложений в скрипте</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Массовые действия с элементами приложений в скрипте</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p class=\"p_Normal\">В ELMA365 вы можете массово добавлять или удалять элементы, а также обновлять их поля через <a class=\"topiclink\" href=\"type-script.html\">скрипт</a>, используя методы на языке <a class=\"weblink\" href=\"https://www.typescriptlang.org/\" target=\"_blank\">TypeScript</a>. Это позволяет снизить нагрузку на систему и уменьшить влияние установленных лимитов, когда нужно обработать большое количество данных. Например, если у вас настроена интеграция со сторонней системой, можно из неё загрузить каталог товаров в приложение.</p>\n<p class=\"p_Normal\">Вы можете задать следующие методы в скриптах:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><code><b>app.batch().save()</b></code> — массовое добавление элементов приложения;</li><li class=\"p_Normal\"><code><b>app.batch().update()</b></code> — массовое обновление полей элементов приложения;</li><li class=\"p_Normal\"><code><b>app.batch().delete()</b></code> — массовое удаление элементов приложения.</li></ul>\n<p class=\"p_Normal\">При написании скриптов с методами для массовых операций учитывайте следующие условия:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">за один запрос обрабатывается не более 10000 элементов. Это ограничение применяется ко всем указанным методам;</li><li class=\"p_Normal\">чтобы выполнить массовое действие с элементами при помощи метода, у пользователя должны быть <a class=\"topiclink\" href=\"360007527512.html#assign\">права на импорт данных этого приложения</a>.</li></ul>\n<p class=\"p_Normal\">В статье рассмотрим на примерах, как использовать методы в скриптах. Подробнее читайте в <a class=\"weblink\" href=\"https://tssdk.elma365.com/ru/latest/pages/quick-start/intro_batch.html\" target=\"_blank\">справке ELMA365 TS SDK</a>.</p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Метод массового добавления элементов</span></h2>\n<p class=\"p_Normal\">С помощью <code><b>app.batch().save()</b></code> пакет элементов приложения обрабатывается за один запрос. </p>\n<p class=\"p_Normal\">Используйте этот метод, чтобы:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">сохранить новые элементы в приложение;</li><li class=\"p_Normal\">обновить поля существующих элементов. В этом случае укажите их идентификаторы, чтобы по ним найти нужные элементы, внести в них изменения и сохранить отредактированные элементы в базе данных.</li></ul>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"example-batch-save\"></a><span class=\"f_Heading3\">Пример массового добавления</span></h3>\n<p class=\"p_Normal\">Предположим, компания использует для работы систему ELMA365. Сотрудники маркетинга также применяют сторонний сервис, в котором хранятся публикации по продукту и комментарии от клиентов.</p>\n<p class=\"p_Normal\">Чтобы работники смежных отделов могли увидеть все данные в одном месте, информацию из этого внешнего сервиса можно массово перенести в ELMA365. Для этого нужно:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\">Создать приложения для загрузки публикаций и комментариев.</li><li class=\"p_Normal\" value=\"2\">Настроить интеграцию через <a class=\"topiclink\" href=\"extentions.html\">пользовательский модуль</a> и добавить в интерфейс модуля две кнопки со скриптами:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><span style=\"font-weight: bold;\">Добавить посты</span> — для массового переноса всех публикаций из стороннего сервиса в ELMA365;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Добавить комментарии</span> — для загрузки всех комментариев к этим публикациям.</li></ul>\n<h4 class=\"p_Heading4\"><span class=\"f_Heading4\">Шаг 1. Создать два приложения</span></h4>\n<p class=\"p_Normal\">Для начала создайте <a class=\"topiclink\" href=\"360007235031.html\">приложения</a>, чтобы импортировать в них данные. При этом добавляйте свойства приложений в соответствии с полями публикаций и комментариев в сторонней системе. Рассмотрим на примере:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\"><span style=\"font-weight: bold;\">Посты</span> — содержит свойства:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><span style=\"font-weight: bold;\">Название</span> (<code><b>__name</b></code>) — системное свойство, создаётся автоматически;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Номер</span> (<code><b>postID</b></code>) — тип <a class=\"topiclink\" href=\"360009707032.html#number\">Число (целое)</a> для идентификационного номера, по которому во внешней системе определяется связь между публикацией и комментариями к ней, т. е. значения этого поля равны в связанных элементах;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Дата создания</span> (<code><b>__createdAt</b></code>) — тип <a class=\"topiclink\" href=\"360009707032.html#date-time\">Дата/время</a> для хранения даты создания поста;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Заголовок</span> (<code><b>title</b></code>) — тип <a class=\"topiclink\" href=\"360009707032.html#string\">Строка (строка)</a> для заголовка публикации;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Текст</span> (<code><b>body</b></code>) — тип <a class=\"topiclink\" href=\"360009707032.html#string\">Строка (текст)</a> для текста публикации;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Комментарии</span> (<code><b>comments</b></code>) — тип <a class=\"topiclink\" href=\"360009707032.html#app\">Приложение (один)</a> для ссылки на связанный комментарий.</li></ul>\n<ol start=\"2\" style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"2\"><span style=\"font-weight: bold;\">Комментарии</span> — содержит свойства:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><span style=\"font-weight: bold;\">Название</span> (<code><b>__name</b></code>) — системное свойство, создаётся автоматически;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Номер</span> (<code><b>postID</b></code>) — тип <span style=\"font-weight: bold;\">Число (целое)</span> для идентификационного номера, по которому во внешней системе определяется связь между публикацией и комментариями к ней, т. е. значения этого поля равны в связанных элементах;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Дата создания</span> (<code><b>__createdAt</b></code>) — тип <span style=\"font-weight: bold;\">Дата/время</span> для хранения даты создания комментария;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Электронная почта пользователя</span> (<code><b>email</b></code>) — тип <a class=\"topiclink\" href=\"360009707032.html#email\">Электронная почта</a> для электронной почты пользователя, оставившего комментарий;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Сообщение</span> (<code><b>body</b></code>) — тип <span style=\"font-weight: bold;\">Строка (текст)</span> для текста комментария;</li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">Посты</span> (<code><b>post</b></code>) — тип <span style=\"font-weight: bold;\">Приложение (один)</span> для ссылки на связанный пост.</li></ul>\n<p class=\"p_Normal\">С помощью этих свойств далее в скрипте определяются поля, в которые запишутся значения, переданные из внешнего сервиса. Подробнее про заполнение полей <span style=\"font-weight: bold;\">Комментарии</span> и <span style=\"font-weight: bold;\">Посты</span> типа <span style=\"font-weight: bold;\">Приложение (один)</span> читайте в разделе <a class=\"topiclink\" href=\"batch-actions.html#example-batch-update\">«Пример массового обновления полей»</a>.</p>\n<h4 class=\"p_Heading4\"><span class=\"f_Heading4\">Шаг 2. Настроить загрузку данных через скрипт</span></h4>\n<p class=\"p_Normal\">После создания приложений настройте импорт данных из сторонней системы.</p>\n<p class=\"p_Normal\">Для этого:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">В настроенном модуле интеграции перейдите на вкладку <a class=\"topiclink\" href=\"extention-settings.html#settings\">Настройки</a> и нажмите кнопку <span style=\"font-weight: bold;\">Изменить форму</span>.</li><li class=\"p_Normal\" value=\"2\">В открывшемся дизайнере интерфейсов:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">создайте кнопки <span style=\"font-weight: bold;\">Добавить посты</span> и <span style=\"font-weight: bold;\">Добавить комментарии</span>;</li><li class=\"p_Normal\">на вкладке <span style=\"font-weight: bold;\">Скрипты</span> на стороне клиента пропишите код, используя <code><b>app.batch().save()</b></code>. Этот код позволит импортировать данные в приложения, когда пользователь нажмёт кнопку <span style=\"font-weight: bold;\">Добавить посты</span> или <span style=\"font-weight: bold;\">Добавить комментарии</span>.</li></ul>\n<p class=\"p_Normal\"><a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A1')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Пример кода</a></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A1\" style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">/* Client scripts module */</span><br/>\n<span class=\"f_CodeExample\">declare const console: any;</span><br/>\n<span class=\"f_CodeExample\">/*</span><br/>\n<span class=\"f_CodeExample\">// Асинхронная функция, чтобы импортировать комментарии из внешнего сервиса</span><br/>\n<span class=\"f_CodeExample\">async function import_comments(): Promise&lt;void&gt; {</span><br/>\n<span class=\"f_CodeExample\">// Выполняем запрос к внешнему сервису для получения комментариев</span><br/>\n<span class=\"f_CodeExample\">    const result = await fetch('https://externalservicewebsite.com/comments');</span><br/>\n<span class=\"f_CodeExample\">// Преобразуем ответ в формат JSON</span><br/>\n<span class=\"f_CodeExample\">    const comments = await result.json();</span><br/>\n<span class=\"f_CodeExample\">// Инициализируем массив для хранения элементов комментариев</span><br/>\n<span class=\"f_CodeExample\">    const items: any = [];</span><br/>\n<span class=\"f_CodeExample\">// Проходимся по каждому комментарию в полученном списке</span><br/>\n<span class=\"f_CodeExample\">    for (let c of comments) {</span><br/>\n<span class=\"f_CodeExample\">// Создаём новый элемент комментария в приложении</span><br/>\n<span class=\"f_CodeExample\">        const item = Context.fields.commentapp.app.create();</span><br/>\n<span class=\"f_CodeExample\">// Заполняем поля элемента комментария</span><br/>\n<span class=\"f_CodeExample\">        item.data.__name = c.name;</span><br/>\n<span class=\"f_CodeExample\">        item.data.email = [{ type: EmailType.Home, email: c.email }];</span><br/>\n<span class=\"f_CodeExample\">        item.data.body = c.body;</span><br/>\n<span class=\"f_CodeExample\">        item.data.postID = c.postId; </span><br/>\n<span class=\"f_CodeExample\">        items.push(item);</span><br/>\n<span class=\"f_CodeExample\">    }</span><br/>\n<span class=\"f_CodeExample\">// Пакетно сохраняем все созданные элементы комментариев</span><br/>\n<span class=\"f_CodeExample\">    await Context.fields.commentapp.app.batch().save().items(items).all();</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\">// Асинхронная функция, чтобы импортировать посты из внешнего сервиса</span><br/>\n<span class=\"f_CodeExample\">async function import_posts(): Promise&lt;void&gt; {</span><br/>\n<span class=\"f_CodeExample\">// Выполняем запрос к внешнему сервису для получения постов</span><br/>\n<span class=\"f_CodeExample\">    const result = await fetch('https:// externalservicewebsite.com/posts');</span><br/>\n<span class=\"f_CodeExample\">// Преобразуем ответ в формат JSON</span><br/>\n<span class=\"f_CodeExample\">    const posts = await result.json();</span><br/>\n<span class=\"f_CodeExample\">// Инициализируем массив для хранения элементов постов</span><br/>\n<span class=\"f_CodeExample\">    const items: any = [];</span><br/>\n<span class=\"f_CodeExample\">// Проходимся по каждому посту в полученном списке</span><br/>\n<span class=\"f_CodeExample\">    for (let p of posts) {</span><br/>\n<span class=\"f_CodeExample\">// Создаём новый элемент поста в приложении</span><br/>\n<span class=\"f_CodeExample\">        const item = Context.fields.postsapp.app.create();</span><br/>\n<span class=\"f_CodeExample\">// Заполняем поля элемента поста</span><br/>\n<span class=\"f_CodeExample\">        item.data.__name = p.title;</span><br/>\n<span class=\"f_CodeExample\">        item.data.body = p.body; </span><br/>\n<span class=\"f_CodeExample\">        item.data.postID = p.id;</span><br/>\n<span class=\"f_CodeExample\">        items.push(item);</span><br/>\n<span class=\"f_CodeExample\">    }</span><br/>\n<span class=\"f_CodeExample\">// Пакетно сохраняем все созданные элементы постов</span><br/>\n<span class=\"f_CodeExample\">    await Context.fields.postsapp.app.batch().save().items(items).all();</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n</td>\n</tr>\n</table>\n</div>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Сохраните и опубликуйте изменения.</li></ol>\n<p class=\"p_Normal\">После этого кнопки отобразятся в <a class=\"topiclink\" href=\"extention-settings.html#settings\">настройках модуля</a> интеграции. Теперь пользователь может использовать их, чтобы добавить новые элементы в приложения <span style=\"font-weight: bold;\">Посты</span> и <span style=\"font-weight: bold;\">Комментарии</span>.</p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Метод массового обновления полей элементов</span></h2>\n<p class=\"p_Normal\">Чтобы обновить множество полей элементов за один запрос, используйте в скрипте метод <code><b>app.batch().update()</b></code>. При этом вы можете:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">указать правила такого обновления;</li><li class=\"p_Normal\">определить критерии поиска элементов, которые нужно обновить;</li><li class=\"p_Normal\">ограничить количество обновляемых элементов.</li></ul>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"example-batch-update\"></a><span class=\"f_Heading3\">Пример массового обновления полей</span></h3>\n<p class=\"p_Normal\">В <a class=\"topiclink\" href=\"batch-actions.html#example-batch-save\">примере массового добавления элементов</a> мы перенесли из сторонней системы данные в приложения  <span style=\"font-weight: bold;\">Посты</span> и <span style=\"font-weight: bold;\">Комментарии</span>, используя в скрипте метод <code><b>app.batch().save()</b></code>. При этом поля <span style=\"font-weight: bold;\">Посты</span> в карточках комментариев и <span style=\"font-weight: bold;\">Комментарии</span> в карточках публикаций пока остались пустыми, т. к. ссылки на связанные элементы не передаются из внешней системы, а создаются в ELMA365.</p>\n<p class=\"p_Normal\">Чтобы сотрудники при работе в этих приложениях могли быстро находить нужную информацию, заполним эти пустые поля ссылками на связанные элементы.</p>\n<p class=\"p_Normal\">Рассмотрим, как массово обновить поля, используя метод <code><b>app.batch().update()</b></code>.</p>\n<p class=\"p_Normal\">В сторонней системе связь между публикациями и комментариями определяется через поле <span style=\"font-weight: bold;\">Номер</span> (<code><b>postID</b></code>). Значение в нём одинаково в связанных элементах. Используем это свойство в скрипте, чтобы по нему найти нужные публикации и добавить ссылки в поле <span style=\"font-weight: bold;\">Посты</span> на карточки комментариев.</p>\n<p class=\"p_Normal\">Для этого:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">В настроенном модуле интеграции перейдите на вкладку <a class=\"topiclink\" href=\"extention-settings.html#settings\">Настройки</a> и нажмите кнопку <span style=\"font-weight: bold;\">Изменить форму</span>.</li><li class=\"p_Normal\" value=\"2\">В открывшемся дизайнере интерфейсов добавьте виджет <a class=\"topiclink\" href=\"button_widget.html\">Кнопка</a> с названием <span style=\"font-weight: bold;\">Обновить поля</span>.</li><li class=\"p_Normal\" value=\"3\">На вкладке <span style=\"font-weight: bold;\">Скрипты</span> пропишите код, с помощью которого пользователь обновит связи между элементами приложений <span style=\"font-weight: bold;\">Посты</span> и <span style=\"font-weight: bold;\">Комментарии</span>. Если нажать кнопку <span style=\"font-weight: bold;\">Обновить поля</span>, в карточках комментариев появятся ссылки в полях <span style=\"font-weight: bold;\">Пост</span>.</li></ol>\n<p class=\"p_Normal\"><a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A2')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Пример кода</a></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A2\" style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">// Асинхронная функция, чтобы обновить поле Посты в комментариях</span><br/>\n<span class=\"f_CodeExample\">async function update_comments(): Promise&lt;void&gt; {</span><br/>\n<span class=\"f_CodeExample\">// Ищем и получаем посты из приложения Посты</span><br/>\n<span class=\"f_CodeExample\">    const posts = await Context.fields.postsapp.app.search().size(100).from(0).all();</span><br/>\n<span class=\"f_CodeExample\">    for (let p of posts) {</span><br/>\n<span class=\"f_CodeExample\">// Пакетно обновляем значения в поле Посты на карточках комментариев, сравнивая значения в поле Номер (postID). Если значения совпадают, то в поле Посты добавляется ссылка на связанный элемент</span><br/>\n<span class=\"f_CodeExample\">        await Context.fields.commentapp.app.batch().update().set(\"post\", (f, op) =&gt; p).where((f) =&gt; f.postID.eq(p.data.postID ?? 0)).all();</span><br/>\n<span class=\"f_CodeExample\">    }</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n</td>\n</tr>\n</table>\n</div>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Сохраните и опубликуйте изменения.</li></ol>\n<p class=\"p_Normal\">После этого кнопка <span style=\"font-weight: bold;\">Обновить поля</span> отобразится в <a class=\"topiclink\" href=\"extention-settings.html\">настройках модуля</a> интеграции. Теперь пользователь может использовать её, чтобы обновить поле <span style=\"font-weight: bold;\">Посты</span> в карточках комментариев.</p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Метод массового удаления элементов</span></h2>\n<p class=\"p_Normal\">Вы можете удалить множество элементов приложения за один запрос, используя в скрипте метод <code><b>app.batch().delete()</b></code>. При этом можно:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">определить условия поиска элементов, которые нужно удалить;</li><li class=\"p_Normal\">указать количество удаляемых элементов.</li></ul>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Пример массового удаления элементов</span> </h3>\n<p class=\"p_Normal\">В предыдущих примерах с помощью скриптов мы <a class=\"topiclink\" href=\"batch-actions.html#example-batch-save\">добавили данные из сторонней системы</a> в приложения <span style=\"font-weight: bold;\">Посты</span> и <span style=\"font-weight: bold;\">Комментарии</span> и <a class=\"topiclink\" href=\"batch-actions.html#example-batch-update\">обновили поля их элементов</a>.</p>\n<p class=\"p_Normal\">Теперь настроим массовое удаление данных с помощью скрипта. Добавим на страницу модуля интеграции со сторонней системой две кнопки. При нажатии на них пользователь сможет удалить устаревшие элементы приложений <span style=\"font-weight: bold;\">Посты</span> или <span style=\"font-weight: bold;\">Коментарии</span>, например, записи, которые созданы до 01.01.2024 г.</p>\n<p class=\"p_Normal\">Для этого:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">В модуле интеграции со сторонней системой перейдите на вкладку <span style=\"font-weight: bold;\">Настройки</span> и нажмите кнопку <span style=\"font-weight: bold;\">Изменить форму</span>.</li><li class=\"p_Normal\" value=\"2\">В открывшемся дизайнере интерфейсов добавьте виджет <span style=\"font-weight: bold;\">Кнопка</span>, задайте название <span style=\"font-weight: bold;\">Удалить посты</span> и тип <span style=\"font-weight: bold;\">Скрипт</span>.</li><li class=\"p_Normal\" value=\"3\">К этой кнопке привяжите скрипт массового удаления. Укажите в нём условие поиска элементов и количество записей, удаляемых за один запрос. В процессе выполнения скрипта количество таких запросов определяется автоматически. В примере будем удалять элементы, созданные до 01.01.2024 г., по 100 штук.<br/>\nДля этого в настройках кнопки на вкладке <span style=\"font-weight: bold;\">Основные</span> в поле <span style=\"font-weight: bold;\">Выполняемый скрипт</span> укажите название функции <code><b>delete_posts</b></code>. Затем нажмите <span style=\"font-weight: bold;\">Сохранить</span> и <span style=\"font-weight: bold;\">Открыть</span>.</li><li class=\"p_Normal\" value=\"4\">На открывшейся вкладке <span style=\"font-weight: bold;\">Скрипты</span> добавьте следующий скрипт:</li></ol>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">// Асинхронная функция, чтобы удалить все элементы из приложения Посты</span><br/>\n<span class=\"f_CodeExample\">async function delete_posts(): Promise&lt;void&gt; {</span><br/>\n<span class=\"f_CodeExample\">// указываем переменную, чтобы отследить количество удалённых элементов </span><br/>\n<span class=\"f_CodeExample\">    let rows = 0;</span><br/>\n<span class=\"f_CodeExample\">// используем цикл для удаления всех элементов</span><br/>\n<span class=\"f_CodeExample\">    do {</span><br/>\n<span class=\"f_CodeExample\">        rows = await </span><br/>\n<span class=\"f_CodeExample\">// Добавляем метод для массового удаления элементов в приложении Посты и указываем критерий отбора элементов, а также количество записей в одном запросе на удаление   </span><br/>\n<span class=\"f_CodeExample\">Context.fields.postsapp.app.batch().delete().where((f) =&gt; f.__createdAt.lt(new Datetime('2024-01-01'))).size(100).from(0).all();</span><br/>\n<span class=\"f_CodeExample\">    } </span><br/>\n<span class=\"f_CodeExample\">while (rows &gt; 0)    </span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n<ol start=\"5\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"5\">Теперь аналогичным образом нужно создать ещё одну кнопку для удаления записей в приложении <span style=\"font-weight: bold;\">Комментарии</span>. Удалять элементы будем по тем же условиям — в зависимости от их даты создания, по 100 штук.<br/>\nДля этого на вкладке <span style=\"font-weight: bold;\">Шаблон</span> добавьте виджет <span style=\"font-weight: bold;\">Кнопка</span>. Выполните такие же настройки как для кнопки <span style=\"font-weight: bold;\">Удалить посты</span>. При написании скрипта используйте код переменной приложения <span style=\"font-weight: bold;\">Комментарии</span>.</li><li class=\"p_Normal\" value=\"6\">Сохраните и опубликуйте обновления.</li></ol>\n<p class=\"p_Normal\">Теперь в настройках модуля отобразятся кнопки для удаления элементов из приложений <span style=\"font-weight: bold;\">Посты</span> и <span style=\"font-weight: bold;\">Комментарии</span> по дате их создания.</p>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"app-data-in-scripts.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">app-data-in-scripts.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"360009918011.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">360009918011.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n<script type=\"text/javascript\">\nHMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');\nHMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');\n</script>\n</body>\n</html>\n",
  "plain_text": "Массовые действия с элементами приложений в скрипте ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 Low-code дизайнер > Приложение > Работа с приложением в скриптах / Массовые действия с элементами приложений в скрипте Массовые действия с элементами приложений в скрипте В ELMA365 вы можете массово добавлять или удалять элементы, а также обновлять их поля через скрипт , используя методы на языке TypeScript . Это позволяет снизить нагрузку на систему и уменьшить влияние установленных лимитов, когда нужно обработать большое количество данных. Например, если у вас настроена интеграция со сторонней системой, можно из неё загрузить каталог товаров в приложение. Вы можете задать следующие методы в скриптах: app.batch().save() — массовое добавление элементов приложения; app.batch().update() — массовое обновление полей элементов приложения; app.batch().delete() — массовое удаление элементов приложения. При написании скриптов с методами для массовых операций учитывайте следующие условия: за один запрос обрабатывается не более 10000 элементов. Это ограничение применяется ко всем указанным методам; чтобы выполнить массовое действие с элементами при помощи метода, у пользователя должны быть права на импорт данных этого приложения . В статье рассмотрим на примерах, как использовать методы в скриптах. Подробнее читайте в справке ELMA365 TS SDK . Метод массового добавления элементов С помощью app.batch().save() пакет элементов приложения обрабатывается за один запрос. Используйте этот метод, чтобы: сохранить новые элементы в приложение; обновить поля существующих элементов. В этом случае укажите их идентификаторы, чтобы по ним найти нужные элементы, внести в них изменения и сохранить отредактированные элементы в базе данных. Пример массового добавления Предположим, компания использует для работы систему ELMA365. Сотрудники маркетинга также применяют сторонний сервис, в котором хранятся публикации по продукту и комментарии от клиентов. Чтобы работники смежных отделов могли увидеть все данные в одном месте, информацию из этого внешнего сервиса можно массово перенести в ELMA365. Для этого нужно: Создать приложения для загрузки публикаций и комментариев. Настроить интеграцию через пользовательский модуль и добавить в интерфейс модуля две кнопки со скриптами: Добавить посты — для массового переноса всех публикаций из стороннего сервиса в ELMA365; Добавить комментарии — для загрузки всех комментариев к этим публикациям. Шаг 1. Создать два приложения Для начала создайте приложения , чтобы импортировать в них данные. При этом добавляйте свойства приложений в соответствии с полями публикаций и комментариев в сторонней системе. Рассмотрим на примере: Посты — содержит свойства: Название ( __name ) — системное свойство, создаётся автоматически; Номер ( postID ) — тип Число (целое) для идентификационного номера, по которому во внешней системе определяется связь между публикацией и комментариями к ней, т. е. значения этого поля равны в связанных элементах; Дата создания ( __createdAt ) — тип Дата/время для хранения даты создания поста; Заголовок ( title ) — тип Строка (строка) для заголовка публикации; Текст ( body ) — тип Строка (текст) для текста публикации; Комментарии ( comments ) — тип Приложение (один) для ссылки на связанный комментарий. Комментарии — содержит свойства: Название ( __name ) — системное свойство, создаётся автоматически; Номер ( postID ) — тип Число (целое) для идентификационного номера, по которому во внешней системе определяется связь между публикацией и комментариями к ней, т. е. значения этого поля равны в связанных элементах; Дата создания ( __createdAt ) — тип Дата/время для хранения даты создания комментария; Электронная почта пользователя ( email ) — тип Электронная почта для электронной почты пользователя, оставившего комментарий; Сообщение ( body ) — тип Строка (текст) для текста комментария; Посты ( post ) — тип Приложение (один) для ссылки на связанный пост. С помощью этих свойств далее в скрипте определяются поля, в которые запишутся значения, переданные из внешнего сервиса. Подробнее про заполнение полей Комментарии и Посты типа Приложение (один) читайте в разделе «Пример массового обновления полей» . Шаг 2. Настроить загрузку данных через скрипт После создания приложений настройте импорт данных из сторонней системы. Для этого: В настроенном модуле интеграции перейдите на вкладку Настройки и нажмите кнопку Изменить форму . В открывшемся дизайнере интерфейсов: создайте кнопки Добавить посты и Добавить комментарии ; на вкладке Скрипты на стороне клиента пропишите код, используя app.batch().save() . Этот код позволит импортировать данные в приложения, когда пользователь нажмёт кнопку Добавить посты или Добавить комментарии . Пример кода /* Client scripts module */ declare const console: any; /* // Асинхронная функция, чтобы импортировать комментарии из внешнего сервиса async function import_comments(): Promise<void> { // Выполняем запрос к внешнему сервису для получения комментариев const result = await fetch('https://externalservicewebsite.com/comments'); // Преобразуем ответ в формат JSON const comments = await result.json(); // Инициализируем массив для хранения элементов комментариев const items: any = []; // Проходимся по каждому комментарию в полученном списке for (let c of comments) { // Создаём новый элемент комментария в приложении const item = Context.fields.commentapp.app.create(); // Заполняем поля элемента комментария item.data.__name = c.name; item.data.email = [{ type: EmailType.Home, email: c.email }]; item.data.body = c.body; item.data.postID = c.postId; items.push(item); } // Пакетно сохраняем все созданные элементы комментариев await Context.fields.commentapp.app.batch().save().items(items).all(); } // Асинхронная функция, чтобы импортировать посты из внешнего сервиса async function import_posts(): Promise<void> { // Выполняем запрос к внешнему сервису для получения постов const result = await fetch('https:// externalservicewebsite.com/posts'); // Преобразуем ответ в формат JSON const posts = await result.json(); // Инициализируем массив для хранения элементов постов const items: any = []; // Проходимся по каждому посту в полученном списке for (let p of posts) { // Создаём новый элемент поста в приложении const item = Context.fields.postsapp.app.create(); // Заполняем поля элемента поста item.data.__name = p.title; item.data.body = p.body; item.data.postID = p.id; items.push(item); } // Пакетно сохраняем все созданные элементы постов await Context.fields.postsapp.app.batch().save().items(items).all(); } Сохраните и опубликуйте изменения. После этого кнопки отобразятся в настройках модуля интеграции. Теперь пользователь может использовать их, чтобы добавить новые элементы в приложения Посты и Комментарии . Метод массового обновления полей элементов Чтобы обновить множество полей элементов за один запрос, используйте в скрипте метод app.batch().update() . При этом вы можете: указать правила такого обновления; определить критерии поиска элементов, которые нужно обновить; ограничить количество обновляемых элементов. Пример массового обновления полей В примере массового добавления элементов мы перенесли из сторонней системы данные в приложения Посты и Комментарии , используя в скрипте метод app.batch().save() . При этом поля Посты в карточках комментариев и Комментарии в карточках публикаций пока остались пустыми, т. к. ссылки на связанные элементы не передаются из внешней системы, а создаются в ELMA365. Чтобы сотрудники при работе в этих приложениях могли быстро находить нужную информацию, заполним эти пустые поля ссылками на связанные элементы. Рассмотрим, как массово обновить поля, используя метод app.batch().update() . В сторонней системе связь между публикациями и комментариями определяется через поле Номер ( postID ). Значение в нём одинаково в связанных элементах. Используем это свойство в скрипте, чтобы по нему найти нужные публикации и добавить ссылки в поле Посты на карточки комментариев. Для этого: В настроенном модуле интеграции перейдите на вкладку Настройки и нажмите кнопку Изменить форму . В открывшемся дизайнере интерфейсов добавьте виджет Кнопка с названием Обновить поля . На вкладке Скрипты пропишите код, с помощью которого пользователь обновит связи между элементами приложений Посты и Комментарии . Если нажать кнопку Обновить поля , в карточках комментариев появятся ссылки в полях Пост . Пример кода // Асинхронная функция, чтобы обновить поле Посты в комментариях async function update_comments(): Promise<void> { // Ищем и получаем посты из приложения Посты const posts = await Context.fields.postsapp.app.search().size(100).from(0).all(); for (let p of posts) { // Пакетно обновляем значения в поле Посты на карточках комментариев, сравнивая значения в поле Номер (postID). Если значения совпадают, то в поле Посты добавляется ссылка на связанный элемент await Context.fields.commentapp.app.batch().update().set(\"post\", (f, op) => p).where((f) => f.postID.eq(p.data.postID ?? 0)).all(); } } Сохраните и опубликуйте изменения. После этого кнопка Обновить поля отобразится в настройках модуля интеграции. Теперь пользователь может использовать её, чтобы обновить поле Посты в карточках комментариев. Метод массового удаления элементов Вы можете удалить множество элементов приложения за один запрос, используя в скрипте метод app.batch().delete() . При этом можно: определить условия поиска элементов, которые нужно удалить; указать количество удаляемых элементов. Пример массового удаления элементов В предыдущих примерах с помощью скриптов мы добавили данные из сторонней системы в приложения Посты и Комментарии и обновили поля их элементов . Теперь настроим массовое удаление данных с помощью скрипта. Добавим на страницу модуля интеграции со сторонней системой две кнопки. При нажатии на них пользователь сможет удалить устаревшие элементы приложений Посты или Коментарии , например, записи, которые созданы до 01.01.2024 г. Для этого: В модуле интеграции со сторонней системой перейдите на вкладку Настройки и нажмите кнопку Изменить форму . В открывшемся дизайнере интерфейсов добавьте виджет Кнопка , задайте название Удалить посты и тип Скрипт . К этой кнопке привяжите скрипт массового удаления. Укажите в нём условие поиска элементов и количество записей, удаляемых за один запрос. В процессе выполнения скрипта количество таких запросов определяется автоматически. В примере будем удалять элементы, созданные до 01.01.2024 г., по 100 штук. Для этого в настройках кнопки на вкладке Основные в поле Выполняемый скрипт укажите название функции delete_posts . Затем нажмите Сохранить и Открыть . На открывшейся вкладке Скрипты добавьте следующий скрипт: // Асинхронная функция, чтобы удалить все элементы из приложения Посты async function delete_posts(): Promise<void> { // указываем переменную, чтобы отследить количество удалённых элементов let rows = 0; // используем цикл для удаления всех элементов do { rows = await // Добавляем метод для массового удаления элементов в приложении Посты и указываем критерий отбора элементов, а также количество записей в одном запросе на удаление Context.fields.postsapp.app.batch().delete().where((f) => f.__createdAt.lt(new Datetime('2024-01-01'))).size(100).from(0).all(); } while (rows > 0) } Теперь аналогичным образом нужно создать ещё одну кнопку для удаления записей в приложении Комментарии . Удалять элементы будем по тем же условиям — в зависимости от их даты создания, по 100 штук. Для этого на вкладке Шаблон добавьте виджет Кнопка . Выполните такие же настройки как для кнопки Удалить посты . При написании скрипта используйте код переменной приложения Комментарии . Сохраните и опубликуйте обновления. Теперь в настройках модуля отобразятся кнопки для удаления элементов из приложений Посты и Комментарии по дате их создания. app-data-in-scripts.html 360009918011.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/360006963072.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/app-data-in-scripts.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/type-script.html",
    "https://www.typescriptlang.org/",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/360007527512.html",
    "https://tssdk.elma365.com/ru/latest/pages/quick-start/intro_batch.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/extentions.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/360007235031.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/360009707032.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/batch-actions.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/extention-settings.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/button_widget.html",
    "https://elma365.com/ru/help/kedo/ru/help/platform/ru/help/business_solutions/360009918011.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T21:49:52.189569",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T21:49:52.294492"
  }
}