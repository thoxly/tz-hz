{
  "doc_id": "portable-microservices",
  "url": "https://elma365.com/ru/help/business_solutions/ru/help/crm/portable-microservices.html",
  "title": "Переносимые сервисы в модулях",
  "breadcrumbs": [
    "Разработка решений на платформе ELMA365"
  ],
  "section": "Разработка решений на платформе ELMA365 | [business_solutions]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>Переносимые сервисы в модулях</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"публичного репозитория Docker Hub,Число\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"Когда возможностей Low-code платформы недостаточно для оптимальной интеграции процессов в существующий информационный ландшафт, мы рекомендуем создавать собственные...\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/portable-microservices.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p><a href=\"solutions-building.html\">Разработка решений на платформе ELMA365</a> / Переносимые сервисы в модулях</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Переносимые сервисы в модулях</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p class=\"p_Normal\">Когда возможностей Low-code платформы недостаточно для оптимальной интеграции процессов в существующий информационный ландшафт, мы рекомендуем создавать <a class=\"topiclink\" href=\"custom_services.html\">собственные микросервисы</a>. Область применения таких сервисов очень большая и покрывает самые требовательные задачи бизнеса.</p>\n<p class=\"p_Normal\">При установке сервиса независимо от платформы ELMA365 и его самостоятельной поддержке конечный разработчик и администратор могут столкнуться с трудностями в установке и эксплуатации решения.</p>\n<p class=\"p_Normal\">Чтобы упростить и ускорить разработку собственных микросервисов, можно создать переносимый сервис внутри пользовательского модуля.</p>\n<p class=\"p_Normal\">Способ подключения переносимого сервиса выбирается в зависимости от необходимых функциональных возможностей его исполнения и от используемой поставки ELMA365:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\">Сервисом может быть <a class=\"weblink\" href=\"https://www.docker.com/\" target=\"_blank\">Docker‑контейнер</a>. Он оборачивается и размещается в отдельном пространстве в среде исполнения Kubernetes. Способ доступен в поставках ELMA365 On‑Premises и SaaS Enterprise.</li><li class=\"p_Normal\" value=\"2\">Cервис функционирует на сторонней площадке с публичным адресом доступа. В этом случае можно только обращаться к сервису с запросами. Такой способ доступен для всех поставок, но используется преимущественно в SaaS Standard.</li></ol>\n<p style=\"margin: 7px 0 16px 0;\"><img alt=\"portable-microservices-1\" height=\"457\" src=\"portable-microservices-1.png\" style=\"margin:0;width:993px;height:457px;border:none\" width=\"993\"/></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"characteristics\"></a><span class=\"f_Heading2\">Особенности добавления сервисов в модули</span></h2>\n<p class=\"p_Normal\">Сервисы и контейнеры, которые можно установить в модуль, имеют ряд ограничений и особенностей:</p>\n<ol style=\"list-style-type:decimal\">\n<li class=\"p_Normal\" value=\"1\">В поставках ELMA365 On‑Premises и SaaS Enterprise поддерживается указание URL‑адреса контейнера. При этом Docker‑образ сервиса не является частью модуля. Это означает, что вы должны предварительно разместить образ своего сервиса в публичном или приватном репозитории в Docker Hub. Также сам образ сервиса не упаковывается при экспорте модуля и не переносится с пакетом <span style=\"font-weight: bold;\">.e365</span>. На данный момент при установке готового модуля с сервисами системе требуется доступ к указанному адресу репозитория для скачивания Docker-образа.</li><li class=\"p_Normal\" value=\"2\">Чтобы модуль с переносимым сервисом можно было использовать в поставке SaaS Standard, нужно указать альтернативный адрес сервиса. Это означает, что предварительно следует обеспечить работу сервиса на сторонней площадке с публичным адресом доступа.</li><li class=\"p_Normal\" value=\"3\">Если в поставках ELMA365 On‑Premises и SaaS Enterprise в настройках модуля указать оба варианта подключения микросервиса, для установки взаимодействия преимущественно используется адрес образа. Подключение через альтернативный адрес применяется при разрыве соединения.</li><li class=\"p_Normal\" value=\"4\">По умолчанию у переносимых сервисов нет лимитов на ресурсы выполнения.</li><li class=\"p_Normal\" value=\"5\">В поставках ELMA365 On‑Premises и SaaS Enterprise можно <a class=\"topiclink\" href=\"configmap.html\">задать параметры развёртывания микросервиса с помощью ConfigMap</a>. Например, ограничить потребление ресурсов, настроить автомасштабирование сервиса и т. д.</li><li class=\"p_Normal\" value=\"6\">Взаимодействие с переносимым сервисом возможно только внутри модуля, в котором он создан. Доступ к сервису осуществляется через HTTP‑запросы:</li></ol>\n<ol style=\"list-style-type:decimal\"><ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">из серверных скриптов модуля;</li><li class=\"p_Normal\">из клиентских и серверных скриптов модуля с помощью <a class=\"topiclink\" href=\"extention-api.html#delegated\">делегированных методов API</a>.</li></ul></ol>\n<p class=\"p_Normal\" style=\"margin: 0 0 0 32px;\">Сам сервис может обмениваться данными с любой внешней системой. При этом доступно использование различных каналов связи и протоколов взаимодействия.</p>\n<p style=\"margin: 7px 0 16px 0;\">Ознакомиться с дополнительной информацией о переносимых сервисах можно в статьях:</p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 16px;\"><a class=\"topiclink\" href=\"portable-services.html\">«Настройка переносимого сервиса в модуле»</a> — создание сервиса в пользовательском модуле; </li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 16px;\"><a class=\"topiclink\" href=\"enable-portable-services.html\">«Включение переносимых сервисов»</a> — включение переносимых сервисов в ELMA365 Enterprise;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 16px;\"><a class=\"topiclink\" href=\"development-key-points.html\">«Рекомендации по разработке микросервисов для переносимых сервисов»</a> — разработка собственного микросервиса;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 16px;\"><a class=\"topiclink\" href=\"configmap.html\">«Настройка параметров переносимых сервисов через ConfigMap»</a> — настройка дополнительных параметров развёртывания микросервиса с помощью ConfigMap.</li></ul>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"example-of-use\"></a><span class=\"f_Heading2\">Пример настройки и использования переносимого сервиса</span></h2>\n<p class=\"p_Normal\">Предположим, что в одном из решений понадобилось генерировать и показывать математические формулы. Пользователи хорошо владеют языком описания формул LaTeX. В решении необходимо реализовать генерацию изображений из формулы LaTeX.</p>\n<p class=\"p_Normal\">Для этого создадим модуль и подключим переносимый сервис. Чтобы этот модуль использовать во всех поставках ELMA365, рассмотрим способы подключения сервиса с помощью: </p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><a class=\"topiclink\" href=\"portable-microservices.html#service-creation\">адреса образа микросервиса в поставках On‑Premises и SaaS Enterprise</a>; </li><li class=\"p_Normal\"><a class=\"topiclink\" href=\"portable-microservices.html#alternative-address\">альтернативного адреса сервиса в поставке SaaS Standard</a>.</li></ul>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"service-creation\"></a><span class=\"f_Heading3\">Настроить адрес образа сервиса в On-Premises и SaaS Enterprise</span></h3>\n<p class=\"p_Normal\">В поставках ELMA365 On‑Premises и SaaS Enterprise можно скачать и установить сервис в виде Docker‑контейнера. Чтобы настроить его загрузку при включении модуля, укажите адрес образа.</p>\n<p class=\"p_Normal\">Для примера рассмотрим <a class=\"weblink\" href=\"https://github.com/chialab/math-api\" target=\"_blank\">готовый контейнер с сервисом генерации изображения по формуле</a>. Его можно собрать самостоятельно из исходного кода и разместить в своём приватном репозитории или использовать готовый из <a class=\"weblink\" href=\"https://hub.docker.com/r/chialab/math-api\" target=\"_blank\">публичного репозитория Docker Hub</a>.</p>\n<p class=\"p_Normal\">Чтобы настроить подключение сервиса:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\"><a class=\"topiclink\" href=\"create-extention.html\">Создайте пользовательский модуль</a> и перейдите на вкладку <span style=\"font-weight: bold;\">Сервисы</span>.</li><li class=\"p_Normal\" value=\"2\"><a class=\"topiclink\" href=\"portable-services.html#add-portable-microservices\">Добавьте новый сервис</a> и укажите:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">имя сервиса;</li><li class=\"p_Normal\">адрес образа, указывающий путь к репозиторию. В зависимости от размещения Docker‑образа можно указать <a class=\"topiclink\" href=\"portable-services.html#image-address-formats\">краткий или полный адрес</a>; </li><li class=\"p_Normal\">данные авторизации, если для доступа к репозиторию с Docker-образом сервиса требуются <a class=\"topiclink\" href=\"portable-services.html#image-address\">логин и токен</a>;</li><li class=\"p_Normal\">порт, через который будет происходить взаимодействие с микросервисом.</li></ul>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">После сохранения заполненных полей откроется окно <span style=\"font-weight: bold;\">Редактирование сервиса</span>, где вы можете <a class=\"topiclink\" href=\"portable-services.html#main-tab\">задать настройки подключения</a> — указать дополнительные порты и количество экземпляров микросервиса. Для этого нажмите значок шестерёнки рядом с опцией <span style=\"font-weight: bold;\">Docker контейнер</span>.<br/>\n<img alt=\"portable-microservices-2\" height=\"315\" src=\"portable-microservices-2.png\" style=\"margin:0;width:597px;height:315px;border:none\" width=\"597\"/></li></ol>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Сохраните настройки.</li></ol>\n<p class=\"p_Normal\">Теперь при включённом модуле можно <a class=\"topiclink\" href=\"portable-microservices.html#using-service-in-widget\">использовать сервис</a> и обращаться к нему в скриптах.</p>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"alternative-address\"></a><span class=\"f_Heading3\">Настроить альтернативный адрес сервиса в SaaS Standard</span></h3>\n<p class=\"p_Normal\">Такой способ настройки предполагает, что сервис предварительно устанавливается на внешнем хостинге с публичным доступом. При настройке сервиса в модуле указывается альтернативный адрес, чтобы через него направлять запросы на сторонний ресурс, где работает сервис. </p>\n<p class=\"p_Normal\">Этот способ доступен во всех поставках ELMA365, но преимущественно применяется в SaaS Standard, поскольку в этой поставке нельзя скачивать сервис с помощью адреса образа.</p>\n<p class=\"p_Normal\">Чтобы настроить подключение сервиса через альтернативный адрес, выполните следующие шаги:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\"><a class=\"topiclink\" href=\"create-extention.html\">Создайте пользовательский модуль</a> и перейдите на вкладку <span style=\"font-weight: bold;\">Сервисы</span>.</li><li class=\"p_Normal\" value=\"2\">Добавьте сервис и в открывшемся окне заполните его имя.</li><li class=\"p_Normal\" value=\"3\">Затем внесите адрес сторонней площадки, на которой настроена работа сервиса. Его можно указать в строковом представлении или использовать <a class=\"topiclink\" href=\"portable-services.html#alternative-address\">шаблон адреса</a>.</li></ol>\n<p class=\"p_Normal\">В нашем примере применяется следующий шаблон <code><b>{$protocol}{$base_math_url}</b></code>. Для этого в настройках модуля создано два параметра:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\">протокол адреса сервиса (<code><b>protocol</b></code>) — в этом поле указывается протокол передачи данных, например <span style=\"font-weight: bold;\">https://</span>;</li><li class=\"p_Normal\">имя адреса сервиса (<code><b>base_math_url</b></code>) — в этом поле указывается путь к ресурсу, в котором размещён переносимый сервис, например <span style=\"font-weight: bold;\">example.mathcalculation.com</span>.<br/>\n<img alt=\"portable-microservices-6\" height=\"317\" src=\"portable-microservices-6.png\" style=\"margin:0;width:554px;height:317px;border:none\" width=\"554\"/></li></ul>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Сохраните настройки. </li></ol>\n<p class=\"p_Normal\">Теперь, когда вы включите модуль и укажете адрес сервиса в его настройках, к сервису можно будет обращаться в пользовательских скриптах.</p>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"using-service-in-widget\"></a><span class=\"f_Heading3\">Использовать сервис в виджете</span></h3>\n<p class=\"p_Normal\">Созданный сервис можно использовать в серверном скрипте виджета для генерации картинки, применив HTTP‑метод <code><b>GET /render</b></code>. Об этом говорится в <a class=\"weblink\" href=\"https://hub.docker.com/r/chialab/math-api#get-render\">описании сервиса</a>. </p>\n<p class=\"p_Normal\">В виджете пользователь указывает формулу в поле типа <a class=\"topiclink\" href=\"360009707032.html\">Строка</a> и желаемую ширину картинки — поле типа <a class=\"topiclink\" href=\"360009707032.html#number\">Число</a>.</p>\n<p class=\"p_Normal\">Пример готового скрипта:</p>\n<p class=\"p_CodeExample\" style=\"white-space: normal; page-break-inside: avoid;\"><span class=\"f_CodeExample\">async </span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">function</span><span class=\"f_CodeExample\"> renderImage(): Promise&lt;</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">void</span><span class=\"f_CodeExample\">&gt; {</span><br/>\n<span class=\"f_CodeExample\">    let source = encodeURIComponent(Context.data.formula!);</span><br/>\n<span class=\"f_CodeExample\">    let width = encodeURIComponent((Context.data.shirina_kartinki || 400).toString());</span><br/>\n<span class=\"f_CodeExample\">    let imgResp = await Namespace.services.math.fetch(`/render?input=latex&amp;inline=1&amp;output=png&amp;source=${source}&amp;width=${width}`, {</span><br/>\n<span class=\"f_CodeExample\">        headers: {</span><br/>\n<span class=\"f_CodeExample\">            \"Accept\" : \"image/png\"</span><br/>\n<span class=\"f_CodeExample\">        }</span><br/>\n<span class=\"f_CodeExample\">    });</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">    let buff = await imgResp.arrayBuffer();</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">    Context.data.kartinka = await Context.fields.kartinka.create(`render-${Date.now()}.png`, buff);</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n<p class=\"p_Normal\">В примере <code><b>Namespace.services.math</b></code> используется для доступа к сервису. Это позволяет вызывать HTTP‑методы сервиса в серверных скриптах TS SDK. Для вызова указывается относительный адрес метода, остальное реализуется возможностями ELMA365.</p>\n<p class=\"p_Normal\">В самом скрипте осуществляется запрос к методу сервиса. В ответе в буфере выдаётся картинка, её необходимо сохранить в виде файла и указать в переменной типа <a class=\"topiclink\" href=\"360009707032.html#file_type\">Файлы.</a> </p>\n<p class=\"p_Normal\">В результате реализован виджет, который можно использовать на любой странице или форме в системе:</p>\n<p class=\"p_Normal\"><img alt=\"portable-microservices_4\" height=\"171\" src=\"portable-microservices_4.png\" style=\"margin:0;width:413px;height:171px;border:none\" width=\"413\"/></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Сгенерированная картинка будет выглядеть следующим образом: </p>\n<p class=\"p_Normal\"><img alt=\"portable-microservices_1\" height=\"125\" src=\"portable-microservices_1.png\" style=\"margin:0;width:383px;height:125px;border:none\" width=\"383\"/></p>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"npm-package.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">npm-package.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"development-key-points.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">development-key-points.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n</body>\n</html>\n",
  "plain_text": "Переносимые сервисы в модулях ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 Разработка решений на платформе ELMA365 / Переносимые сервисы в модулях Переносимые сервисы в модулях Когда возможностей Low-code платформы недостаточно для оптимальной интеграции процессов в существующий информационный ландшафт, мы рекомендуем создавать собственные микросервисы . Область применения таких сервисов очень большая и покрывает самые требовательные задачи бизнеса. При установке сервиса независимо от платформы ELMA365 и его самостоятельной поддержке конечный разработчик и администратор могут столкнуться с трудностями в установке и эксплуатации решения. Чтобы упростить и ускорить разработку собственных микросервисов, можно создать переносимый сервис внутри пользовательского модуля. Способ подключения переносимого сервиса выбирается в зависимости от необходимых функциональных возможностей его исполнения и от используемой поставки ELMA365: Сервисом может быть Docker‑контейнер . Он оборачивается и размещается в отдельном пространстве в среде исполнения Kubernetes. Способ доступен в поставках ELMA365 On‑Premises и SaaS Enterprise. Cервис функционирует на сторонней площадке с публичным адресом доступа. В этом случае можно только обращаться к сервису с запросами. Такой способ доступен для всех поставок, но используется преимущественно в SaaS Standard. Особенности добавления сервисов в модули Сервисы и контейнеры, которые можно установить в модуль, имеют ряд ограничений и особенностей: В поставках ELMA365 On‑Premises и SaaS Enterprise поддерживается указание URL‑адреса контейнера. При этом Docker‑образ сервиса не является частью модуля. Это означает, что вы должны предварительно разместить образ своего сервиса в публичном или приватном репозитории в Docker Hub. Также сам образ сервиса не упаковывается при экспорте модуля и не переносится с пакетом .e365 . На данный момент при установке готового модуля с сервисами системе требуется доступ к указанному адресу репозитория для скачивания Docker-образа. Чтобы модуль с переносимым сервисом можно было использовать в поставке SaaS Standard, нужно указать альтернативный адрес сервиса. Это означает, что предварительно следует обеспечить работу сервиса на сторонней площадке с публичным адресом доступа. Если в поставках ELMA365 On‑Premises и SaaS Enterprise в настройках модуля указать оба варианта подключения микросервиса, для установки взаимодействия преимущественно используется адрес образа. Подключение через альтернативный адрес применяется при разрыве соединения. По умолчанию у переносимых сервисов нет лимитов на ресурсы выполнения. В поставках ELMA365 On‑Premises и SaaS Enterprise можно задать параметры развёртывания микросервиса с помощью ConfigMap . Например, ограничить потребление ресурсов, настроить автомасштабирование сервиса и т. д. Взаимодействие с переносимым сервисом возможно только внутри модуля, в котором он создан. Доступ к сервису осуществляется через HTTP‑запросы: из серверных скриптов модуля; из клиентских и серверных скриптов модуля с помощью делегированных методов API . Сам сервис может обмениваться данными с любой внешней системой. При этом доступно использование различных каналов связи и протоколов взаимодействия. Ознакомиться с дополнительной информацией о переносимых сервисах можно в статьях: «Настройка переносимого сервиса в модуле» — создание сервиса в пользовательском модуле; «Включение переносимых сервисов» — включение переносимых сервисов в ELMA365 Enterprise; «Рекомендации по разработке микросервисов для переносимых сервисов» — разработка собственного микросервиса; «Настройка параметров переносимых сервисов через ConfigMap» — настройка дополнительных параметров развёртывания микросервиса с помощью ConfigMap. Пример настройки и использования переносимого сервиса Предположим, что в одном из решений понадобилось генерировать и показывать математические формулы. Пользователи хорошо владеют языком описания формул LaTeX. В решении необходимо реализовать генерацию изображений из формулы LaTeX. Для этого создадим модуль и подключим переносимый сервис. Чтобы этот модуль использовать во всех поставках ELMA365, рассмотрим способы подключения сервиса с помощью: адреса образа микросервиса в поставках On‑Premises и SaaS Enterprise ; альтернативного адреса сервиса в поставке SaaS Standard . Настроить адрес образа сервиса в On-Premises и SaaS Enterprise В поставках ELMA365 On‑Premises и SaaS Enterprise можно скачать и установить сервис в виде Docker‑контейнера. Чтобы настроить его загрузку при включении модуля, укажите адрес образа. Для примера рассмотрим готовый контейнер с сервисом генерации изображения по формуле . Его можно собрать самостоятельно из исходного кода и разместить в своём приватном репозитории или использовать готовый из публичного репозитория Docker Hub . Чтобы настроить подключение сервиса: Создайте пользовательский модуль и перейдите на вкладку Сервисы . Добавьте новый сервис и укажите: имя сервиса; адрес образа, указывающий путь к репозиторию. В зависимости от размещения Docker‑образа можно указать краткий или полный адрес ; данные авторизации, если для доступа к репозиторию с Docker-образом сервиса требуются логин и токен ; порт, через который будет происходить взаимодействие с микросервисом. После сохранения заполненных полей откроется окно Редактирование сервиса , где вы можете задать настройки подключения — указать дополнительные порты и количество экземпляров микросервиса. Для этого нажмите значок шестерёнки рядом с опцией Docker контейнер . Сохраните настройки. Теперь при включённом модуле можно использовать сервис и обращаться к нему в скриптах. Настроить альтернативный адрес сервиса в SaaS Standard Такой способ настройки предполагает, что сервис предварительно устанавливается на внешнем хостинге с публичным доступом. При настройке сервиса в модуле указывается альтернативный адрес, чтобы через него направлять запросы на сторонний ресурс, где работает сервис. Этот способ доступен во всех поставках ELMA365, но преимущественно применяется в SaaS Standard, поскольку в этой поставке нельзя скачивать сервис с помощью адреса образа. Чтобы настроить подключение сервиса через альтернативный адрес, выполните следующие шаги: Создайте пользовательский модуль и перейдите на вкладку Сервисы . Добавьте сервис и в открывшемся окне заполните его имя. Затем внесите адрес сторонней площадки, на которой настроена работа сервиса. Его можно указать в строковом представлении или использовать шаблон адреса . В нашем примере применяется следующий шаблон {$protocol}{$base_math_url} . Для этого в настройках модуля создано два параметра: протокол адреса сервиса ( protocol ) — в этом поле указывается протокол передачи данных, например https:// ; имя адреса сервиса ( base_math_url ) — в этом поле указывается путь к ресурсу, в котором размещён переносимый сервис, например example.mathcalculation.com . Сохраните настройки. Теперь, когда вы включите модуль и укажете адрес сервиса в его настройках, к сервису можно будет обращаться в пользовательских скриптах. Использовать сервис в виджете Созданный сервис можно использовать в серверном скрипте виджета для генерации картинки, применив HTTP‑метод GET /render . Об этом говорится в описании сервиса . В виджете пользователь указывает формулу в поле типа Строка и желаемую ширину картинки — поле типа Число . Пример готового скрипта: async function renderImage(): Promise< void > { let source = encodeURIComponent(Context.data.formula!); let width = encodeURIComponent((Context.data.shirina_kartinki || 400).toString()); let imgResp = await Namespace.services.math.fetch(`/render?input=latex&inline=1&output=png&source=${source}&width=${width}`, { headers: { \"Accept\" : \"image/png\" } }); let buff = await imgResp.arrayBuffer(); Context.data.kartinka = await Context.fields.kartinka.create(`render-${Date.now()}.png`, buff); } В примере Namespace.services.math используется для доступа к сервису. Это позволяет вызывать HTTP‑методы сервиса в серверных скриптах TS SDK. Для вызова указывается относительный адрес метода, остальное реализуется возможностями ELMA365. В самом скрипте осуществляется запрос к методу сервиса. В ответе в буфере выдаётся картинка, её необходимо сохранить в виде файла и указать в переменной типа Файлы. В результате реализован виджет, который можно использовать на любой странице или форме в системе: Сгенерированная картинка будет выглядеть следующим образом: npm-package.html development-key-points.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/solutions-building.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/custom_services.html",
    "https://www.docker.com/",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/configmap.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/extention-api.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/portable-services.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/enable-portable-services.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/development-key-points.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/portable-microservices.html",
    "https://github.com/chialab/math-api",
    "https://hub.docker.com/r/chialab/math-api",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/create-extention.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/360009707032.html",
    "https://elma365.com/ru/help/business_solutions/ru/help/crm/npm-package.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T22:03:43.418443",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T22:03:43.516808"
  }
}