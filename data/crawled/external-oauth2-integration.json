{
  "doc_id": "external-oauth2-integration",
  "url": "https://elma365.com/ru/help/crm/ru/help/business_solutions/external-oauth2-integration.html",
  "title": "Пользовательский модуль OAuth2 для авторизации через сторонние сервисы",
  "breadcrumbs": [
    "Модули расширения системы"
  ],
  "section": "Модули расширения системы | [crm]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>Пользовательский модуль для авторизации через сторонние сервисы</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"По умолчанию авторизация пользователей в ELMA365 или на внешнем портале осуществляется по логину и паролю. Вы можете реализовать регистрацию и авторизацию пользователей через...\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/external-oauth2-integration.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p><a href=\"360024498352.html\">Модули расширения системы</a> &gt; Примеры модулей интеграции с ELMA365 / Пользовательский модуль для авторизации через сторонние сервисы</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Пользовательский модуль OAuth2 для авторизации через сторонние сервисы</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p class=\"p_Normal\">По умолчанию авторизация пользователей в ELMA365 или на <a class=\"topiclink\" href=\"service-portal.html\">внешнем портале</a> осуществляется по логину и паролю. Вы можете реализовать регистрацию и авторизацию пользователей через сторонние сервисы, например, соцсети, учётные записи Google или Яндекс. Для этого необходимо создать и настроить <a class=\"topiclink\" href=\"extentions.html\">пользовательский модуль</a> OAuth2. После подключения модуля новый способ авторизации станет доступен в ELMA365. Также вы сможете подключить модуль к каждому порталу компании. <span style=\"font-family: Inter;\">Кроме того, вы можете настроить </span><span style=\"font-family: Inter; color: #0563c1;\"><a class=\"topiclink\" href=\"external-oauth2-integration.html#inbox-auth-module\">модуль для авторизации при подключении почты</a></span><span style=\"font-family: Inter;\">.</span></p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало внимание</span></p>\n<p class=\"p_Normal\">Создавать и настраивать модули могут только пользователи, включённые в группу <a class=\"topiclink\" href=\"360006871932.html#administrators\">Администраторы</a>.</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец внимание</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"create-module\"></a><span class=\"f_Heading2\">Создание и настройка модуля</span></h2>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Чтобы создать новый модуль, перейдите </span>в <span style=\"font-weight: bold;\">Администрирование &gt; Модули</span>,<span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> нажмите кнопку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">+ Модуль </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">и в открывшемся окне выберите опцию </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Создать</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">. Заполните информацию о модуле и нажмите кнопку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Создать</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">. Подробнее читайте в статье </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0563c1;\"><a class=\"topiclink\" href=\"create-extention.html\">«Создание модуля».</a></span></p>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"add-mandatory-parameters\"></a><span class=\"f_Heading3\">Добавление обязательных настроек</span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Добавьте в модуль OAuth2 обязательные настройки. Это глобальные параметры, которые будут использоваться в скриптах модуля.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Перейдите на вкладку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold; background-color: #ffffff;\">Настройки</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">, нажмите </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold; background-color: #ffffff;\">+ Добавить</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\"> и создайте необходимое количество свойств, в которых будут храниться значения настроек.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Отображаемые названия свойств могут быть произвольными. Имена же свойств должны совпадать с именами, указанными ниже в скобках, поскольку они используются для распознавания типа модуля.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Для корректной работы модуля авторизации в системе обязательно добавьте следующие свойства типа <a class=\"topiclink\" href=\"360009707032.html#string\">Строка</a>:</span></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; font-weight: bold; color: #303030;\">ID приложения</span><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; color: #303030;\"> (</span><code><b>client_id</b></code><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; color: #303030;\">) — и</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">дентификатор приложения на стороне внешнего сервиса, которое будет запрашивать данные для авторизации. Выдаётся при </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0070c0;\"><a class=\"topiclink\" href=\"external-oauth2-integration.html#external-service-registration\">регистрации приложения</a> </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">в стороннем сервисе; </span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Защищённый ключ</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> (</span><code><b>client_secret</b></code><span style=\"font-size: 12px; font-family: Consolas; color: #1f1f1f; background-color: #ffffff;\">)</span><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; color: #303030;\"> — </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">секретный ключ приложения. Выдаётся при регистрации приложения в стороннем сервисе. Вместе с </span><code><b>client_id</b></code><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> используется для получения токена доступа к API стороннего сервиса; </span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Адрес аутентификации</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> (</span><code><b>auth_url</b></code><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; color: #303030;\">) — </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">адрес страницы авторизации в стороннем сервисе, на которую пользователь будет перенаправлен из приложения; </span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; font-weight: bold; color: #303030;\">Адрес получения токена</span><span style=\"font-size: 12px; font-family: Consolas; color: #1f1f1f; background-color: #ffffff;\"> (</span><code><b>token_url</b></code><span style=\"font-size: 12px; font-family: Consolas; color: #1f1f1f; background-color: #ffffff;\">)</span><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; color: #303030;\"> — адрес на стороне сервиса, на который будет отправлен запрос для получения ключа доступа к API (access‑токена)</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">. В запросе указываются </span><code><b>client_id</b></code><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> и </span><code><b>client_secret</b></code><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">;</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; font-weight: bold; color: #303030;\">Права доступа </span><span style=\"font-size: 12px; font-family: Consolas; color: #1f1f1f; background-color: #ffffff;\">(</span><code><b>scopes</b></code><span style=\"font-size: 12px; font-family: Consolas; color: #1f1f1f; background-color: #ffffff;\">)</span><span style=\"font-size: 13px; font-family: 'Segoe UI',Tahoma,Verdana,Arial,sans-serif; color: #303030;\"> — права доступа, которые будут предоставлены приложению в стороннем сервисе по access‑токену. </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Названия прав доступа разделяются пробелом. Обязательно необходимо запрашивать доступ к сведениям, которые позволяют однозначно идентифицировать пользователя, например, к адресу электронной почты; </span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><a class=\"hmanchor\" id=\"automatic-sign-up\"></a><span style=\"font-weight: bold;\">Автоматическая регистрация</span> (<code><b>auto_signup</b></code>) — свойство типа <a class=\"topiclink\" href=\"360009707032.html#yes_no\">Выбор «да/нет»</a>. Если параметр установлен в значение <span style=\"font-weight: bold;\">Да</span>, внутренние или внешние пользователи, которые ранее отсутствовали в системе, автоматически добавятся в ELMA365 при авторизации. В этом случае в карточке пользователя отобразится только его электронный адрес.</li></ul>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Вы можете добавить свои свойства, их имена могут быть любыми.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Если все свойства указаны, перейдите на вкладку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold; background-color: #ffffff;\">Основные</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\"> и нажмите </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold; background-color: #ffffff;\">Сохранить</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">.</span></p>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Настройка страницы подключения модуля</span></h3>\n<p class=\"p_Normal\">По умолчанию все созданные настройки добавляются на страницу подключения модуля. Пользователь увидит их, нажав на название модуля в разделе <span style=\"font-weight: bold;\">Администрирование</span>.</p>\n<p class=\"p_Normal\">Рекомендуем отображать на странице подключения только те параметры, значения которых вводятся пользователем при настройке модуля. Чтобы узнать, какие параметры настраиваются вручную, а какие задаются по умолчанию, обратитесь к документации для разработчиков сервиса сторонней авторизации. </p>\n<p class=\"p_Normal\">Рассмотрим настройку страницы подключения на примере модуля для авторизации через Google. Список его параметров приведён в предыдущем разделе. По умолчанию все они отображаются на странице модуля. </p>\n<p style=\"background: #ffffff; margin: 0 0 7px 0;\">Чтобы страница подключения содержала только настройки, задаваемые пользователем вручную, выполните следующие действия:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"1\">На странице модуля перейдите на вкладку <span style=\"font-weight: bold;\">Настройка</span> и нажмите кнопку <span style=\"font-weight: bold;\">Изменить форму</span>. Откроется дизайнер интерфейсов, в котором необходимо <a class=\"topiclink\" href=\"extention-settings.html\">отредактировать форму</a> настроек модуля. </li></ol>\n<p style=\"background: #ffffff; margin: 0 0 7px 36px;\"><img alt=\"oauth2-authorization-1\" height=\"330\" src=\"oauth2-authorization-1.png\" style=\"margin:0;width:807px;height:330px;border:none\" width=\"807\"/></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"2\">Удалите стандартную форму элемента: выберите виджет, нажмите на значок корзины и подтвердите удаление.</li><li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"3\">Так как свойства <span style=\"font-weight: bold;\">ID приложения</span> (<code><b>client_id</b></code>) и <span style=\"font-weight: bold;\">Защищённый ключ</span> (<code><b>client_secret</b></code>) заполняются вручную, вынесите их на форму. Для этого справа откройте вкладку <span style=\"font-weight: bold;\">Свойства</span> и перетащите их на поле для моделирования.</li><li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"4\">Сделайте добавленные поля обязательными для заполнения. Для этого выберите нужное свойство на поле для моделирования и нажмите значок шестерёнки. В окне настроек укажите обязательность и нажмите <span style=\"font-weight: bold;\">Сохранить</span>.</li></ol>\n<p style=\"background: #ffffff; margin: 0 0 7px 36px;\"><img alt=\"oauth2-authorization-2\" height=\"464\" src=\"oauth2-authorization-2.png\" style=\"margin:0;width:903px;height:464px;border:none\" width=\"903\"/></p>\n<ol start=\"5\" style=\"list-style-type:upper-roman\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"5\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">На верхней панели дизайнера интерфейсов нажмите </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold; background-color: #ffffff;\">Опубликовать</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">.</span></li></ol>\n<p style=\"background: #ffffff; margin: 0 0 7px 34px;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Теперь на странице подключения модуля отобразятся только параметры, которые указываются вручную.</span></p>\n<p style=\"background: #ffffff; margin: 0 0 7px 36px;\"><img alt=\"oauth2-authorization-3\" height=\"247\" src=\"oauth2-authorization-3.png\" style=\"margin:0;width:600px;height:247px;border:none\" width=\"600\"/></p>\n<ol start=\"6\" style=\"list-style-type:upper-roman\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"6\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Для остальных параметров задайте значения по умолчанию. Для этого в настройках модуля перейдите на вкладку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Настройки</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">, нажмите на название свойства и в открывшемся окне укажите значение в поле </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">По умолчанию</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">.</span></li></ol>\n<p style=\"background: #ffffff; margin: 0 0 7px 34px;\"><img alt=\"oauth2-authorization-4\" height=\"516\" src=\"oauth2-authorization-4.png\" style=\"margin:0;width:568px;height:516px;border:none\" width=\"568\"/></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 34px;\"><span style=\"font-size: 15px; font-family: Inter;\">Например, в модуле авторизации Google задайте следующие значения: </span></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>auth_url</b></code><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\"> </span><span style=\"font-size: 15px; font-family: Inter;\">— </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">https://accounts.google.com/o/oauth2/v2/auth</span><span style=\"font-size: 15px; font-family: Inter;\">;</span></li></ul>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>token_url</b></code><span style=\"font-size: 15px; font-family: 'Courier New',Courier,monospace; font-weight: bold;\"> </span><span style=\"font-size: 15px; font-family: Inter;\">— </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">https://www.googleapis.com/oauth2/v4/token</span><span style=\"font-size: 15px; font-family: Inter;\">;</span></li></ul>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>scopes</b></code><span style=\"font-size: 13px;\"> </span>для авторизации через Google<span style=\"font-size: 15px; font-family: Inter;\"> — </span><span style=\"font-size: 15px; font-weight: bold;\">https://www.googleapis.com/auth/userinfo.email</span><span style=\"font-size: 15px;\">;</span></li></ul>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><code><b>scopes</b></code><span style=\"font-size: 13px;\"> </span>для авторизации в <a class=\"topiclink\" href=\"external-oauth2-integration.html#inbox-auth-module\">почтовом сервисе</a> Gmail <span style=\"font-size: 15px; font-family: Inter;\">— </span><span style=\"font-size: 15px; font-family: Helvetica,'Helvetica Light',Roboto,Arial,sans-serif; font-weight: bold;\">https://mail.google.com/ https://www.googleapis.com/auth/gmail.send</span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li></ul>\n<ol start=\"7\" style=\"list-style-type:upper-roman\">\n<li style=\"background: #ffffff; margin-top: 0; margin-right: 0; margin-bottom: 7px;\" value=\"7\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">В настройках модуля перейдите на вкладку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Основные</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> и нажмите </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Сохранить</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">. </span></li></ol>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Добавление скрипта </span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">На следующем шаге в модуль нужно добавить скрипт. В нём считываются значения настроек модуля, затем из них формируется запрос на авторизацию. Он отправляется на сторонний сервис, который возвращает идентификатор пользователя. Идентификатор сравнивается со значением в базе данных ELMA365, и при совпадении пользователь авторизуется в системе. </span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Внутри скрипта отправка запроса и получение ответа от стороннего сервиса реализованы в методе </span><code><b>oauth2_profile</b></code><span style=\"font-size: 13px;\">. </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\">Обратите внимание, что имя метода менять нельзя, поскольку в системе он используется для распознавания типа модуля.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Чтобы добавить скрипт:</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">На странице модуля перейдите на вкладку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0563c1;\"><a class=\"topiclink\" href=\"extention-api.html\">Методы API</a></span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> и нажмите </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Редактировать</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">. Откроется редактор методов. </span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Перейдите на вкладку </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Скрипты</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> и напишите код по следующему шаблону:</span></li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">interface AccessTokenData { // Структура данных для хранения access-токена стороннего сервиса</span><br/>\n<span class=\"f_CodeExample\">    access_token: string;</span><br/>\n<span class=\"f_CodeExample\">    refresh_token: string;</span><br/>\n<span class=\"f_CodeExample\">    token_type: string;</span><br/>\n<span class=\"f_CodeExample\">    expires_in: number;</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">interface OAuth2Profile {  // Структура данных для хранения идентификатора пользователя</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">    user_id: string;</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">interface OAuth2ResponseFail { // Структура данных для хранения сообщения об ошибке</span><br/>\n<span class=\"f_CodeExample\">    error: string;</span><br/>\n<span class=\"f_CodeExample\">    error_description: string; </span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">async function oauth2_profile (tokenData: AccessTokenData): Promise&lt;OAuth2Profile | OAuth2ResponseFail&gt; {</span><br/>\n<span class=\"f_CodeExample\">    // Код метода, который возвращает идентификатор пользователя, или текст ошибки из OAuth2-провайдера</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> <a class=\"dropdown-toggle\" href=\"javascript:HMToggle('toggle','TOGGLE0186A1')\" style=\"font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;\">Пример скрипта для модуля авторизации через Google</a></span></p>\n<div class=\"dropdown-toggle-body\" id=\"TOGGLE0186A1\" style=\"text-align: left; text-indent: 0; line-height: 1.28; padding: 0 0 0 0; margin: 0 0 11px 0;\"><table style=\"border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; padding:0; border:none\"><p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">interface AccessTokenData {</span><br/>\n<span class=\"f_CodeExample\">    access_token: string;</span><br/>\n<span class=\"f_CodeExample\">    refresh_token: string;</span><br/>\n<span class=\"f_CodeExample\">    token_type: string;</span><br/>\n<span class=\"f_CodeExample\">    expires_in: number;</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">interface OAuth2Profile {</span><br/>\n<span class=\"f_CodeExample\">    user_id: string;</span><br/>\n<span class=\"f_CodeExample\">    email: string;</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">interface OAuth2ResponseFail {</span><br/>\n<span class=\"f_CodeExample\">    error: string;</span><br/>\n<span class=\"f_CodeExample\">    error_description: string;</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">// logout interface</span><br/>\n<span class=\"f_CodeExample\">interface OAuth2LogoutResponse {</span><br/>\n<span class=\"f_CodeExample\">    redirect_url: string;</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">async function oauth2_profile (tokenData: AccessTokenData): Promise&lt;OAuth2Profile | OAuth2ResponseFail&gt; {</span><br/>\n<span class=\"f_CodeExample\">    const resp = await fetch(`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&amp;access_token=${tokenData.access_token.toString()}`)</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\">    if (resp.ok) {</span><br/>\n<span class=\"f_CodeExample\">        const result = await resp.json()</span><br/>\n<span class=\"f_CodeExample\">        return &lt;OAuth2Profile&gt;{</span><br/>\n<span class=\"f_CodeExample\">            user_id: result.id.toString(),</span><br/>\n<span class=\"f_CodeExample\">            email: result.email.toString()</span><br/>\n<span class=\"f_CodeExample\">        }</span><br/>\n<span class=\"f_CodeExample\">    }</span><br/>\n<span class=\"f_CodeExample\">    else {</span><br/>\n<span class=\"f_CodeExample\">        return &lt;OAuth2ResponseFail&gt;{</span><br/>\n<span class=\"f_CodeExample\">            error: \"user_not_found\",</span><br/>\n<span class=\"f_CodeExample\">            error_description: await resp.text()</span><br/>\n<span class=\"f_CodeExample\">        }</span><br/>\n<span class=\"f_CodeExample\">    }</span><br/>\n<span class=\"f_CodeExample\">}</span><br/>\n<span class=\"f_CodeExample\">// logout</span><br/>\n<span class=\"f_CodeExample\">async function oauth2_logout(): Promise&lt;OAuth2LogoutResponse | OAuth2ResponseFail&gt; {</span><br/>\n<span class=\"f_CodeExample\">    return &lt;OAuth2LogoutResponse&gt; {</span><br/>\n<span class=\"f_CodeExample\">            redirect_url: \"https://www.google.com/accounts/Logout\"            </span><br/>\n<span class=\"f_CodeExample\">        };</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n</td>\n</tr>\n</table>\n</div>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Сохраните и опубликуйте скрипт. </span></li></ol>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"external-service-registration\"></a><span class=\"f_Heading3\">Настройка на стороне внешнего сервиса</span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Для работы модуля авторизации необходимо настроить веб-приложение на стороне провайдера и связать его с модулем. Рассмотрим создание приложения на примере интеграции с Google:</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: Inter;\">Перейдите в </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"weblink\" href=\"https://console.cloud.google.com/apis/dashboard\" target=\"_blank\">Google Cloud Platform</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: Inter;\">Создайте проект или выберите существующий. Подробнее о создании проектов читайте в </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"weblink\" href=\"https://developers.google.com/workspace/guides/create-project?hl=ru\" target=\"_blank\">официальной документации Google</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><span style=\"font-size: 15px; font-family: Inter;\">Настройте страницу запроса разрешений. Подробнее читайте в </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"weblink\" href=\"https://developers.google.com/workspace/guides/configure-oauth-consent?hl=ru\" target=\"_blank\">официальной документации Google</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\"><span style=\"font-size: 15px; font-family: Inter;\">Перейдите в раздел </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Credentials</span><span style=\"font-size: 15px; font-family: Inter;\">, в верхней части страницы нажмите </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">+Create credentials</span><span style=\"font-size: 15px; font-family: Inter;\"> и в выпадающем меню выберите </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">OAuth client ID</span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"5\"><span style=\"font-size: 15px; font-family: Inter;\">В поле </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Application type</span><span style=\"font-size: 15px; font-family: Inter;\"> выберите </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Web application</span><span style=\"font-size: 15px; font-family: Inter;\"> и укажите название приложения.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"6\"><span style=\"font-size: 15px; font-family: Inter;\">В блоке </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Authorized redirect URIs</span><span style=\"font-size: 15px; font-family: Inter;\"> нажмите </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">+Add URI</span><span style=\"font-size: 15px; font-family: Inter;\"> и введите адрес, на который пользователь перенаправится при успешной авторизации. Формат адреса: </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">&lt;host&gt;/_oauth2/post-message</span><span style=\"font-weight: bold;\">?provider=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</span>. В качестве <span style=\"font-weight: bold;\">&lt;host&gt;</span> вставьте адрес вашей компании ELMA365. В качестве ID провайдера используйте идентификатор модуля. Чтобы получить его, откройте страницу модуля и в адресной строке браузера скопируйте набор символов после “ext_”.</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало примечание</span></p>\n<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Примечание</span></p>\n<p class=\"p_Normal\">Чтобы пользователь мог войти в ELMA365, используя как базовый адрес компании, так и дополнительный (алиас), в настройках на стороне внешнего сервиса укажите два соответствующих URL‑адреса для перенаправления.</p>\n<p style=\"background: #f7f7f7; margin: 7px 0 7px 0;\">Если вы настраиваете интеграцию с <a class=\"topiclink\" href=\"external-oauth2-integration.html#inbox-auth-module\">почтовым сервисом</a>, введите адрес для перенаправления в формате <span style=\"font-weight: bold;\">&lt;host&gt;/_oauth2/post-message</span>.</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец примечание</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"7\"><span style=\"font-size: 15px; font-family: Inter;\">Нажмите </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Create</span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"8\"><span style=\"font-size: 15px; font-family: Inter;\">В открывшемся окне скопируйте значения </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Client ID</span><span style=\"font-size: 15px; font-family: Inter;\"> и </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Client secret</span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"9\"><span style=\"font-size: 15px; font-family: Inter;\">Перейдите в ELMA365, откройте страницу модуля и включите его.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"10\"><span style=\"font-size: 15px; font-family: Inter;\">Вставьте в поле </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">ID приложения</span><span style=\"font-size: 15px; font-family: Inter;\"> значение </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Client ID</span><span style=\"font-size: 15px; font-family: Inter;\">, в поле </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Защищённый ключ</span><span style=\"font-size: 15px; font-family: Inter;\"> — </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Client secret</span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li></ol>\n<p class=\"p_Normal\" style=\"margin: 0 0 0 34px;\"><img alt=\"oauth2-authorization-8\" height=\"300\" src=\"oauth2-authorization-8.png\" style=\"margin:0;width:729px;height:300px;border:none\" width=\"729\"/></p>\n<ol start=\"11\" style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"11\"><span style=\"font-size: 15px; font-family: Inter;\">Сохраните настройки.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Модуль готов к использованию. Теперь пользователи смогут войти в ELMA365 с помощью учётной записи подключённого сервиса, если OAuth2‑авторизация разрешена в </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"topiclink\" href=\"security_settings.html\">настройках безопасности</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Вы также можете настроить вход через сторонний сервис для </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"topiclink\" href=\"portal-login-page.html\">внешнего портала</a></span><span style=\"font-size: 15px; font-family: Inter;\">. Работа модуля при авторизации клиентов на портале описана в разделе </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"topiclink\" href=\"external-oauth2-integration.html#example\">«Пример работы модуля для входа на портал»</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Настройка logout в модуле OAuth2 </span></h2>\n<p class=\"p_Normal\">Для обеспечения дополнительной безопасности вы можете настроить механизм <span style=\"font-weight: bold;\">logout</span> в пользовательском модуле OAuth2. С помощью этого механизма пользователь, выходя из профиля в ELMA365, также будет выходить из привязанной учётной записи настроенного провайдера.</p>\n<p class=\"p_Normal\">Чтобы настроить механизм <span style=\"font-weight: bold;\">logout</span> в модуле, выполните следующие действия: </p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">На странице модуля перейдите на вкладку <a class=\"topiclink\" href=\"extention-api.html\">Методы API</a> и нажмите <span style=\"font-weight: bold;\">Редактировать</span>. Откроется редактор методов.</li><li class=\"p_Normal\" value=\"2\">Перейдите на вкладку <span style=\"font-weight: bold;\">Скрипты</span> и подключите интерфейс <span style=\"font-weight: bold;\">logout</span>: </li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\" style=\"font-weight: bold;\">interface</span><span class=\"f_CodeExample\"> OAuth2LogoutResponse {</span><br/>\n<span class=\"f_CodeExample\">    redirect_url: string;</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Затем реализуйте метод <code><b>oauth2_logout</b></code>: </li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">async </span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">function</span><span class=\"f_CodeExample\"> oauth2_logout(): Promise&lt;OAuth2LogoutResponse | OAuth2ResponseFail&gt; {</span><br/>\n<span class=\"f_CodeExample\">    </span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">return</span><span class=\"f_CodeExample\"> &lt;OAuth2LogoutResponse&gt; {</span><br/>\n<span class=\"f_CodeExample\">        redirect_url: \"https://my_idp.com/logout\"            </span><br/>\n<span class=\"f_CodeExample\">    };</span><br/>\n<span class=\"f_CodeExample\">}</span></p>\n<p class=\"p_Normal\">В качестве параметра <code><b>redirect_url</b></code> укажите адрес настроенного провайдера. На указанный адрес из ELMA365 будет отправляться запрос о выходе из учётной записи. </p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Сохраните и опубликуйте скрипт.</li></ol>\n<p class=\"p_Normal\">После этого пользователь, нажавший кнопку <span style=\"font-weight: bold;\">Выйти</span> в ELMA365, будет перенаправлен на страницу выхода из учётной записи в настроенном провайдере OAuth2. </p>\n<p class=\"p_Normal\">Также вы можете настроить на стороне провайдера OAuth2 обратную переадресацию на страницу авторизации в ELMA365 после выхода из системы. </p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"link\"></a><span class=\"f_Heading2\">Привязка учётной записи OAuth2 к профилю в скриптах </span></h2>\n<p class=\"p_Normal\">С помощью скриптов вы можете управлять привязкой профиля пользователя ELMA365 к учётной записи настроенного провайдера OAuth2. Для этого доступны следующие методы: </p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><code><b>createWithAuthData</b></code> — метод позволяет создать нового пользователя в ELMA365 и автоматически связать его с существующей учётной записью в провайдере OAuth2. Добавленные с помощью данного метода пользователи сразу получают <a class=\"topiclink\" href=\"360004833572.html\">статус</a> <span style=\"font-weight: bold;\">Активный</span>. </li></ul>\n<p class=\"p_Normal\" style=\"margin: 0 0 0 35px;\">Обратите внимание, пользователь, добавленный таким способом, сможет авторизоваться в ELMA365 только с помощью провайдера OAuth2. Другие методы авторизации будут недоступны; </p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><code><b>addOAuth2Data</b></code> — метод позволяет привязать к профилю существующего в ELMA365 пользователя учётную запись настроенного провайдера OAuth2. После привязки пользователь сможет авторизоваться в ELMA365, используя данные провайдера. Данный метод аналогичен ручному добавлению учётной записи провайдера OAuth2 в настройках профиля пользователя на вкладке <a class=\"topiclink\" href=\"360016398552.html#authentication\">Аутентификация</a>; </li><li class=\"p_Normal\"><code><b>removeOAuth2Data</b></code> — метод позволяет отвязать учётную запись провайдера OAuth2 от профиля пользователя ELMA365. Данный метод аналогичен ручному удалению учётной записи из профиля пользователя. </li></ul>\n<p class=\"p_Normal\">Подробнее о работе с перечисленными методами читайте в справке ELMA365 TS SDK в статье <a class=\"weblink\" href=\"https://tssdk.elma365.com/ru/latest/interfaces/_03_globals_.users.html#createwithauthdata\" target=\"_blank\">«Объект пользователей»</a>.</p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"inbox-auth-module\"></a><span class=\"f_Heading2\">Настройка модуля для авторизации в почтовых сервисах</span></h2>\n<p style=\"margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Модуль OAuth2 можно использовать при настройке интеграции с почтовым ящиком в </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0563c1;\"><a class=\"topiclink\" href=\"inbox.html\">линиях</a></span><span style=\"font-size: 15px; font-family: Inter;\"> и при подключении </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0563c1;\"><a class=\"topiclink\" href=\"email-workspace.html\">персональной почты</a></span><span style=\"font-size: 15px; font-family: Inter;\"> к профилю пользователя. В этом случае не требуется ввод пароля от почты в ELMA365 — авторизация происходит на стороне почтового сервиса, что обеспечивает удобство для пользователя и дополнительную безопасность учётных данных.</span></p>\n<p style=\"margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Чтобы модуль подходил для привязки почтового ящика, добавьте в него обязательные свойства. Для этого перейдите к управлению модулем, затем на вкладке </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Настройки</span><span style=\"font-size: 15px; font-family: Inter;\">:</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: Inter;\">Создайте свойства типа </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; background-color: #ffffff;\"><a class=\"topiclink\" href=\"360009707032.html#string\">Строка</a></span><span style=\"font-size: 15px; font-family: Inter;\">, обязательные для любого модуля OAuth2. При этом укажите имена свойств, приведённые ниже в скобках, поскольку они используются для распознавания типа модуля:</span><ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">ID приложения</span><span style=\"font-size: 15px; font-family: Inter;\"> (</span><code><b>client_id</b></code><span style=\"font-size: 15px; font-family: Inter;\">);</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Защищённый ключ</span><span style=\"font-size: 15px; font-family: Inter;\"> (</span><code><b>client_secret</b></code><span style=\"font-size: 15px; font-family: Inter; background-color: #ffffff;\">);</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Адрес аутентификации</span><span style=\"font-size: 15px; font-family: Inter;\"> (</span><code><b>auth_url</b></code><span style=\"font-size: 15px; font-family: Inter;\">);</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Адрес получения токена</span><span style=\"font-size: 15px; font-family: Inter; background-color: #ffffff;\"> (</span><code><b>token_url</b></code><span style=\"font-size: 15px; font-family: Inter; background-color: #ffffff;\">);</span></li><li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Права доступа </span><span style=\"font-size: 15px; font-family: Inter; background-color: #ffffff;\">(</span><code><b>scopes</b></code><span style=\"font-size: 15px; font-family: Inter; background-color: #ffffff;\">)</span><span style=\"font-size: 15px; font-family: Inter;\">.</span></li></ul></li></ol>\n<p style=\"margin: 0 0 11px 34px;\"><span style=\"font-size: 15px; font-family: Inter;\">Подробное описание свойств приведено </span><span style=\"font-size: 15px; font-family: Inter; color: #0000ff;\"><a class=\"topiclink\" href=\"external-oauth2-integration.html#add-mandatory-parameters\">выше</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: Inter;\">Добавьте свойство типа </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Строка</span><span style=\"font-size: 15px; font-family: Inter;\">, уникальное для модулей авторизации в почте — </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Тип авторизации</span><br/>\n<span style=\"font-size: 15px; font-family: Inter;\">(</span><code><b>auth_type</b></code><span style=\"font-size: 15px; font-family: Inter;\">). В нём указывается используемый метод авторизации — OAUTHBEARER или XOAuth2, возможные значения —</span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\"> bearer</span><span style=\"font-size: 15px; font-family: Inter;\"> и </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">xoauth2</span><span style=\"font-size: 15px; font-family: Inter;\">. Если поле оставлено пустым или введено некорректное значение, по умолчанию используется метод OAUTHBEARER. Рекомендуем использовать XOAuth2 для провайдеров Яндекс Почта и Mail.ru</span><span style=\"font-size: 11px; font-family: Inter;\">.</span></li></ol>\n<p class=\"p_Normal\" style=\"margin: 0 0 0 34px;\">Вы можете установить в настройках свойства значение по умолчанию, чтобы не указывать тип авторизации вручную на странице подключения модуля.</p>\n<p style=\"margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Добавление скриптов для работы модуля не требуется.</span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">После включения модуля его можно использовать при подключении почтового ящика в профиле пользователя и в настройках линий. Подробнее читайте в статьях </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0563c1;\"><a class=\"weblink\" href=\"https://elma365.com/ru/help/crm/connect-email.html\" target=\"_blank\">«</a><a class=\"topiclink\" href=\"connect-email.html#oauth2\">Подключить почту»</a></span><span style=\"font-size: 15px; font-family: Inter;\"> и </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; color: #0563c1;\"><a class=\"topiclink\" href=\"inbox.html#oauth2\">«Подключить электронную почту к линии»</a></span><span style=\"font-size: 15px; font-family: Inter;\">.</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"example\"></a><span class=\"f_Heading2\">Пример работы модуля для входа на портал</span></h2>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Рассмотрим подробнее использование модуля для сервиса Google на примере регистрации и авторизации на внешнем портале компании. О том, как создать такой модуль, читайте в разделе <a class=\"topiclink\" href=\"external-oauth2-integration.html#create-module\">«Создание и настройка модуля»</a>.</span></p>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Предварительная настройка</span></h3>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"font-size: 15px; font-family: Inter;\">Чтобы пользователь мог входить на внешний портал с помощью учётной записи стороннего сервиса, нужно указать модуль OAuth2 в </span><span style=\"font-size: 15px; font-family: Inter; color: #0563c1;\"><a class=\"topiclink\" href=\"portal-login-page.html#authorization\">настройках авторизации портала</a></span><span style=\"font-size: 15px; font-family: Inter;\">:</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: Inter;\">Перейдите в раздел, в котором настроен портал.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: Inter;\">Нажмите на портал в левом меню и на открывшейся странице выберите значок шестерёнки рядом с его названием.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><span style=\"font-size: 15px; font-family: Inter;\">В окне настройки на вкладке </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Авторизация</span><span style=\"font-size: 15px; font-family: Inter;\"> разрешите OAuth2-авторизацию и добавьте созданный модуль в список провайдеров.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 34px;\"><img alt=\"oauth2-authorization-5\" height=\"530\" src=\"oauth2-authorization-5.png\" style=\"margin:0;width:532px;height:530px;border:none\" width=\"532\"/></p>\n<p style=\"margin: 0 0 11px 34px;\"><span style=\"font-size: 15px; font-family: Inter;\">В целях безопасности можно запретить вход на портал по логину и паролю. Для этого в поле </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Разрешить вход по логину / паролю </span><span style=\"font-size: 15px; font-family: Inter;\">установите переключатель в положение </span><span style=\"font-size: 15px; font-family: Inter; font-weight: bold;\">Нет</span><span style=\"font-size: 15px; font-family: Inter;\">. В этом случае пользователи смогут авторизоваться на портале только через сторонний сервис.</span></p>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\"><span style=\"font-size: 15px; font-family: Inter;\">Сохраните настройки портала.</span></li></ol>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Принцип работы модуля</span></h3>\n<p class=\"p_Normal\">Разберём, как работает модуль: </p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Клиент, который ранее не использовал портал, переходит по ссылке-приглашению и в окне регистрации нажимает </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Использовать другой метод для регистрации</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 35px;\"><img alt=\"oauth2-authorization-9\" height=\"490\" src=\"oauth2-authorization-9.png\" style=\"margin:0;width:1004px;height:490px;border:none\" width=\"1004\"/></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">В окне доступных сторонних сервисов выбирает опцию </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Google OAuth2</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\"><img alt=\"oauth2-authorization-10\" height=\"511\" src=\"oauth2-authorization-10.png\" style=\"margin:0;width:920px;height:511px;border:none\" width=\"920\"/></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">В открывшемся окне авторизации Google указывает нужный аккаунт и входит в него.</span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Затем пользователь разрешает доступ к данным учётной записи.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 37px;\"><img alt=\"oauth2-authorization-11\" height=\"488\" src=\"oauth2-authorization-11.png\" style=\"margin:0;width:881px;height:488px;border:none\" width=\"881\"/></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"5\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Появляется окно приглашения на портал, в котором пользователь вводит фамилию, имя и отчество и нажимает </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Сохранить</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">. </span></li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"6\"><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\">Регистрация завершена. В следующий раз при авторизации на портале пользователь нажимает </span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-weight: bold;\">Войти другим способом</span><span style=\"font-size: 15px; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;\"> и входит в свой аккаунт Google.</span></li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 35px;\"><img alt=\"oauth2-authorization-12\" height=\"393\" src=\"oauth2-authorization-12.png\" style=\"margin:0;width:658px;height:393px;border:none\" width=\"658\"/></p>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"external_viewer_intergation.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">external_viewer_intergation.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"two-factor-integration.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">two-factor-integration.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n<script type=\"text/javascript\">\nHMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');\n</script>\n</body>\n</html>\n",
  "plain_text": "Пользовательский модуль для авторизации через сторонние сервисы ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 Модули расширения системы > Примеры модулей интеграции с ELMA365 / Пользовательский модуль для авторизации через сторонние сервисы Пользовательский модуль OAuth2 для авторизации через сторонние сервисы По умолчанию авторизация пользователей в ELMA365 или на внешнем портале осуществляется по логину и паролю. Вы можете реализовать регистрацию и авторизацию пользователей через сторонние сервисы, например, соцсети, учётные записи Google или Яндекс. Для этого необходимо создать и настроить пользовательский модуль OAuth2. После подключения модуля новый способ авторизации станет доступен в ELMA365. Также вы сможете подключить модуль к каждому порталу компании. Кроме того, вы можете настроить модуль для авторизации при подключении почты . начало внимание Создавать и настраивать модули могут только пользователи, включённые в группу Администраторы . конец внимание Создание и настройка модуля Чтобы создать новый модуль, перейдите в Администрирование > Модули , нажмите кнопку + Модуль и в открывшемся окне выберите опцию Создать . Заполните информацию о модуле и нажмите кнопку Создать . Подробнее читайте в статье «Создание модуля». Добавление обязательных настроек Добавьте в модуль OAuth2 обязательные настройки. Это глобальные параметры, которые будут использоваться в скриптах модуля. Перейдите на вкладку Настройки , нажмите + Добавить и создайте необходимое количество свойств, в которых будут храниться значения настроек. Отображаемые названия свойств могут быть произвольными. Имена же свойств должны совпадать с именами, указанными ниже в скобках, поскольку они используются для распознавания типа модуля. Для корректной работы модуля авторизации в системе обязательно добавьте следующие свойства типа Строка : ID приложения ( client_id ) — и дентификатор приложения на стороне внешнего сервиса, которое будет запрашивать данные для авторизации. Выдаётся при регистрации приложения в стороннем сервисе; Защищённый ключ ( client_secret ) — секретный ключ приложения. Выдаётся при регистрации приложения в стороннем сервисе. Вместе с client_id используется для получения токена доступа к API стороннего сервиса; Адрес аутентификации ( auth_url ) — адрес страницы авторизации в стороннем сервисе, на которую пользователь будет перенаправлен из приложения; Адрес получения токена ( token_url ) — адрес на стороне сервиса, на который будет отправлен запрос для получения ключа доступа к API (access‑токена) . В запросе указываются client_id и client_secret ; Права доступа ( scopes ) — права доступа, которые будут предоставлены приложению в стороннем сервисе по access‑токену. Названия прав доступа разделяются пробелом. Обязательно необходимо запрашивать доступ к сведениям, которые позволяют однозначно идентифицировать пользователя, например, к адресу электронной почты; Автоматическая регистрация ( auto_signup ) — свойство типа Выбор «да/нет» . Если параметр установлен в значение Да , внутренние или внешние пользователи, которые ранее отсутствовали в системе, автоматически добавятся в ELMA365 при авторизации. В этом случае в карточке пользователя отобразится только его электронный адрес. Вы можете добавить свои свойства, их имена могут быть любыми. Если все свойства указаны, перейдите на вкладку Основные и нажмите Сохранить . Настройка страницы подключения модуля По умолчанию все созданные настройки добавляются на страницу подключения модуля. Пользователь увидит их, нажав на название модуля в разделе Администрирование . Рекомендуем отображать на странице подключения только те параметры, значения которых вводятся пользователем при настройке модуля. Чтобы узнать, какие параметры настраиваются вручную, а какие задаются по умолчанию, обратитесь к документации для разработчиков сервиса сторонней авторизации. Рассмотрим настройку страницы подключения на примере модуля для авторизации через Google. Список его параметров приведён в предыдущем разделе. По умолчанию все они отображаются на странице модуля. Чтобы страница подключения содержала только настройки, задаваемые пользователем вручную, выполните следующие действия: На странице модуля перейдите на вкладку Настройка и нажмите кнопку Изменить форму . Откроется дизайнер интерфейсов, в котором необходимо отредактировать форму настроек модуля. Удалите стандартную форму элемента: выберите виджет, нажмите на значок корзины и подтвердите удаление. Так как свойства ID приложения ( client_id ) и Защищённый ключ ( client_secret ) заполняются вручную, вынесите их на форму. Для этого справа откройте вкладку Свойства и перетащите их на поле для моделирования. Сделайте добавленные поля обязательными для заполнения. Для этого выберите нужное свойство на поле для моделирования и нажмите значок шестерёнки. В окне настроек укажите обязательность и нажмите Сохранить . На верхней панели дизайнера интерфейсов нажмите Опубликовать . Теперь на странице подключения модуля отобразятся только параметры, которые указываются вручную. Для остальных параметров задайте значения по умолчанию. Для этого в настройках модуля перейдите на вкладку Настройки , нажмите на название свойства и в открывшемся окне укажите значение в поле По умолчанию . Например, в модуле авторизации Google задайте следующие значения: auth_url — https://accounts.google.com/o/oauth2/v2/auth ; token_url — https://www.googleapis.com/oauth2/v4/token ; scopes для авторизации через Google — https://www.googleapis.com/auth/userinfo.email ; scopes для авторизации в почтовом сервисе Gmail — https://mail.google.com/ https://www.googleapis.com/auth/gmail.send . В настройках модуля перейдите на вкладку Основные и нажмите Сохранить . Добавление скрипта На следующем шаге в модуль нужно добавить скрипт. В нём считываются значения настроек модуля, затем из них формируется запрос на авторизацию. Он отправляется на сторонний сервис, который возвращает идентификатор пользователя. Идентификатор сравнивается со значением в базе данных ELMA365, и при совпадении пользователь авторизуется в системе. Внутри скрипта отправка запроса и получение ответа от стороннего сервиса реализованы в методе oauth2_profile . Обратите внимание, что имя метода менять нельзя, поскольку в системе он используется для распознавания типа модуля. Чтобы добавить скрипт: На странице модуля перейдите на вкладку Методы API и нажмите Редактировать . Откроется редактор методов. Перейдите на вкладку Скрипты и напишите код по следующему шаблону: interface AccessTokenData { // Структура данных для хранения access-токена стороннего сервиса access_token: string; refresh_token: string; token_type: string; expires_in: number; } interface OAuth2Profile { // Структура данных для хранения идентификатора пользователя user_id: string; } interface OAuth2ResponseFail { // Структура данных для хранения сообщения об ошибке error: string; error_description: string; } async function oauth2_profile (tokenData: AccessTokenData): Promise<OAuth2Profile | OAuth2ResponseFail> { // Код метода, который возвращает идентификатор пользователя, или текст ошибки из OAuth2-провайдера } Пример скрипта для модуля авторизации через Google interface AccessTokenData { access_token: string; refresh_token: string; token_type: string; expires_in: number; } interface OAuth2Profile { user_id: string; email: string; } interface OAuth2ResponseFail { error: string; error_description: string; } // logout interface interface OAuth2LogoutResponse { redirect_url: string; } async function oauth2_profile (tokenData: AccessTokenData): Promise<OAuth2Profile | OAuth2ResponseFail> { const resp = await fetch(`https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=${tokenData.access_token.toString()}`) if (resp.ok) { const result = await resp.json() return <OAuth2Profile>{ user_id: result.id.toString(), email: result.email.toString() } } else { return <OAuth2ResponseFail>{ error: \"user_not_found\", error_description: await resp.text() } } } // logout async function oauth2_logout(): Promise<OAuth2LogoutResponse | OAuth2ResponseFail> { return <OAuth2LogoutResponse> { redirect_url: \"https://www.google.com/accounts/Logout\" }; } Сохраните и опубликуйте скрипт. Настройка на стороне внешнего сервиса Для работы модуля авторизации необходимо настроить веб-приложение на стороне провайдера и связать его с модулем. Рассмотрим создание приложения на примере интеграции с Google: Перейдите в Google Cloud Platform . Создайте проект или выберите существующий. Подробнее о создании проектов читайте в официальной документации Google . Настройте страницу запроса разрешений. Подробнее читайте в официальной документации Google . Перейдите в раздел Credentials , в верхней части страницы нажмите +Create credentials и в выпадающем меню выберите OAuth client ID . В поле Application type выберите Web application и укажите название приложения. В блоке Authorized redirect URIs нажмите +Add URI и введите адрес, на который пользователь перенаправится при успешной авторизации. Формат адреса: <host>/_oauth2/post-message ?provider=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX . В качестве <host> вставьте адрес вашей компании ELMA365. В качестве ID провайдера используйте идентификатор модуля. Чтобы получить его, откройте страницу модуля и в адресной строке браузера скопируйте набор символов после “ext_”. начало примечание Примечание Чтобы пользователь мог войти в ELMA365, используя как базовый адрес компании, так и дополнительный (алиас), в настройках на стороне внешнего сервиса укажите два соответствующих URL‑адреса для перенаправления. Если вы настраиваете интеграцию с почтовым сервисом , введите адрес для перенаправления в формате <host>/_oauth2/post-message . конец примечание Нажмите Create . В открывшемся окне скопируйте значения Client ID и Client secret . Перейдите в ELMA365, откройте страницу модуля и включите его. Вставьте в поле ID приложения значение Client ID , в поле Защищённый ключ — Client secret . Сохраните настройки. Модуль готов к использованию. Теперь пользователи смогут войти в ELMA365 с помощью учётной записи подключённого сервиса, если OAuth2‑авторизация разрешена в настройках безопасности . Вы также можете настроить вход через сторонний сервис для внешнего портала . Работа модуля при авторизации клиентов на портале описана в разделе «Пример работы модуля для входа на портал» . Настройка logout в модуле OAuth2 Для обеспечения дополнительной безопасности вы можете настроить механизм logout в пользовательском модуле OAuth2. С помощью этого механизма пользователь, выходя из профиля в ELMA365, также будет выходить из привязанной учётной записи настроенного провайдера. Чтобы настроить механизм logout в модуле, выполните следующие действия: На странице модуля перейдите на вкладку Методы API и нажмите Редактировать . Откроется редактор методов. Перейдите на вкладку Скрипты и подключите интерфейс logout : interface OAuth2LogoutResponse { redirect_url: string; } Затем реализуйте метод oauth2_logout : async function oauth2_logout(): Promise<OAuth2LogoutResponse | OAuth2ResponseFail> { return <OAuth2LogoutResponse> { redirect_url: \"https://my_idp.com/logout\" }; } В качестве параметра redirect_url укажите адрес настроенного провайдера. На указанный адрес из ELMA365 будет отправляться запрос о выходе из учётной записи. Сохраните и опубликуйте скрипт. После этого пользователь, нажавший кнопку Выйти в ELMA365, будет перенаправлен на страницу выхода из учётной записи в настроенном провайдере OAuth2. Также вы можете настроить на стороне провайдера OAuth2 обратную переадресацию на страницу авторизации в ELMA365 после выхода из системы. Привязка учётной записи OAuth2 к профилю в скриптах С помощью скриптов вы можете управлять привязкой профиля пользователя ELMA365 к учётной записи настроенного провайдера OAuth2. Для этого доступны следующие методы: createWithAuthData — метод позволяет создать нового пользователя в ELMA365 и автоматически связать его с существующей учётной записью в провайдере OAuth2. Добавленные с помощью данного метода пользователи сразу получают статус Активный . Обратите внимание, пользователь, добавленный таким способом, сможет авторизоваться в ELMA365 только с помощью провайдера OAuth2. Другие методы авторизации будут недоступны; addOAuth2Data — метод позволяет привязать к профилю существующего в ELMA365 пользователя учётную запись настроенного провайдера OAuth2. После привязки пользователь сможет авторизоваться в ELMA365, используя данные провайдера. Данный метод аналогичен ручному добавлению учётной записи провайдера OAuth2 в настройках профиля пользователя на вкладке Аутентификация ; removeOAuth2Data — метод позволяет отвязать учётную запись провайдера OAuth2 от профиля пользователя ELMA365. Данный метод аналогичен ручному удалению учётной записи из профиля пользователя. Подробнее о работе с перечисленными методами читайте в справке ELMA365 TS SDK в статье «Объект пользователей» . Настройка модуля для авторизации в почтовых сервисах Модуль OAuth2 можно использовать при настройке интеграции с почтовым ящиком в линиях и при подключении персональной почты к профилю пользователя. В этом случае не требуется ввод пароля от почты в ELMA365 — авторизация происходит на стороне почтового сервиса, что обеспечивает удобство для пользователя и дополнительную безопасность учётных данных. Чтобы модуль подходил для привязки почтового ящика, добавьте в него обязательные свойства. Для этого перейдите к управлению модулем, затем на вкладке Настройки : Создайте свойства типа Строка , обязательные для любого модуля OAuth2. При этом укажите имена свойств, приведённые ниже в скобках, поскольку они используются для распознавания типа модуля: ID приложения ( client_id ); Защищённый ключ ( client_secret ); Адрес аутентификации ( auth_url ); Адрес получения токена ( token_url ); Права доступа ( scopes ) . Подробное описание свойств приведено выше . Добавьте свойство типа Строка , уникальное для модулей авторизации в почте — Тип авторизации ( auth_type ). В нём указывается используемый метод авторизации — OAUTHBEARER или XOAuth2, возможные значения — bearer и xoauth2 . Если поле оставлено пустым или введено некорректное значение, по умолчанию используется метод OAUTHBEARER. Рекомендуем использовать XOAuth2 для провайдеров Яндекс Почта и Mail.ru . Вы можете установить в настройках свойства значение по умолчанию, чтобы не указывать тип авторизации вручную на странице подключения модуля. Добавление скриптов для работы модуля не требуется. После включения модуля его можно использовать при подключении почтового ящика в профиле пользователя и в настройках линий. Подробнее читайте в статьях « Подключить почту» и «Подключить электронную почту к линии» . Пример работы модуля для входа на портал Рассмотрим подробнее использование модуля для сервиса Google на примере регистрации и авторизации на внешнем портале компании. О том, как создать такой модуль, читайте в разделе «Создание и настройка модуля» . Предварительная настройка Чтобы пользователь мог входить на внешний портал с помощью учётной записи стороннего сервиса, нужно указать модуль OAuth2 в настройках авторизации портала : Перейдите в раздел, в котором настроен портал. Нажмите на портал в левом меню и на открывшейся странице выберите значок шестерёнки рядом с его названием. В окне настройки на вкладке Авторизация разрешите OAuth2-авторизацию и добавьте созданный модуль в список провайдеров. В целях безопасности можно запретить вход на портал по логину и паролю. Для этого в поле Разрешить вход по логину / паролю установите переключатель в положение Нет . В этом случае пользователи смогут авторизоваться на портале только через сторонний сервис. Сохраните настройки портала. Принцип работы модуля Разберём, как работает модуль: Клиент, который ранее не использовал портал, переходит по ссылке-приглашению и в окне регистрации нажимает Использовать другой метод для регистрации . В окне доступных сторонних сервисов выбирает опцию Google OAuth2 . В открывшемся окне авторизации Google указывает нужный аккаунт и входит в него. Затем пользователь разрешает доступ к данным учётной записи. Появляется окно приглашения на портал, в котором пользователь вводит фамилию, имя и отчество и нажимает Сохранить . Регистрация завершена. В следующий раз при авторизации на портале пользователь нажимает Войти другим способом и входит в свой аккаунт Google. external_viewer_intergation.html two-factor-integration.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360024498352.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/service-portal.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/extentions.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/external-oauth2-integration.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360006871932.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/create-extention.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360009707032.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/extention-settings.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/extention-api.html",
    "https://console.cloud.google.com/apis/dashboard",
    "https://developers.google.com/workspace/guides/create-project",
    "https://developers.google.com/workspace/guides/configure-oauth-consent",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/security_settings.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/portal-login-page.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360004833572.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360016398552.html",
    "https://tssdk.elma365.com/ru/latest/interfaces/_03_globals_.users.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/inbox.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/email-workspace.html",
    "https://elma365.com/ru/help/crm/connect-email.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/connect-email.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/external_viewer_intergation.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/two-factor-integration.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T21:58:18.787097",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T21:58:18.905187"
  }
}