{
  "doc_id": "module-external-app",
  "url": "https://elma365.com/ru/help/crm/ru/help/business_solutions/module-external-app.html",
  "title": "Внешнее приложение в модулях",
  "breadcrumbs": [
    "Модули расширения системы",
    "Пользовательские модули"
  ],
  "section": "Модули расширения системы > Пользовательские модули | [crm]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>Внешнее приложение в модулях</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"проверить список подключений и разорвать соединение\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"В рамках модуля можно подключить внешнее приложение. Оно позволяет разрешить доступ сторонним сервисам к защищённым ресурсам ELMA365 по протоколу авторизации OAuth2.\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/module-external-app.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p><a href=\"360024498352.html\">Модули расширения системы</a> &gt; <a href=\"extentions.html\">Пользовательские модули</a> / Внешнее приложение в модулях</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Внешнее приложение в модулях</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p style=\"margin: 7px 0 7px 0;\">В рамках модуля можно подключить внешнее приложение. Оно позволяет разрешить доступ сторонним сервисам к защищённым ресурсам ELMA365 по протоколу авторизации OAuth2.</p>\n<p style=\"margin: 7px 0 7px 0;\">Предоставить доступ к данным из ELMA365 можно компьютерным программам, мобильным приложениям, веб‑сервисам и т. д. Для этого на стороне ELMA365 в модуле создаётся внешнее приложение, при его настройке подключается сторонний сервис и определяется его уровень доступа. </p>\n<p style=\"margin: 7px 0 7px 0;\">После подключения данные из ELMA365 могут служить способом аутентификации на стороннем сервисе, а также источником для обращения через Web API.</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало внимание</span></p>\n<p style=\"margin: 7px 0 7px 0;\">Создавать и настраивать внешнее приложение могут только <a class=\"topiclink\" href=\"360006871932.html#administrators\">администраторы системы</a>. </p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец внимание</span></p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"main-info\"></a><span class=\"f_Heading2\">Общий принцип работы внешнего приложения</span></h2>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Внешнее приложение осуществляет работу по протоколу авторизации OAuth2 следующим образом: </p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\">На стороне ELMA365 в модуле <a class=\"topiclink\" href=\"module-external-app.html#enable-app\">включается внешнее приложение и добавляется шаблон клиента OAuth2/OIDC</a>, по которому определяется предоставляемый уровень доступа. </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\"><a class=\"topiclink\" href=\"module-external-app.html#create-client\">Создаётся клиент OAuth2/OIDC</a>, т. е. указываются данные стороннего сервиса, которому разрешается доступ к ресурсам ELMA365. </li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\">Сервис нужно разработать самостоятельно, реализовав в нём клиентскую часть протокола OAuth2. <span style=\"background-color: #ffffff;\">Технические спецификации и стандарты</span> работы протокола OAuth2 читайте в <a class=\"weblink\" href=\"https://datatracker.ietf.org/doc/html/rfc6749\" target=\"_blank\">документации RFC</a>.</p>\n<ol style=\"list-style-type:decimal\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\"><a class=\"topiclink\" href=\"module-external-app.html#add-service\">В стороннем сервисе осуществляется подключение к ELMA365</a> по протоколу OAuth2. Соединение выполняется c помощью уникального идентификатора и секрета внешнего приложения, полученных при создании клиента.</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\">После установки связи пользователь разрешает стороннему сервису доступ с уровнем, указанным в настройках внешнего приложения, через свой аккаунт в ELMA365. </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"5\">Генерируется код авторизации и передаётся стороннему сервису. По полученному коду авторизации создаются токен доступа и токен обновления. </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"6\">В стороннем сервисе по токену доступа составляются и выполняются запросы на получение ресурсов ELMA365. Токен обновления применяется для генерации нового токена доступа в случае истечения срока его годности.</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"7\">Пользователь может <a class=\"topiclink\" href=\"module-external-app.html#check-connections\">проверить список подключений и разорвать соединение</a> в своём профиле.</li></ol>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"enable-app\"></a><span class=\"f_Heading2\">Включить внешнее приложение и создать шаблон доступа</span></h2>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Внешнее приложение подключается на стороне ELMA365 в модуле и служит способом интеграции платформы и стороннего сервиса. Соединение ELMA365 со сторонним сервисом осуществляется по протоколу OAuth2. </p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Для каждого пользовательского модуля можно создать одно внешнее приложение. При этом через внешнее приложение в модуле можно подключить несколько сервисов. </p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">При настройке внешнего приложения создаётся <span style=\"font-weight: bold;\">Шаблон клиента OAuth2/OIDC</span>. В нём указывается уровень доступа для стороннего сервиса. Можно предоставить доступ к данным пользователя, Web API или выбрать оба варианта. </p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\"><span style=\"background-color: #ffffff;\">Созданный шаблон выбирается при подключении стороннего сервиса. Если несколько сервисов подключаются к одному внешнему приложению, вы можете использовать один настроенный шаблон для предоставления одинакового уровня доступа. </span></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Для настройки внешнего приложения выполните следующие действия: </p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"1\">Перейдите в раздел <span style=\"font-weight: bold;\">Администрирование &gt; Модули</span> и выберите созданный <a class=\"topiclink\" href=\"extentions.html\">пользовательский модуль</a>.</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"2\">На странице модуля нажмите <span style=\"font-weight: bold;\">Управление</span> и перейдите на вкладку <span style=\"font-weight: bold;\">Внешнее приложение</span>.</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"3\">На открывшейся странице выберите <span style=\"font-weight: bold;\">Включить</span>. Создастся внешнее приложение, через которое будет осуществляться подключение стороннего сервиса. </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\">Название внешнего приложения можно отредактировать. Детали используются для идентификации внешнего приложения, когда пользователь разрешает доступ стороннему сервису на выполнение действий от его аккаунта.</li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\">Для изменения названия нажмите <span style=\"font-weight: bold;\">Настроить</span>. В открывшемся окне в поле <span style=\"font-weight: bold;\">Наследование</span> снимите флажок с опции <span style=\"font-weight: bold;\">Использовать основные данные модуля</span> и задайте название, описание и иконку для внешнего приложения. Сохраните настройки. </p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\"><img alt=\"module-external-app-1\" height=\"592\" src=\"module-external-app-1.png\" style=\"margin:0;width:1030px;height:592px;border:none\" width=\"1030\"/></p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"5\">После включения внешнего приложения на странице появится блок <span style=\"font-weight: bold;\">Шаблоны клиентов OAuth2/OIDC</span>. Нажмите <span style=\"font-weight: bold;\">+ Создать шаблон</span> и задайте уровень доступа для подключаемых сторонних сервисов:</li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\"><img alt=\"module-external-app-2\" height=\"534\" src=\"module-external-app-2.png\" style=\"margin:0;width:861px;height:534px;border:none\" width=\"861\"/></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">Название</span><span style=\"font-weight: bold; color: #ff0000;\">*</span> — укажите название, которое будет отображаться в списке созданных шаблонов при подключении стороннего сервиса; </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">Уровни доступа</span><span style=\"font-weight: bold; color: #ff0000;\">*</span> — определите, к каким ресурсам ELMA365 предоставляется доступ стороннему сервису после его подключения: <ul style=\"list-style-type:circle\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">openid</span> — доступ к данным пользователя, который разрешает подключение сервиса к ELMA365. Доступ необходим для выполнения протокола OpenID. Включает информацию об идентификаторе, компании и email. Например, через внешнее приложение с таким уровнем доступа можно запрашивать адреса электронной почты и синхронизировать учётные записи из ELMA365 с аккаунтами пользователей в стороннем сервисе;</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">api</span> — доступ к выполнению любых операций через <a class=\"weblink\" href=\"https://api.elma365.com/ru/public-api/guides/IntroWebAPI/\" target=\"_blank\">WebAPI</a>. Например, через внешнее приложение можно передавать запросы с стороннего сайта и создавать элементы приложений в ELMA365. </li></ul></li></ul>\n<ol start=\"6\" style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"6\">Сохраните шаблон клиента. </li></ol>\n<p style=\"margin: 7px 0 7px 0;\"><span style=\"font-weight: bold;\">Важно:</span> при создании шаблона клиента OAuth2/OIDC продумайте, каким образом будет использоваться настроенное внешнее приложение. В зависимости от этого выберите необходимые уровни доступа. При эксплуатации подключённого стороннего сервиса пользователи не смогут самостоятельно изменить набор предоставленных уровней доступа. </p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"create-client\"></a><span class=\"f_Heading2\">Создать клиента OAuth2/OIDC и подключить его к внешнему приложению </span></h2>\n<p style=\"margin: 7px 0 7px 0;\">После настройки внешнего приложения и шаблона клиента OAuth2/OIDC необходимо указать данные стороннего сервиса, которому разрешается доступ к ресурсам ELMA365.</p>\n<p style=\"margin: 7px 0 7px 0;\">Чтобы подключить сторонний сервис, выполните следующие действия:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"1\">Перейдите на главную страницу пользовательского модуля, для которого настроено внешнее приложение, и включите модуль. </li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"2\">Разверните блок <span style=\"font-weight: bold;\">Токены</span>, который появится на главной странице модуля. </li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"3\">Нажмите кнопку <span style=\"font-weight: bold;\">+ Создать клиент OAuth/OIDC</span> и заполните данные о подключаемом стороннем сервисе: </li></ol>\n<p style=\"margin: 7px 0 7px 36px;\"><img alt=\"module-external-app-3\" height=\"542\" src=\"module-external-app-3.png\" style=\"margin:0;width:900px;height:542px;border:none\" width=\"900\"/></p>\n<ul style=\"list-style-type:disc\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">Название</span><span style=\"font-weight: bold; color: #ff0000;\">*</span> — введите название подключаемого стороннего сервиса; </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">Шаблон</span><span style=\"font-weight: bold; color: #ff0000;\">*</span> — выберите любой шаблон клиента OAuth2/OIDC, созданный для внешнего приложения в модуле. С помощью указанного шаблона вы определяете, к каким ресурсам ELMA365 сторонний сервис будет иметь доступ; </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">Области применения</span> — данные уровней доступа из выбранного вами шаблона клиента OAuth2/OIDC. Показывается для информации;</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">URI перенаправления</span><span style=\"font-weight: bold; color: #ff0000;\">*</span> — укажите URL стороннего сервиса, по которому код авторизации из ELMA365 будет возвращаться в сервис. Доступна возможность внести несколько URI перенаправления. Для этого нажмите <span style=\"font-weight: bold;\">+ Добавить</span> и заполните поле;  </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">Истекает</span> — отметьте срок действия токенов, по которым выполняется соединение стороннего сервиса и ELMA365. По истечении этого периода работа с сервисом прекращается. Вы сможете создать клиента OAuth2/OIDC повторно и выпустить новые токены. </li></ul>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"4\">Сохраните настройки. </li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\" value=\"5\">Появится окно с сгенерированными данными внешнего приложения модуля, которые понадобятся для соединения с добавленным клиентом OAuth2/OIDC.</li></ol>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\">Окно показывается только один раз. Посмотреть эти данные повторно нельзя. Скопируйте и сохраните <span style=\"font-weight: bold;\">Уникальный идентификатор приложения</span> и <span style=\"font-weight: bold;\">Секрет приложения</span> и нажмите <span style=\"font-weight: bold;\">Готово</span>. </p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 36px;\"><img alt=\"module-external-app-4\" height=\"518\" src=\"module-external-app-4.png\" style=\"margin:0;width:838px;height:518px;border:none\" width=\"838\"/></p>\n<p style=\"line-height: 1.28; margin: 0 0 11px 0;\">Настройки на стороне ELMA365 завершены. Теперь необходимо установить соединение с ELMA365 в стороннем сервисе. </p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"add-service\"></a><span class=\"f_Heading2\">Подключить сторонний сервис к ELMA365 по протоколу OAuth2</span></h2>\n<p style=\"margin: 7px 0 7px 0;\">Подключение выполняется в стороннем сервисе по протоколу OAuth2 любым способом, который зависит от типа сервиса, набора применяемых инструментов, наличия готовых библиотек с решениями и действующих норм безопасности.</p>\n<p style=\"margin: 7px 0 7px 0;\">Приведём описание одного из возможных способов установки соединения стороннего сервиса и ELMA365:</p>\n<ol style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"1\">В стороннем сервисе сохраняются <span style=\"font-weight: bold;\">Уникальный идентификатор приложения</span> и <span style=\"font-weight: bold;\">Секрет приложения</span>, полученные при создании клиента OAuth2/OIDC в ELMA365. Данные следует указывать в коде не в явном виде, поскольку это нарушает требования безопасности и не позволяет их оперативно изменять.</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"2\">В<span style=\"font-weight: bold;\"> </span>стороннем сервисе реализуется перенаправление пользователя на страницу ELMA365. На этой странице пользователь разрешает доступ сервису к ресурсам ELMA365 при запуске передачи данных.</li></ol>\n<p style=\"text-indent: 1px; margin: 7px 0 7px 35px;\">Способ реализации перенаправления:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">&lt;URL-адрес_ELMA365&gt;/api/o/oauth/v2/authorize/client_id=&lt;Уникальный_идентификатор_приложения&gt;&amp;redirect_uri=&lt;Обратная_ссылка&gt;&amp;scope=&lt;Запрашиваемый_уровень_доступа&gt;&amp;response_type=code&amp;response_mode=query&amp;state=&lt;Ключ_защиты&gt;</span></p>\n<p style=\"margin: 7px 0 7px 36px;\">Где:</p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;URL-адрес_ELMA365&gt;</span> — путь до сервера ELMA365, где включено внешнее приложение в модуле и добавлен клиент OAuth2/OIDC;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Уникальный_идентификатор_приложения&gt;</span> — значение идентификатора, полученное при создании клиента OAuth2/OIDC в ELMA365;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Обратная_ссылка&gt;</span> — ссылка обратного перехода в сторонний сервис после того, как пользователь предоставил разрешение доступа к ресурсам ELMA365;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Запрашиваемый_уровень_доступа&gt;</span> — название запрашиваемого уровня доступа, указанного в шаблоне клиента OAuth2/OIDC: <span style=\"font-weight: bold;\">api</span> или <span style=\"font-weight: bold;\">openid</span>. Если в шаблоне настроено несколько уровней доступа, прописывается каждый из них;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Ключ_защиты&gt;</span> — верификационный ключ защиты, который представляет собой произвольное строковое значение.</li></ul>\n<p style=\"text-indent: -1px; margin: 7px 0 7px 36px;\">Для пользователя страница разрешения доступа стороннему сервису может выглядеть следующим образом:</p>\n<p style=\"text-indent: -1px; margin: 7px 0 7px 36px;\"><img alt=\"module-external-app-5\" height=\"485\" src=\"module-external-app-5.png\" style=\"margin:0;width:796px;height:485px;border:none\" width=\"796\"/></p>\n<p style=\"margin: 7px 0 7px 0;\">После разрешения доступа должен выполняться следующий порядок действий: </p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\">по пути из значения <span style=\"font-weight: bold;\">&lt;Обратная_ссылка&gt;</span> сторонний сервис принимает приходящие данные;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\">из поля <span style=\"font-weight: bold;\">code</span>, приходящего в ответе, извлекается код авторизации. С его помощью выполняется получение токена доступа и токена обновления.</li></ul>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"3\">Для выполнения этих действий необходимо:</li></ol>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"1\">составить скрипт, который отправляет в ELMA365 запрос POST:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">&lt;URL-адрес_ELMA365&gt;/api/o/oauth/v2/token</span></p>\n<ol start=\"2\" style=\"list-style-type:lower-latin\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"2\">в заголовок добавить значение:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">Content-Type:application/x-www-form-urlencoded.</span></p>\n<ol start=\"3\" style=\"list-style-type:lower-latin\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"3\">в теле передать:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">grant_type=authorization_code&amp;code=&lt;Код_авторизации&gt;&amp;client_id=&lt;Уникальный_идентификатор_приложения&gt;&amp;client_secret=&lt;Секрет_приложения&gt;&amp;redirect_uri=&lt;Обратная_ссылка&gt;</span></p>\n<p style=\"margin: 7px 0 7px 36px;\">Где:</p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Код_авторизации&gt;</span> — код авторизации, полученный в предыдущем действии;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Уникальный_идентификатор_приложения&gt;</span> — значение идентификатора внешнего приложения из ELMA365;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Секрет_приложения&gt;</span> — значение секрета внешнего приложения из ELMA365;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Обратная_ссылка&gt;</span> — ссылка обратного перехода в сторонний сервис.</li></ul>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"4\">Полученный JSON-ответ содержит: </li></ol>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\">в поле <span style=\"font-weight: bold;\">access_token</span> — токен доступа;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\">в поле <span style=\"font-weight: bold;\">refresh_token</span> — токен обновления;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\">в поле <span style=\"font-weight: bold;\">id_token</span> — данные о пользователе в виде строки <a class=\"weblink\" href=\"https://jwt.io/introduction\" target=\"_blank\">JSON Web Token (JWT)</a>. Возвращается, если указан уровень доступа <span style=\"font-weight: bold;\">openid</span>. </li></ul>\n<ol start=\"5\" style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"5\">Получив токен доступа, сторонний сервис запрашивает необходимые ресурсы в ELMA365 по реализованному для этого интерфейсу. </li></ol>\n<p style=\"margin: 7px 0 7px 0;\">По истечении срока действия токена доступа сторонний сервис отправляет запрос, который содержит токен обновления, для получения нового токена доступа.</p>\n<ol start=\"6\" style=\"list-style-type:upper-roman\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"6\">Для обновления токенов необходимо:</li></ol>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"1\">реализовать отправку в ELMA365 запроса <code><b>POST</b></code>: </li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">&lt;URL-адрес_ELMA365&gt;/api/o/oauth/v2/token </span></p>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"2\">в заголовок добавить значение:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">Content-Type:application/x-www-form-urlencoded </span></p>\n<ol style=\"list-style-type:lower-latin\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\" value=\"3\">в теле передать: </li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">grant_type=refresh_token&amp;refresh_token=&lt;Токен_обновления&gt;&amp;client_id=&lt;Уникальный_идентификатор_приложения&gt;&amp;client_secret=&lt;Секрет_приложения&gt;</span></p>\n<p style=\"margin: 7px 0 7px 36px;\">Где:</p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Токен_обновления&gt;</span> — токен обновления, полученный вместе с токеном доступа;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Уникальный_идентификатор_приложения&gt;</span> — значение идентификатора внешнего приложения из ELMA365, полученный ранее в секретах.</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">&lt;Секрет_приложения&gt;</span> — значение секрета внешнего приложения из ELMA365.</li></ul>\n<p style=\"margin: 7px 0 7px 0;\">Полученный JSON-ответ будет содержать: в поле <span style=\"font-weight: bold;\">access_token</span> новый токен доступа, в поле <span style=\"font-weight: bold;\">refresh_token</span> новый токен обновления.</p>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"data-transfer\"></a><span class=\"f_Heading2\">Особенности передачи данных</span></h2>\n<p style=\"margin: 7px 0 7px 0;\">Ознакомьтесь с особенностями передачи данных при различных уровнях доступа стороннего сервиса к ресурсам ELMA365:</p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">доступ к Web API</span> — при выполнении запросов используется токен доступа, полученный для уровня <span style=\"font-weight: bold;\">api</span>. Подробнее о принципе использования токена читайте в <a class=\"weblink\" href=\"https://api.elma365.com/ru/public-api/guides/WebAPIAuthorization/\" target=\"_blank\">справке по публичному API ELMA365</a>;</li><li style=\"line-height: 1.28; margin-top: 0; margin-right: 0; margin-bottom: 11px;\"><span style=\"font-weight: bold;\">доступ к данным пользователя</span> — запросы осуществляются по токену доступа уровня <span style=\"font-weight: bold;\">openid</span>. В поле <span style=\"font-weight: bold;\">id_token</span> <span style=\"background-color: #ffffff;\">передаются сериализованные данные по стандарту </span><a class=\"weblink\" href=\"https://jwt.io/introduction\" target=\"_blank\">JSON Web Token (JWT)</a>, содержащие информацию о пользователе: идентификатор, его электронный адрес и название компании. Для декодирования токена можно воспользоваться готовыми решениями для работы с JWT или самостоятельно реализовать алгоритм разбора.</li></ul>\n<h3 class=\"p_Heading3\"><a class=\"hmanchor\" id=\"tokens-due-date\"></a><span class=\"f_Heading3\">Срок действия токенов подключения</span></h3>\n<p style=\"margin: 7px 0 7px 0;\">Срок действия кода авторизации и токенов доступа и обновления ограничен:</p>\n<ul style=\"list-style-type:disc\">\n<li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">код авторизации</span> — срок действия для одного запроса 10 минут. Он используется единожды для получения других токенов. После этого код считается недействительным, дальнейшие запросы с его использованием отклоняются;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">токен доступа</span> — срок действия 10 минут. Токен позволяет выполнять несколько запросов в течение этого времени. По истечении срока действия он будет недоступен. Новый токен доступа запрашивается с помощью токена обновления;</li><li style=\"margin-top: 7px; margin-right: 0; margin-bottom: 7px;\"><span style=\"font-weight: bold;\">токен обновления</span> — срок действия 14 дней. По истечении этого времени необходимо получить новые токены доступа и обновления. Для этого пользователь должен запустить процесс авторизации повторно и разрешить доступ стороннему сервису к ELMA365.</li></ul>\n<h2 class=\"p_Heading2\"><a class=\"hmanchor\" id=\"check-connections\"></a><span class=\"f_Heading2\">Посмотреть список выданных разрешений</span></h2>\n<p style=\"margin: 7px 0 7px 0;\">Если в стороннем сервисе реализовано соединение с ELMA365, пользователь может запустить передачу данных. После этого он перенаправляется на страницу разрешения доступа сервису к ресурсам ELMA365. </p>\n<p style=\"margin: 7px 0 7px 0;\">Все выданные разрешения и установленные соединения фиксируются в ELMA365. Пользователь может просмотреть список предоставленных доступов и отозвать их в настройках своего профиля, на вкладке <span style=\"font-weight: bold;\">Внешние приложения</span>. </p>\n<p style=\"text-align: justify; margin: 7px 0 7px 0;\">Подробнее об этом читайте в статье <a class=\"topiclink\" href=\"360016398552.html#external-apps\">«Настройки профиля пользователя»</a>.</p>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"service-monitor.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">service-monitor.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"module-soap-service.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">module-soap-service.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n</body>\n</html>\n",
  "plain_text": "Внешнее приложение в модулях ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 Модули расширения системы > Пользовательские модули / Внешнее приложение в модулях Внешнее приложение в модулях В рамках модуля можно подключить внешнее приложение. Оно позволяет разрешить доступ сторонним сервисам к защищённым ресурсам ELMA365 по протоколу авторизации OAuth2. Предоставить доступ к данным из ELMA365 можно компьютерным программам, мобильным приложениям, веб‑сервисам и т. д. Для этого на стороне ELMA365 в модуле создаётся внешнее приложение, при его настройке подключается сторонний сервис и определяется его уровень доступа. После подключения данные из ELMA365 могут служить способом аутентификации на стороннем сервисе, а также источником для обращения через Web API. начало внимание Создавать и настраивать внешнее приложение могут только администраторы системы . конец внимание Общий принцип работы внешнего приложения Внешнее приложение осуществляет работу по протоколу авторизации OAuth2 следующим образом: На стороне ELMA365 в модуле включается внешнее приложение и добавляется шаблон клиента OAuth2/OIDC , по которому определяется предоставляемый уровень доступа. Создаётся клиент OAuth2/OIDC , т. е. указываются данные стороннего сервиса, которому разрешается доступ к ресурсам ELMA365. Сервис нужно разработать самостоятельно, реализовав в нём клиентскую часть протокола OAuth2. Технические спецификации и стандарты работы протокола OAuth2 читайте в документации RFC . В стороннем сервисе осуществляется подключение к ELMA365 по протоколу OAuth2. Соединение выполняется c помощью уникального идентификатора и секрета внешнего приложения, полученных при создании клиента. После установки связи пользователь разрешает стороннему сервису доступ с уровнем, указанным в настройках внешнего приложения, через свой аккаунт в ELMA365. Генерируется код авторизации и передаётся стороннему сервису. По полученному коду авторизации создаются токен доступа и токен обновления. В стороннем сервисе по токену доступа составляются и выполняются запросы на получение ресурсов ELMA365. Токен обновления применяется для генерации нового токена доступа в случае истечения срока его годности. Пользователь может проверить список подключений и разорвать соединение в своём профиле. Включить внешнее приложение и создать шаблон доступа Внешнее приложение подключается на стороне ELMA365 в модуле и служит способом интеграции платформы и стороннего сервиса. Соединение ELMA365 со сторонним сервисом осуществляется по протоколу OAuth2. Для каждого пользовательского модуля можно создать одно внешнее приложение. При этом через внешнее приложение в модуле можно подключить несколько сервисов. При настройке внешнего приложения создаётся Шаблон клиента OAuth2/OIDC . В нём указывается уровень доступа для стороннего сервиса. Можно предоставить доступ к данным пользователя, Web API или выбрать оба варианта. Созданный шаблон выбирается при подключении стороннего сервиса. Если несколько сервисов подключаются к одному внешнему приложению, вы можете использовать один настроенный шаблон для предоставления одинакового уровня доступа. Для настройки внешнего приложения выполните следующие действия: Перейдите в раздел Администрирование > Модули и выберите созданный пользовательский модуль . На странице модуля нажмите Управление и перейдите на вкладку Внешнее приложение . На открывшейся странице выберите Включить . Создастся внешнее приложение, через которое будет осуществляться подключение стороннего сервиса. Название внешнего приложения можно отредактировать. Детали используются для идентификации внешнего приложения, когда пользователь разрешает доступ стороннему сервису на выполнение действий от его аккаунта. Для изменения названия нажмите Настроить . В открывшемся окне в поле Наследование снимите флажок с опции Использовать основные данные модуля и задайте название, описание и иконку для внешнего приложения. Сохраните настройки. После включения внешнего приложения на странице появится блок Шаблоны клиентов OAuth2/OIDC . Нажмите + Создать шаблон и задайте уровень доступа для подключаемых сторонних сервисов: Название * — укажите название, которое будет отображаться в списке созданных шаблонов при подключении стороннего сервиса; Уровни доступа * — определите, к каким ресурсам ELMA365 предоставляется доступ стороннему сервису после его подключения: openid — доступ к данным пользователя, который разрешает подключение сервиса к ELMA365. Доступ необходим для выполнения протокола OpenID. Включает информацию об идентификаторе, компании и email. Например, через внешнее приложение с таким уровнем доступа можно запрашивать адреса электронной почты и синхронизировать учётные записи из ELMA365 с аккаунтами пользователей в стороннем сервисе; api — доступ к выполнению любых операций через WebAPI . Например, через внешнее приложение можно передавать запросы с стороннего сайта и создавать элементы приложений в ELMA365. Сохраните шаблон клиента. Важно: при создании шаблона клиента OAuth2/OIDC продумайте, каким образом будет использоваться настроенное внешнее приложение. В зависимости от этого выберите необходимые уровни доступа. При эксплуатации подключённого стороннего сервиса пользователи не смогут самостоятельно изменить набор предоставленных уровней доступа. Создать клиента OAuth2/OIDC и подключить его к внешнему приложению После настройки внешнего приложения и шаблона клиента OAuth2/OIDC необходимо указать данные стороннего сервиса, которому разрешается доступ к ресурсам ELMA365. Чтобы подключить сторонний сервис, выполните следующие действия: Перейдите на главную страницу пользовательского модуля, для которого настроено внешнее приложение, и включите модуль. Разверните блок Токены , который появится на главной странице модуля. Нажмите кнопку + Создать клиент OAuth/OIDC и заполните данные о подключаемом стороннем сервисе: Название * — введите название подключаемого стороннего сервиса; Шаблон * — выберите любой шаблон клиента OAuth2/OIDC, созданный для внешнего приложения в модуле. С помощью указанного шаблона вы определяете, к каким ресурсам ELMA365 сторонний сервис будет иметь доступ; Области применения — данные уровней доступа из выбранного вами шаблона клиента OAuth2/OIDC. Показывается для информации; URI перенаправления * — укажите URL стороннего сервиса, по которому код авторизации из ELMA365 будет возвращаться в сервис. Доступна возможность внести несколько URI перенаправления. Для этого нажмите + Добавить и заполните поле; Истекает — отметьте срок действия токенов, по которым выполняется соединение стороннего сервиса и ELMA365. По истечении этого периода работа с сервисом прекращается. Вы сможете создать клиента OAuth2/OIDC повторно и выпустить новые токены. Сохраните настройки. Появится окно с сгенерированными данными внешнего приложения модуля, которые понадобятся для соединения с добавленным клиентом OAuth2/OIDC. Окно показывается только один раз. Посмотреть эти данные повторно нельзя. Скопируйте и сохраните Уникальный идентификатор приложения и Секрет приложения и нажмите Готово . Настройки на стороне ELMA365 завершены. Теперь необходимо установить соединение с ELMA365 в стороннем сервисе. Подключить сторонний сервис к ELMA365 по протоколу OAuth2 Подключение выполняется в стороннем сервисе по протоколу OAuth2 любым способом, который зависит от типа сервиса, набора применяемых инструментов, наличия готовых библиотек с решениями и действующих норм безопасности. Приведём описание одного из возможных способов установки соединения стороннего сервиса и ELMA365: В стороннем сервисе сохраняются Уникальный идентификатор приложения и Секрет приложения , полученные при создании клиента OAuth2/OIDC в ELMA365. Данные следует указывать в коде не в явном виде, поскольку это нарушает требования безопасности и не позволяет их оперативно изменять. В стороннем сервисе реализуется перенаправление пользователя на страницу ELMA365. На этой странице пользователь разрешает доступ сервису к ресурсам ELMA365 при запуске передачи данных. Способ реализации перенаправления: <URL-адрес_ELMA365>/api/o/oauth/v2/authorize/client_id=<Уникальный_идентификатор_приложения>&redirect_uri=<Обратная_ссылка>&scope=<Запрашиваемый_уровень_доступа>&response_type=code&response_mode=query&state=<Ключ_защиты> Где: <URL-адрес_ELMA365> — путь до сервера ELMA365, где включено внешнее приложение в модуле и добавлен клиент OAuth2/OIDC; <Уникальный_идентификатор_приложения> — значение идентификатора, полученное при создании клиента OAuth2/OIDC в ELMA365; <Обратная_ссылка> — ссылка обратного перехода в сторонний сервис после того, как пользователь предоставил разрешение доступа к ресурсам ELMA365; <Запрашиваемый_уровень_доступа> — название запрашиваемого уровня доступа, указанного в шаблоне клиента OAuth2/OIDC: api или openid . Если в шаблоне настроено несколько уровней доступа, прописывается каждый из них; <Ключ_защиты> — верификационный ключ защиты, который представляет собой произвольное строковое значение. Для пользователя страница разрешения доступа стороннему сервису может выглядеть следующим образом: После разрешения доступа должен выполняться следующий порядок действий: по пути из значения <Обратная_ссылка> сторонний сервис принимает приходящие данные; из поля code , приходящего в ответе, извлекается код авторизации. С его помощью выполняется получение токена доступа и токена обновления. Для выполнения этих действий необходимо: составить скрипт, который отправляет в ELMA365 запрос POST: <URL-адрес_ELMA365>/api/o/oauth/v2/token в заголовок добавить значение: Content-Type:application/x-www-form-urlencoded. в теле передать: grant_type=authorization_code&code=<Код_авторизации>&client_id=<Уникальный_идентификатор_приложения>&client_secret=<Секрет_приложения>&redirect_uri=<Обратная_ссылка> Где: <Код_авторизации> — код авторизации, полученный в предыдущем действии; <Уникальный_идентификатор_приложения> — значение идентификатора внешнего приложения из ELMA365; <Секрет_приложения> — значение секрета внешнего приложения из ELMA365; <Обратная_ссылка> — ссылка обратного перехода в сторонний сервис. Полученный JSON-ответ содержит: в поле access_token — токен доступа; в поле refresh_token — токен обновления; в поле id_token — данные о пользователе в виде строки JSON Web Token (JWT) . Возвращается, если указан уровень доступа openid . Получив токен доступа, сторонний сервис запрашивает необходимые ресурсы в ELMA365 по реализованному для этого интерфейсу. По истечении срока действия токена доступа сторонний сервис отправляет запрос, который содержит токен обновления, для получения нового токена доступа. Для обновления токенов необходимо: реализовать отправку в ELMA365 запроса POST : <URL-адрес_ELMA365>/api/o/oauth/v2/token в заголовок добавить значение: Content-Type:application/x-www-form-urlencoded в теле передать: grant_type=refresh_token&refresh_token=<Токен_обновления>&client_id=<Уникальный_идентификатор_приложения>&client_secret=<Секрет_приложения> Где: <Токен_обновления> — токен обновления, полученный вместе с токеном доступа; <Уникальный_идентификатор_приложения> — значение идентификатора внешнего приложения из ELMA365, полученный ранее в секретах. <Секрет_приложения> — значение секрета внешнего приложения из ELMA365. Полученный JSON-ответ будет содержать: в поле access_token новый токен доступа, в поле refresh_token новый токен обновления. Особенности передачи данных Ознакомьтесь с особенностями передачи данных при различных уровнях доступа стороннего сервиса к ресурсам ELMA365: доступ к Web API — при выполнении запросов используется токен доступа, полученный для уровня api . Подробнее о принципе использования токена читайте в справке по публичному API ELMA365 ; доступ к данным пользователя — запросы осуществляются по токену доступа уровня openid . В поле id_token передаются сериализованные данные по стандарту JSON Web Token (JWT) , содержащие информацию о пользователе: идентификатор, его электронный адрес и название компании. Для декодирования токена можно воспользоваться готовыми решениями для работы с JWT или самостоятельно реализовать алгоритм разбора. Срок действия токенов подключения Срок действия кода авторизации и токенов доступа и обновления ограничен: код авторизации — срок действия для одного запроса 10 минут. Он используется единожды для получения других токенов. После этого код считается недействительным, дальнейшие запросы с его использованием отклоняются; токен доступа — срок действия 10 минут. Токен позволяет выполнять несколько запросов в течение этого времени. По истечении срока действия он будет недоступен. Новый токен доступа запрашивается с помощью токена обновления; токен обновления — срок действия 14 дней. По истечении этого времени необходимо получить новые токены доступа и обновления. Для этого пользователь должен запустить процесс авторизации повторно и разрешить доступ стороннему сервису к ELMA365. Посмотреть список выданных разрешений Если в стороннем сервисе реализовано соединение с ELMA365, пользователь может запустить передачу данных. После этого он перенаправляется на страницу разрешения доступа сервису к ресурсам ELMA365. Все выданные разрешения и установленные соединения фиксируются в ELMA365. Пользователь может просмотреть список предоставленных доступов и отозвать их в настройках своего профиля, на вкладке Внешние приложения . Подробнее об этом читайте в статье «Настройки профиля пользователя» . service-monitor.html module-soap-service.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360024498352.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/extentions.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360006871932.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/module-external-app.html",
    "https://datatracker.ietf.org/doc/html/rfc6749",
    "https://api.elma365.com/ru/public-api/guides/IntroWebAPI/",
    "https://jwt.io/introduction",
    "https://api.elma365.com/ru/public-api/guides/WebAPIAuthorization/",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/360016398552.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/service-monitor.html",
    "https://elma365.com/ru/help/crm/ru/help/business_solutions/module-soap-service.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T21:58:13.445704",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T21:58:13.486396"
  }
}