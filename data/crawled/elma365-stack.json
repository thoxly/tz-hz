{
  "doc_id": "elma365-stack",
  "url": "https://elma365.com/ru/help/ecm/ru/help/platform/elma365-stack.html",
  "title": "Установка ELMA365 stack",
  "breadcrumbs": [
    "ELMA365 On-Premises"
  ],
  "section": "ELMA365 On-Premises | [ecm]",
  "html": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<title>Установка ELMA365 stack</title>\n<meta content=\"Help+Manual\" name=\"generator\"/>\n<meta content=\"\" name=\"keywords\"/>\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<meta content=\"width=device-width, initial-scale=1.0\" name=\"viewport\"/>\n<meta content=\"ELMA365 On-Premises можно установить в уже существующий Kubernetes-кластер. ELMA365 поставляется в виде Helm-чартов:\" name=\"description\"/>\n<meta content=\"\" name=\"picture\"/>\n<meta content=\"website\" property=\"og:type\"/>\n<meta content=\"Cправка по Low-code платформе ELMA365\" property=\"og:title\"/>\n<meta content=\"https://elma365.com/ru/help\" property=\"og:url\"/>\n<meta content=\"\" property=\"og:image\"/>\n<meta content=\"ELMA365\" property=\"og:site_name\"/>\n<link href=\"favicon.png\" rel=\"icon\" type=\"image/png\"/>\n<link href=\"https://elma365.com/ru/help/platform/elma365-stack.html\" rel=\"canonical\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\"/>\n<link href=\"./jquery-ui.min.css\" rel=\"stylesheet\"/>\n<link href=\"default.css\" rel=\"stylesheet\"/>\n<link href=\"./search-yandex.css\" rel=\"stylesheet\"/>\n<link href=\"./article.css\" rel=\"stylesheet\"/>\n<link href=\"./glossary.css\" rel=\"stylesheet\"/>\n<link href=\"./theme.css\" rel=\"stylesheet\"/>\n<link href=\"./tooltipster.bundle.min.css\" rel=\"stylesheet\" type=\"text/css\"/>\n<script src=\"jquery.js\" type=\"text/javascript\"></script>\n<script src=\"./tooltipster.bundle.min.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n        $(document).ready($('.tooltip').tooltipster({\n            contentCloning: true,\n            theme: 'tooltipster-borderless',\n        }));\n    </script>\n<script src=\"helpman_settings.js\" type=\"text/javascript\"></script>\n<script src=\"helpman_topicinit.js\" type=\"text/javascript\"></script>\n<script src=\"highlight.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n     $(document).ready(function(){highlight();});\n   </script>\n</head>\n<body>\n<script async=\"\" src=\"https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9\"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>\n<script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,\"script\",\"https://mc.yandex.ru/metrika/tag.js\"),ym(83179930,\"init\",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=\"\" src=\"https://mc.yandex.ru/watch/83179930\" style=\"position:absolute;left:-9999px\"/></div></noscript> \n    \n    ﻿<header class=\"header elma-365\">\n<div class=\"container\">\n<div class=\"nav-container\">\n<div class=\"nav-wrap\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<div class=\"header__navi\">\n<ul class=\"header__list\"><li><span class=\"solution-select\"><span class=\"solution-select__selected\"></span><svg fill=\"none\" height=\"4\" viewbox=\"0 0 7 4\" width=\"7\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M1 1L3.5 3.5L6 1\" stroke=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><ul class=\"solution-select__list\"><li class=\"header__list-item\"><a class=\"project-link\" href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">CSP</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/crm/crm-functions.html\">CRM+CX</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/kedo/kedo.html\">КЭДО</a></li><li><a class=\"project-link\" href=\"https://elma365.com/ru/help/business_solutions/-elma365-store.html\">Бизнес-решения</a></li><ul class=\"social-links-header\"><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://elma-academy.com/ru/\" target=\"_blank\">Academy</a></li><li class=\"social-link-header\"><a class=\"project-link\" href=\"https://community.elma365.com/ru/\" target=\"_blank\">Community</a></li><li></li></ul></ul></span></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li class=\"header__list-item\"><a class=\"header__list-item-url\" href=\"https://tssdk.elma365.com/latest/\" target=\"_blank\">SDK</a></li><li class=\"header__list-item header__list-item-latest\"><a class=\"header__list-item-url header__list-item-last\" href=\"https://elma365.com/ru/\" target=\"_blank\">Сайт ELMA365</a></li></ul>\n<div class=\"hero-wrap\" style=\"display: flex; align-items: center;\">\n<div class=\"hero__search\" style=\"display: flex; justify-content: space-between; width: 100%; padding-left: 0;\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img alt=\"header logo\" src=\"./logo.svg\"/>\n</a>\n<button class=\"hero__search-icon\" id=\"search-icon\">\n<img alt=\"search string\" src=\"search-icon-white.svg\"/>\n</button>\n<div class=\"hero__search-form\" id=\"search-panel\"><form class=\"search-form\"><label class=\"search-form__label\"><span class=\"search__icon\" id=\"reset-search\" src=\"Union.svg\"></span><input class=\"search-form__input\" type=\"text\"/></label><input class=\"search-form__submit\" type=\"submit\" value=\"Submit\"/></form></div>\n</div>\n</div>\n</div>\n</div>\n<a class=\"hero__side-icon\" href=\"#\" id=\"side-menu-icon\">\n<img alt=\"side menu\" src=\"side_menu.svg\"/>\n</a>\n</div>\n</div>\n</header>\n<main class=\"main container\">\n<aside class=\"sidebar\" id=\"sidebar\">\n<div class=\"sidebar__header\">\n<a class=\"header__logo\" href=\"https://elma365.com/ru/help\">\n<img src=\"./logo-light.svg\"/>\n</a>\n<span class=\"sidebar__close elma-365-close\" id=\"close\"></span>\n</div>\n<div class=\"sidebar__wrapper\" id=\"side-menu\">\n</div>\n</aside>\n<article class=\"article\" id=\"article\">\n<div class=\"article-inner\">\n<div class=\"content\">\n<header class=\"article__header\">\n<div class=\"article__bread\" style=\"display:flex; gap:8px;\">\n<span class=\"search-res__item-category search-res__item-category_subcategory subcategory article__badge\" id=\"subcategory\"></span>\n<nav class=\"topic__breadcrumbs\">\n<p><a href=\"elma365-on-premises.html\">ELMA365 On-Premises</a> &gt; Дополнительные настройки ELMA365 On-Premises / Установка ELMA365 stack</p>\n</nav>\n</div>\n<div class=\"topic__title\"><h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Установка ELMA365 stack</span></h1>\n</div>\n</header>\n<section class=\"article__content\">\n<div class=\"scroll-top-inner\">\n<a class=\"scroll-top\" href=\"#h1-article\"></a>\n</div>\n<!-- Placeholder for topic body. -->\n<p class=\"p_Normal\">ELMA365 On-Premises можно установить в уже существующий Kubernetes-кластер. ELMA365 поставляется в виде Helm-чартов:</p>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><span style=\"font-weight: bold;\">elma365-stack</span> — полный стэк ELMA365, включает в себя Helm-пакеты <code><b>elma365</b></code>, <code><b>elma365-dbs</b></code> и <code><b>elma365-addons</b></code>; </li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">elma365</span> — пакет приложения ELMA365; </li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">elma365-dbs</span> — набор баз данных и хранилищ, необходимых для работы ELMA365. Также есть возможность использовать собственные базы данных PostgreSQL, MongoDB, Redis, RabbitMQ, хранилище S3, указав строки подключения к ним <code><b>values</b></code> пакета <span style=\"font-weight: bold;\">elma365</span>. При этом в файле <code><b>values.yaml</b></code> установку соответствующих компонентов можно отключить, выставив значение <code><b>false</b></code>, например, для PostgreSQL<span style=\"font-weight: bold;\"> </span><code><b>global.postgresql.enabled</b></code>. Если все пять компонентов чарта будут выставлены в <code><b>false</b></code>, установка этого чарта не требуется. О создании баз данных читайте в разделе <a class=\"topiclink\" href=\"postgresql.html\">«Подготовка внешних баз данных»</a>; </li><li class=\"p_Normal\"><span style=\"font-weight: bold;\">elma365-addons</span> — дополнения для ELMA365 Enterprise, включающие в себя систему маршрутизации (Service Mesh) <span style=\"font-weight: bold;\">Linkerd</span>, систему мониторинга <span style=\"font-weight: bold;\">Prometheus + Grafana</span>, а также <span style=\"font-weight: bold;\">Descheduler</span>, <span style=\"font-weight: bold;\">NodeLocal DNSCache</span> и модуль <span style=\"font-weight: bold;\">Аудит безопасности</span>. </li></ul>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">начало внимание</span></p>\n<p class=\"p_Normal\">Чарты <span style=\"font-weight: bold;\">elma365-extension</span> больше не поддерживаются. Переход на чарты <span style=\"font-weight: bold;\">elma365-dbs</span> с новыми версиями баз данных выполняется с помощью дампа и его восстановления.</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">конец внимание </span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Требования к конфигурации Kubernetes</span></h2>\n<p class=\"p_Normal\">Система устанавливается при помощи Helm в Kubernetes-кластер, который содержит следующие компоненты: <span style=\"font-weight: bold;\">ingress-nginx контроллер</span>, <span style=\"font-weight: bold;\">coredns</span>, <span style=\"font-weight: bold;\">rbac</span>, <span style=\"font-weight: bold;\">storageclass</span>. Поддерживаемые версии Kubernetes и Helm смотрите в статье <a class=\"topiclink\" href=\"elma365-enterprise-on-premises.html#kubernetes\">«Системные требования ELMA365 On-Premises»</a>. </p>\n<p class=\"p_Normal\">Кроме того, должно быть разрешено проксирование из подов во внешнюю сеть.</p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка ELMA365 с помощью чарта elma365-stack</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Добавьте репозиторий Helm ELMA365 и извлеките список переменных пакета приложения со всеми необходимыми компонентами в файл:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm repo add </span><span class=\"f_CodeExample\">elma365 https://charts.elma365.tech</span><br/>\n<span class=\"f_CodeExample\">helm repo update</span><br/>\n<span class=\"f_CodeExample\">helm show values elma365/elma365-stack &gt; values-elma365-stack.yaml</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">Заполните переменные в файле <code><b>values-elma365-stack.yaml</b></code>, заменив как минимум следующие параметры:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><code><b>elma365.global.host</b></code> — домен (FQDN) или IP-адрес, по которому будет доступна система; </li><li class=\"p_Normal\"><code><b>elma365.bootstrapCompany.email</b></code> — электронная почта администратора; </li><li class=\"p_Normal\"><code><b>elma365.bootstrapCompany.password</b></code> — пароль администратора;</li><li class=\"p_Normal\"><code><b>elma365.db.psqlUrl</b></code> — строка подключения к БД PostgreSQL;</li><li class=\"p_Normal\"><code><b>elma365.db.mongoUrl</b></code> — строка подключения к БД MongoDB для приложения; </li><li class=\"p_Normal\"><code><b>elma365.db.vahterMongoUrl</b></code> — строка подключения к БД MongoDB для сервера авторизации; </li><li class=\"p_Normal\"><code><b>elma365.db.redisUrl</b></code> — строка подключения к Redis; </li><li class=\"p_Normal\"><code><b>elma365.db.amqpUrl</b></code> — строка подключения к RabbitMQ; </li><li class=\"p_Normal\"><code><b>elma365.db.s3.method</b></code> — метод запросов к S3; </li><li class=\"p_Normal\"><code><b>elma365.db.s3.accesskeyid</b></code> — имя пользователя S3;</li><li class=\"p_Normal\"><code><b>elma365.db.s3.secretaccesskey</b></code> — пароль для пользователя S3; </li><li class=\"p_Normal\"><code><b>elma365.db.s3.bucket</b></code> — бакет S3; </li><li class=\"p_Normal\"><code><b>elma365.db.s3.backend.address</b></code> — адрес S3; </li><li class=\"p_Normal\"><code><b>elma365.db.s3.backend.region</b></code> — регион S3; </li><li class=\"p_Normal\"><code><b>elma365.db.s3.ssl.enabled</b></code> — включение SSL S3. </li></ul>\n<ol start=\"3\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Если требуется создать отдельный <code><b>namespace</b></code>, укажите его во всех командах установки.</li><li class=\"p_Normal\" value=\"4\">Сохраните файл <code><b>values-elma365-stack.yaml</b></code> для последующих обновлений.</li></ol>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка баз данных</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">При использовании своих баз данных установку встроенных баз можно пропустить, изменив значение в параметре <code><b>global.elma365-dbs.enabled</b></code> на <code><b>false</b></code> в файле <code><b>values-elma365-stack.yaml</b></code>. В случае использования одной или нескольких внешних баз, например, PostgreSQL, можно пропустить его установку, изменив параметр <code><b>global.postgresql.enabled</b></code> на <code><b>false</b></code>.</li><li class=\"p_Normal\" value=\"2\">Выполните установку баз данных. На этом шаге необходимо отключить установку приложения ELMA365 следующей командой (обратите внимание на параметр <code><b>--set global.elma365.enabled=false</b></code>):</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack \\</span><br/>\n<span class=\"f_CodeExample\">-f values-elma365-stack.yaml \\</span><br/>\n<span class=\"f_CodeExample\"> --set global.elma365.enabled=</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">false</span><span class=\"f_CodeExample\"> \\</span><br/>\n<span class=\"f_CodeExample\"> --timeout=30m --wait \\</span><br/>\n<span class=\"f_CodeExample\"> [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка приложения ELMA365</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Если необходимо восстановить дамп, перед установкой ELMA365 вы можете воспользоваться утилитой <a class=\"topiclink\" href=\"database-backup-and-recovery.html\">elma365-backupper</a> или выполнить скрипт <code><b>elma365db.sh</b></code> из чарта <span style=\"font-weight: bold;\">elma365</span>.</li></ol>\n<p class=\"p_Normal\" style=\"margin: 0 0 0 36px;\">Пример выполнения скрипта:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm pull elma365/elma365-stack --untar</span><br/>\n<span class=\"f_CodeExample\">./elma365-stack/charts/elma365/elma365db.sh --restore --path /backup/path/ \\</span><br/>\n<span class=\"f_CodeExample\">[--kubeconfig /path/to/config --context prod] [-n namespace]</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">Выполните установку приложения ELMA365 командой:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack \\</span><br/>\n<span class=\"f_CodeExample\">-f values-elma365-stack.yaml \\</span><br/>\n<span class=\"f_CodeExample\">--timeout=30m --wait [-n namespace]</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"3\">Для создания дампа можно воспользоваться утилитой <a class=\"topiclink\" href=\"database-backup-and-recovery.html\">elma365-backupper</a> или выполнить скрипт <code><b>elma365db.sh</b></code> из чарта <span style=\"font-weight: bold;\">elma365.</span></li></ol>\n<p class=\"p_Normal\" style=\"margin: 0 0 0 36px;\">Пример использования скрипта:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm pull elma365/elma365-stack --untar</span><br/>\n<span class=\"f_CodeExample\">./elma365-stack/charts/elma365/elma365db.sh --dump --path /backup/path/ \\</span><br/>\n<span class=\"f_CodeExample\">[--kubeconfig /path/to/config --context prod] [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка средств мониторинга (опционально)</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">В файле <code><b>values-elma365-stack.yaml</b></code> отключите неиспользуемые компоненты, изменив значение в параметрах <code><b>global.linkerd2.enabled</b></code>, <code><b>global.descheduler.enabled</b></code>, <code><b>global.node-local-dns.enabled</b></code> и <code><b>global.audit.enabled</b></code> на <code><b>false</b></code>, так как для их установки необходимы предварительные настройки.</li><li class=\"p_Normal\" value=\"2\">В параметрах <code><b>elma365-addons.kube-prometheus-stack</b></code> и <code><b>elma365-addons.grafana</b></code> укажите требуемый <code><b>namespace</b></code> для сервиса мониторинга (например, <code><b>namespaceOverride: monitoring</b></code>), адрес, по которому будет доступен сервис мониторинга и включите дэшборды, изменив значение в параметре <code><b>elma365.global.dashboard.enabled</b></code> на <code><b>true</b></code>.</li><li class=\"p_Normal\" value=\"3\">Создайте <code><b>namespace</b></code> для сервиса мониторинга командой:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl create namespace monitoring</span></p>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Выполните установку следующей командой (обратите внимание на параметр <code><b>--set global.elma365-addons.enabled=true</b></code>):</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack \\</span><br/>\n<span class=\"f_CodeExample\"> -f values-elma365-stack.yaml \\</span><br/>\n<span class=\"f_CodeExample\"> --set global.elma365-addons.enabled=</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">true</span><span class=\"f_CodeExample\"> \\</span><br/>\n<span class=\"f_CodeExample\"> --timeout=30m --wait \\</span><br/>\n<span class=\"f_CodeExample\">  [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка Linkerd и автомасштабирование сервисов (опционально)</span></h2>\n<p class=\"p_Normal\">Linkerd — это выделенный уровень инфраструктуры, который помогает обрабатывать связь между сервисами, автоматически шифровать соединения, обрабатывать повторные запросы и тайм-ауты, использовать телеметрию (коэффициент успешности, задержки) и т. д.</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Сгенерируйте сертификаты с помощью <code><b>openssl</b></code>, выполнив команды ниже. Linkerd требует сертификат привязки доверия и сертификаты эмитента с соответствующим ключом для поддержки взаимных TLS-соединений между сервисами, для всех сертификатов требуется алгоритм<span style=\"font-weight: bold;\"> ECDSA P-256</span>.</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\"># Создать закрытый ключ CA</span><br/>\n<span class=\"f_CodeExample\">openssl ecparam -name prime256v1 -genkey -noout -out ca-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\"># Создать открытый ключ CA</span><br/>\n<span class=\"f_CodeExample\">openssl ec -</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">in</span><span class=\"f_CodeExample\"> ca-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem -pubout -out ca-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">public</span><span class=\"f_CodeExample\">.pem</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\"># Создать самоподписанный сертификат CA</span><br/>\n<span class=\"f_CodeExample\">openssl req -x509 -</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">new</span><span class=\"f_CodeExample\"> -key ca-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem -days 365 \\</span><br/>\n<span class=\"f_CodeExample\"> -out ca.crt -subj \"/CN=root.linkerd.cluster.local\"</span><br/>\n<span class=\"f_CodeExample\"># Создать закрытый ключ эмитента</span><br/>\n<span class=\"f_CodeExample\">openssl ecparam -name prime256v1 -genkey -noout -out issuer-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\"># Создать открытый ключ эмитента</span><br/>\n<span class=\"f_CodeExample\">openssl ec -</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">in</span><span class=\"f_CodeExample\"> issuer-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem -pubout -out issuer-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">public</span><span class=\"f_CodeExample\">.pem</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\"># Создать запрос на подпись сертификата</span><br/>\n<span class=\"f_CodeExample\">openssl req -</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">new</span><span class=\"f_CodeExample\"> -key issuer-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem -out issuer.csr \\</span><br/>\n<span class=\"f_CodeExample\"> -subj \"/CN=identity.linkerd.cluster.local\" \\</span><br/>\n<span class=\"f_CodeExample\"> -addext basicConstraints=critical,CA:TRUE</span><br/>\n<span class=\"f_CodeExample\"> </span><br/>\n<span class=\"f_CodeExample\"># Создать сертификат эмитента, подписав запрос</span><br/>\n<span class=\"f_CodeExample\">openssl x509 \\</span><br/>\n<span class=\"f_CodeExample\">    -extfile /etc/ssl/openssl.cnf \\</span><br/>\n<span class=\"f_CodeExample\">    -extensions v3_ca \\</span><br/>\n<span class=\"f_CodeExample\">    -req \\</span><br/>\n<span class=\"f_CodeExample\">    -</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">in</span><span class=\"f_CodeExample\"> issuer.csr \\</span><br/>\n<span class=\"f_CodeExample\">    -days 180 \\</span><br/>\n<span class=\"f_CodeExample\">    -CA ca.crt \\</span><br/>\n<span class=\"f_CodeExample\">    -CAkey ca-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem \\</span><br/>\n<span class=\"f_CodeExample\">    -CAcreateserial \\</span><br/>\n<span class=\"f_CodeExample\">    -extensions v3_ca \\</span><br/>\n<span class=\"f_CodeExample\">    -out issuer.crt</span><br/>\n<span class=\"f_CodeExample\"># Удалить запрос на подпись сертификата</span><br/>\n<span class=\"f_CodeExample\">rm issuer.csr</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">В файле <code><b>values-elma365-stack.yaml</b></code> отключите неиспользуемые компоненты, изменив значение в параметрах <code><b>global.kube-prometheus-stack.enabled</b></code>, <code><b>global.grafana.enabled</b></code>, <code><b>global.descheduler.enabled</b></code>, <code><b>global.node-local-dns.enabled</b></code> и <code><b>global.audit.enabled</b></code> на <code><b>false</b></code>, так как для их установки необходимы предварительные настройки.</li><li class=\"p_Normal\" value=\"3\">В параметрах <code><b>elma365-addons.linkerd2</b></code> укажите требуемый <code><b>namespace</b></code> для сервиса Linkerd (например, <code><b>namespace: linkerd</b></code>), содержимое сертификатов, ключа и срок действия сертификата <code><b>crtExpiry</b></code>. Обратите внимание, значение должно соответствовать дате истечения срока действия сертификата эмитента.</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">identityTrustAnchorsPEM: |</span><br/>\n<span class=\"f_CodeExample\">    -----BEGIN CERTIFICATE-----</span><br/>\n<span class=\"f_CodeExample\">    содержимое сертификата ca.crt</span><br/>\n<span class=\"f_CodeExample\">    -----END CERTIFICATE-----</span><br/>\n<span class=\"f_CodeExample\">  identity:</span><br/>\n<span class=\"f_CodeExample\">    issuer:</span><br/>\n<span class=\"f_CodeExample\">      crtExpiry: 2023-03-30T05:28:39Z</span><br/>\n<span class=\"f_CodeExample\">      tls:</span><br/>\n<span class=\"f_CodeExample\">        crtPEM: |</span><br/>\n<span class=\"f_CodeExample\">          -----BEGIN CERTIFICATE-----</span><br/>\n<span class=\"f_CodeExample\">          содержимое сертификата issuer.crt</span><br/>\n<span class=\"f_CodeExample\">          -----END CERTIFICATE-----</span><br/>\n<span class=\"f_CodeExample\">        keyPEM: |</span><br/>\n<span class=\"f_CodeExample\">          -----BEGIN EC PRIVATE KEY-----</span><br/>\n<span class=\"f_CodeExample\">          содержимое сертификата issuer-</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">private</span><span class=\"f_CodeExample\">.pem</span><br/>\n<span class=\"f_CodeExample\">          -----END EC PRIVATE KEY-----</span></p>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Включите автомасштабирование сервисов, изменив значение в параметре <code><b>elma365.global.autoscaling.enabled</b></code> на <code><b>true</b></code>.</li><li class=\"p_Normal\" value=\"5\">Выполните установку следующей командой (обратите внимание на параметр <code><b>--set global.elma365-addons.enabled=true</b></code>):</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack \\</span><br/>\n<span class=\"f_CodeExample\"> -f values-elma365-stack.yaml --set global.elma365-addons.enabled=</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">true</span><span class=\"f_CodeExample\"> \\</span><br/>\n<span class=\"f_CodeExample\"> --timeout=30m --wait [-n namespace]</span></p>\n<ol start=\"6\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"6\">Добавьте аннотацию на <code><b>namespace</b></code> с приложением ELMA365 для автоматической инъекции контейнеров Linkerd-proxy в сервисы ELMA365 командой:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl annotate namespace </span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">default</span><span class=\"f_CodeExample\"> linkerd.io/inject=enabled</span></p>\n<ol start=\"6\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"7\">Перезапустите все сервисы командой:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl rollout restart deploy [-n namespace] &amp;&amp; kubectl rollout restart ds [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка NodeLocal DNS Cache (опционально)</span></h2>\n<p class=\"p_Normal\">Установка NodeLocal DNS Cache позволяет снизить нагрузку по DNS-запросам в кластере Kubernetes и повысить стабильность преобразования DNS-имён. Это позволит избежать правил DNAT, connection tracking и ограничений по количеству соединений.</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Получите IP-адрес сервиса <span style=\"font-weight: bold;\">kube-dns</span>:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl get svc kube-dns -n kube-system -o jsonpath={.spec.clusterIP}</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">В файле <code><b>values-elma365-stack.yaml</b></code> отключите неиспользуемые компоненты, изменив значение в параметрах <code><b>global.kube-prometheus-stack.enabled</b></code>, <code><b>global.grafana.enabled</b></code>, <code><b>global.descheduler.enabled</b></code>, <code><b>global.linkerd2.enabled</b></code> и <code><b>global.audit.enabled</b></code> на <code><b>false</b></code>, так как для их установки необходимы предварительные настройки.</li><li class=\"p_Normal\" value=\"3\">В параметрах <code><b>elma365-addons.node-local-dns</b></code> укажите следующие параметры:</li></ol>\n<ul style=\"list-style-type:disc\">\n<li class=\"p_Normal\"><code><b>pillar_dns_domain</b></code> — домен кластера;</li><li class=\"p_Normal\"><code><b>pillar_dns_server</b></code> — IP-адрес сервиса <span style=\"font-weight: bold;\">kube-dns</span>;</li><li class=\"p_Normal\"><code><b>pillar_local_dns</b></code> — локальный IP-адрес для NodeLocal DNS Cache.</li></ul>\n<ol start=\"4\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"4\">Выполните установку командой (обратите внимание на параметр <code><b>--set global.elma365-addons.enabled=true</b></code>):</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack \\</span><br/>\n<span class=\"f_CodeExample\"> -f values-elma365-stack.yaml --set global.elma365-addons.enabled=</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">true</span><span class=\"f_CodeExample\"> \\</span><br/>\n<span class=\"f_CodeExample\"> --timeout=30m --wait [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Установка Kyverno (опционально)</span></h2>\n<p class=\"p_Normal\"><span style=\"font-weight: bold;\">Kyverno</span> позволяет управлять специфическими конфигурациями среды независимо от конфигураций ресурсов, применять передовые методы настройки для своих кластеров, в частности, путём блокировки или изменения запросов API.</p>\n<h3 class=\"p_Heading3\"><span class=\"f_Heading3\">Политика добавления пользовательских сертификатов CA во все контейнеры</span></h3>\n<p class=\"p_Normal\">В некоторых случаях требуется доверять пользовательским сертификатам CA. Kyverno позволяет автоматически монтировать их в контейнеры. Политика добавляет том, содержащий сертификат, ко всем контейнерам с меткой <span style=\"font-weight: bold;\">tier=elma365</span>.</p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Создайте <span style=\"font-weight: bold;\">ConfigMap</span> с сертификатом корневого CA.</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl create configmap elma365-onpremise-ca --from-file=/etc/ssl/certs/rootCA.pem  [-n namespace]</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">В файле <code><b>values-elma365-stack.yaml</b></code> включите Kyverno, изменив значение параметра <code><b>global.kyverno.enabled</b></code> на <code><b>true</b></code>. Затем отключите неиспользуемые компоненты, изменив значение у дополнения в параметре <code><b>global</b></code> на <code><b>false</b></code>, так как для их установки необходимы предварительные настройки.</li><li class=\"p_Normal\" value=\"3\"><span style=\"color: #212529; background-color: #ffffff;\">В параметрах </span><code><b>elma365-addons.kyverno</b></code><span style=\"color: #212529; background-color: #ffffff;\"> укажите требуемый </span><code><b>namespace</b></code><span style=\"color: #212529; background-color: #ffffff;\"> для сервиса Kyverno</span>,<span style=\"font-weight: bold; color: #212529; background-color: #ffffff;\"> </span><span style=\"color: #212529; background-color: #ffffff;\">например, </span><code><b>namespace: kyverno</b></code><span style=\"color: #212529; background-color: #ffffff;\">. Затем включите политику добавления сертификатов, изменив значение в параметре </span><code><b>elma365-addons.kyverno.injectСerts.enabled</b></code><span style=\"color: #212529; background-color: #ffffff;\"> на </span><code><b>true</b></code><span style=\"color: #212529; background-color: #ffffff;\">, укажите имя </span><span style=\"font-weight: bold; color: #212529; background-color: #ffffff;\">ConfigMap</span><span style=\"color: #212529; background-color: #ffffff;\"> с сертификатом корневого CA. В параметре </span><code><b>injectNamespace</b></code><span style=\"color: #212529; background-color: #ffffff;\"> укажите список </span><code><b>namespace</b></code><span style=\"color: #212529; background-color: #ffffff;\">, в которых будет применена политика добавления сертификатов. </span></li><li class=\"p_Normal\" value=\"4\">Создайте <code><b>namespace</b></code> для сервиса Kyverno командой:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl create namespace kyverno</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"5\">Выполните установку следующей командой (обратите внимание на параметр <code><b>--set global.elma365-addons.enabled=true</b></code>:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack \\</span><br/>\n<span class=\"f_CodeExample\">-f values-elma365-stack.yaml --set global.elma365-addons.enabled=</span><span class=\"f_CodeExample\" style=\"font-weight: bold;\">true</span><span class=\"f_CodeExample\"> \\</span><br/>\n<span class=\"f_CodeExample\">--timeout=30m --wait [-n namespace]</span></p>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"6\">Перезапустите все сервисы командой:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl rollout restart deploy [-n namespace] &amp;&amp; kubectl rollout restart ds [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Обновление версии ELMA365</span></h2>\n<ol style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"1\">Обновите список чартов в репозитории, выполнив команду:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm repo update</span></p>\n<ol start=\"2\" style=\"list-style-type:upper-roman\">\n<li class=\"p_Normal\" value=\"2\">Используйте файл <code><b>values-elma365-stack.yaml</b></code>, сохранённый на этапе установки, а затем выполните команду:</li></ol>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm upgrade --install elma365-stack elma365/elma365-stack -f values-elma365-stack.yaml --timeout=30m --wait [-n namespace]</span></p>\n<p class=\"p_Normal\">В случае изменения строк подключения (сonnection strings) к БД при обновлении приложения перезапустите все сервисы командой:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">kubectl default rollout restart deploy [-n namespace] &amp;&amp; kubectl default rollout restart ds [-n namespace]</span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Удаление чарта elma365</span></h2>\n<p class=\"p_Normal\">Для удаления пакета ELMA365 посмотрите список установленных релизов, а затем выполните команду удаления:</p>\n<p class=\"p_CodeExample\" style=\"page-break-inside: avoid;\"><span class=\"f_CodeExample\">helm list [-n namespace]</span><br/>\n<span class=\"f_CodeExample\">helm uninstall elma365-stack [-n namespace] </span></p>\n<h2 class=\"p_Heading2\"><span class=\"f_Heading2\">Параметры чарта elma365-stack</span></h2>\n<p class=\"p_Normal\"> </p>\n<div style=\"text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;\"><table style=\"width:100%; border:none; border-spacing:0;\">\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Имя</span></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Описание</span></p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Значение по умолчанию</span></p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Глобальные параметры </span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.elma365.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить установку приложения ELMA365</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.elma365-dbs.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить установку баз данных</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.postgresql.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить PostgreSQL в установку баз данных</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.mongodb.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить MongoDB в установку баз данных</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.redis.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить Redis в установку баз данных</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.rabbitmq.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить RabbitMQ в установку баз данных</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.minio.</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить MinIO для S3 хранилища в установку баз данных</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.elasticsearch.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить Elasticsearch в установку баз данных (включается для ELMA Bot)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.elma365-addons.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить установку дополнений для ELMA365</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.kube-prometheus-stack.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить Prometheus в установку дополнений для ELMA365 (перед установкой необходимо создать <code><b>namespace monitoring</b></code>)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.grafana.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить Grafana в установку дополнений для ELMA365</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.linkerd2.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить Linkerd в установку дополнений для ELMA365</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.descheduler.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить Descheduler в установку дополнений для ELMA365 (необходимо не менее 3 узлов в кластере)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.node-local-dns.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить NodeLocal DNS Cache в установку дополнений для ELMA365</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>global.audit.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить сервис <span style=\"font-weight: bold;\">Аудит безопасности</span> в установку дополнений для ELMA365</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Глобальные параметры ELMA365 </span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.host</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Домен (FQDN) или IP-адрес, по которому будет доступна система</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>example.ru</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.ingress.hostEnabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включение <code><b>host</b></code> в ingress (значение берётся из <code><b>global.host</b></code>).</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.ingress.onpremiseTls.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включение https</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.ingress.onpremiseTls.secret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета с сертификатами для работы https</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"elma365-onpremise-tls\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.ingress.onpremiseTls.enabledCA</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включение сертификата корневого CA для работы https с самоподписанным сертификатом</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.ingress.onpremiseTls.configCA</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя конфигмапы с сертификатом корневого CA для работы https с самоподписанным сертификатом</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"elma365-onpremise-ca\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.ingress.annotations</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Аннотации для ingress</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>{\"kubernetes.io/ingress.class\": \"nginx\"}</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.autoscaling.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включение автомасштабирования сервисов</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>true</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.autoscaling.minReplicas</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Минимальное количество реплик</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">1</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.autoscaling.maxReplicas</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное количество реплик</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">9</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.dashboard.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включение дэшбордов для Grafana</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.image.repository</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Адрес для registry </p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>hub.elma365.tech</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.image.dockerRegistry</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Адрес для registry</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.image.pullSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Секрет с правами доступа к приватному registry, должен быть создан вручную, зашифрованный в Base64</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>[yandexsecret]</b></code></p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Дополнительные параметры </span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.postgres.maxIdleConns</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное количество подключений к главному узлу PostgreSQL в пуле незанятых подключений</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">50</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.postgres.maxOpenConns</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное количество открытых подключений к главному узлу PostgreSQL из пула</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">150</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.postgres.maxConnLife</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное время жизни подключения к главному узлу PostgreSQL из пула</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">1m</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.postgres.poolMaxIdleConns</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное количество подключений к репликам PostgreSQL в пуле незанятых подключений</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">50</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.postgres.poolMaxOpenConns</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное количество открытых подключений к репликам PostgreSQL из пула</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">150</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.postgres.poolConnMaxLifetime</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальное время жизни подключения к репликам PostgreSQL из пула</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">5m</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.maxGrpcMessageSize</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальный размер ответов</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">8388608</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.maxGrpcBackoffDelay</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Максимальная задержка между попытками установки GRPC-соединения</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">2s</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.activeDeadlineSeconds</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Количество секунд, которое отводится всему Job на выполнение</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">3000</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.curlCreateCompanyMaxTime</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Количество секунд, которое отводится Job на выполнение создания компании</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">1800</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.global.curlMigrationsMaxTime</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Количество секунд, которое отводится Job на выполнение миграции</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">3000</p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Общие параметры </span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.debug</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включить режим отладки платформы</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.bootstrapCompany.email</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Электронная почта администратора</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>admin@mail.com</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.bootstrapCompany.password</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Пароль администратора</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">test</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.bootstrapCompany.locale</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Язык установленной системы, возможные варианты: ru-RU, en-US, sk-SK</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">ru-RU</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.language.default</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Язык установленной системы, возможные варианты: ru-RU, en-US, sk-SK</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">ru-RU</p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Строки подключения (сonnection strings) для подключения к БД</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.psqlUrl</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к БД PostgreSQL</p>\n</td>\n<td style=\"vertical-align:middle; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"db.psqlUrl: 'postgres://\npostgres:pgpassword@\npostgres.default.svc.cluster.\nlocal:5432/elma365?sslmode=disable\"</b></code> </p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.psqlSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета со строкой подключения к БД PostgreSQL, зашифрованной в Base64 (ключ PSQL_URL)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.roPsqlUrl</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к БД PostgreSQL только для чтения</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.roPsqlSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета со строкой подключения к БД PostgreSQL только для чтения, зашифрованной в Base64 (ключ RO_POSTGRES_URL)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.mongoUrl</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к БД MongoDB для приложения</p>\n</td>\n<td style=\"vertical-align:middle; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"mongodb://elma365:mongopassword@\nmongo.default.svc.cluster.local:\n27017/elma365?ssl=false&amp;replicaSet=\nrs0&amp;readPreference=\nsecondaryPreferred\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.mongoSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета со строкой подключения к БД MongoDB для приложения, зашифрованной в Base64 (ключ MONGO_URL)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; height:83px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.vahterMongoUrl</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; height:83px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к БД MongoDB для сервера авторизации</p>\n</td>\n<td style=\"vertical-align:middle; width:98px; height:83px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"mongodb://elma365:mongopassword@\nmongo.default.svc.cluster.local:\n27017/elma365?ssl=false&amp;replicaSet=\nrs0&amp;readPreference=\nsecondaryPreferred\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.vahterMongoSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета со строкой подключения к БД MongoDB для сервера авторизации</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.redisUrl</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к Redis</p>\n</td>\n<td style=\"vertical-align:middle; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"redis://redis.default.svc.cluster.local:6379/0\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.redisSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета со строкой подключения к Redis, зашифрованной в Base64 (ключ REDIS_URL)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.amqpUrl</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к RabbitMQ</p>\n</td>\n<td style=\"vertical-align:middle; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"amqp://elma365:rmqpassword@\nrabbitmq.default.svc.\ncluster.local:5672/elma365\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.amqpSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета со строкой подключения к RabbitMQ, зашифрованной в Base64 (ключ AMQP_URL)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.method</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Метод запросов</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">PUT</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.accesskeyid</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя пользователя</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>PZSF73JG72Ksd955JKU1HIA</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.secretaccesskey</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Пароль для пользователя</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>aFDkj28Jbs2JKbnvJH678MNwiz88zKjsuNBHHs</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.bucket</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Список бакетов</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>s3elma365</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.backend.address</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Адрес S3 </p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>example.ru</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.backend.region</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Регион</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>us-east-1</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3.ssl.enabled</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Включение SSL</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\"<code><b>false</b></code>\"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.db.s3Secret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Имя секрета с подключением к S3 хранилищу файлов, зашифрованной в Base64</p>\n<p class=\"p_Normal\">  # (ключи S3_BACKEND_ADDRESS, S3_REGION, S3_KEY, S3_SECRET, S3_BUCKET, S3_SSL_ENABLED, S3_UPLOAD_METHOD)</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Настройки для подключения к SMTP-серверу отправки почты</span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.mailer.smtp.host</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Адрес SMTP-сервера</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.mailer.smtp.port</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Порт SMTP-сервера</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.mailer.smtp.from</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Адрес отправителя электронной почты</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.mailer.smtp.user</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Пользователь для авторизации на SMTP-сервере</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.mailer.smtp.password</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Пароль для авторизации на SMTP-сервере</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\">\" \"</p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365.mailer.smtp.needTLS</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Используется ли шифрование</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>false</b></code></p>\n</td>\n</tr>\n<tr>\n<td colspan=\"3\" style=\"vertical-align:top; width:1187px; padding:0; border:none\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Глобальные параметры сервиса «Аудит безопасности» </span></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365-addons.audit.global.psql_url</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Строка подключения к БД PostgreSQL</p>\n</td>\n<td style=\"vertical-align:middle; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>\"postgresql://postgres:pgpassword@\npostgres.default.svc.cluster.\nlocal:5432/audit?sslmode=disable\"</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365-addons.audit.image.repository</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Адрес для registry </p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>hub.elma365.tech</b></code></p>\n</td>\n</tr>\n<tr>\n<td style=\"vertical-align:top; width:258px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>elma365-addons.audit.image.pullSecret</b></code></p>\n</td>\n<td style=\"vertical-align:top; width:831px; padding:0; border:none\"><p class=\"p_Normal\">Секрет с правами доступа к приватному registry, должен быть создан вручную, зашифрованный в Base64</p>\n</td>\n<td style=\"vertical-align:top; width:98px; padding:0; border:none\"><p class=\"p_Normal\"><code><b>[yandexsecret]</b></code></p>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"bottom-nav\">\n<a class=\"topic__navi_prev\" href=\"install-kontur-tunnel.html\" id=\"prev-link\">\n<span class=\"bottom-nav__arrow bottom-nav__arrow--prev\"></span> <span class=\"bottom-nav__link\">install-kontur-tunnel.html</span>\n</a>\n<a class=\"topic__navi_next\" href=\"install-kubernetes.html\" id=\"next-link\">\n<span class=\"bottom-nav__link\">install-kubernetes.html</span> <span class=\"bottom-nav__arrow bottom-nav__arrow--next\"></span>\n</a>\n</div>\n<!-- добавляет на страницу строку блок Была ли статья полезной?  -->\n<div class=\"feedback-wrap\"><div class=\"feedback\" id=\"feedback\"><span><b>Была ли статья полезной?</b></span><form action=\"\" class=\"feedback-form\" id=\"feedback-form\" method=\"POST\"><div class=\"feedback__popup feedback__popup-response\" id=\"feedback__popup_thx\">Спасибо за ваш отзыв!</div><div id=\"feedback-success-popup\"><div class=\"wrap\"><button class=\"feedback-popup-close\" type=\"button\">×</button><svg fill=\"none\" height=\"44\" viewbox=\"0 0 44 44\" width=\"44\" xmlns=\"http://www.w3.org/2000/svg\"><g clip-path=\"url(#clip0_212_2187)\"><path d=\"M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z\" fill=\"#27AE60\"></path></g><defs><clippath id=\"clip0_212_2187\"><rect fill=\"white\" height=\"44\" width=\"44\"></rect></clippath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class=\"feedback__popup\" id=\"feedback__popup_why\"><button class=\"feedback-popup-close\" type=\"button\">×</button><div class=\"feedback__popup-header\">Уточните, почему:</div><input id=\"bad_recommendation\" name=\"category\" type=\"radio\" value=\"bad_recommendation\"/><label for=\"bad_recommendation\">Рекомендации не помогли</label><input id=\"difficult_text\" name=\"category\" type=\"radio\" value=\"difficult_text\"/><label for=\"difficult_text\">Текст трудно понять</label><input id=\"no_answer\" name=\"category\" type=\"radio\" value=\"no_answer\"/><label for=\"no_answer\">Нет ответа на мой вопрос</label><input id=\"bad_header\" name=\"category\" type=\"radio\" value=\"bad_header\"/><label for=\"bad_header\">Содержание статьи не соответствует заголовку</label><input id=\"other_reason\" name=\"category\" type=\"radio\" value=\"other_reason\"/><label for=\"other_reason\">Другая причина</label></div><div class=\"feedback__popup\" id=\"feedback__popup-other\"><button class=\"feedback-popup-close\" type=\"button\">×</button> <div class=\"feedback__popup-header\">Расскажите, что вам не понравилось в статье:</div><textarea class=\"feedback__textarea\" id=\"\" name=\"other\"></textarea><input class=\"feedback__other-btn\" type=\"submit\" value=\"Отправить\"/></div><div class=\"feedback-form__btn-group\"><input id=\"feedback__useful_yes\" name=\"useful\" type=\"radio\" value=\"true\"/><label for=\"feedback__useful_yes\"><img src=\"like.svg\"/><span class=\"feedback-form__btn-group_yes-btn\">Да</span></label><input id=\"feedback__useful_no\" name=\"useful\" type=\"radio\" value=\"false\"/><label for=\"feedback__useful_no\"><img src=\"dislike.svg\"/><span class=\"feedback-form__btn-group_no-btn\">Нет</span></label></div><select name=\"category\"><option disabled=\"\">Выберите вариант</option><option selected=\"\" value=\"bad_recommendation\">Рекомендации не помогли</option><option value=\"difficult_text\">Текст трудно понять</option><option value=\"no_answer\">Нет ответа на мой вопрос</option><option value=\"bad_header\">Содержание статьи не соответствует заголовку</option><option value=\"other_reason\">Другая причина</option></select><input type=\"submit\"/></form></div></div>\n</section>\n</div>\n<aside class=\"article__sidebar\" style=\"display:none\">\n<input type=\"checkbox\"/>\n<div class=\"article__arrow\"></div>\n<div class=\"table-of-contents elma365-right\" id=\"toc2Content\">\n<h3 class=\"h3-toc\">В этой статье</h3>\n<nav id=\"toc2\"></nav>\n</div>\n</aside>\n</div>\n</article>\n</main>\n<footer class=\"footer\">\n<div class=\"footer-container\">\n<div class=\"footer-mobile\">\n<ul class=\"footer-mobile__list\"><li><a href=\"https://api.elma365.com/ru/\" target=\"_blank\">API</a></li><li><a href=\"https://tssdk.elma365.com/\" target=\"_blank\">TS SDK</a></li><li><a href=\"https://community.elma365.com/\" target=\"_blank\">Community</a></li><li><a href=\"https://elma-academy.com/ru/elma365\" target=\"_blank\">Академия</a></li></ul><ul class=\"footer-mobile__list\"><li><a href=\"https://elma365.com/ru/help/platform/get-trial.html\">Платформа</a></li><li><a href=\"https://elma365.com/ru/help/ecm/ecm-functions.html\">ECM</a></li><li><a href=\"https://elma365.com/ru/help/service/service-functions.html\">Service</a></li><li><a href=\"https://elma365.com/ru/help/projects/projects-functions.html\">Проекты</a></li></ul>\n</div>\n<div class=\"container\">\n<div class=\"footer-wrap\">\n<div><span class=\"mobile-question-popup\">Отправить фидбэк</span><form action=\"\" class=\"question__popup question-xs\" id=\"question__popup\" method=\"POST\"><div class=\"question-wrap\"><span class=\"close\"></span><span class=\"title\">Задать вопрос</span><label for=\"help_question\" style=\"display: none;\"></label><textarea id=\"help_question\" name=\"help_question\"></textarea><input type=\"submit\" value=\"Отправить\"/></div></form><div class=\"hidden fade-in question-success-xs\">Ваш фидбэк отправлен.</div></div>\n<div class=\"footer-flex-b\">\n<div class=\"footer-top\">\n<span class=\"footer-copy\">© 2025 \n              ELMA365\n            \n            \n          </span>\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</div>\n<div class=\"footer-line\">\n<div class=\"footer-line-copy\">\n<span class=\"footer-copy\">© 2025 \n                  ELMA365\n                \n                \n              </span>\n</div>\n<ul class=\"footer-list\">\n<li class=\"footer-item footer-url-elma\"><a class=\"footer-link footer-url-link-elma\" href=\"https://elma365.com/ru/\" style=\"color: #0D4A75;\" target=\"_blank\"><img alt=\"browse icon\" class=\"footer-img footer-img-elma-url\" src=\"browse.svg\"/>elma365.com</a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vkvideo.ru/@elma_bpm\" target=\"_blank\"><img alt=\"vk-video icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk-video.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://vk.com/elma_bpm\" target=\"_blank\"><img alt=\"vk icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"vk.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://t.me/elmaday\" target=\"_blank\"><img alt=\"telegram icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"telegram.svg\" width=\"20\"/></a></li><li class=\"footer-item\"><a class=\"footer-link\" href=\"https://dzen.ru/elma\" target=\"_blank\"><img alt=\"dzen icon\" class=\"footer-img social-footer-img\" height=\"20\" src=\"social_dzen.svg\" width=\"20\"/></a></li>\n<li class=\"footer-item sk-footer-img\">\n<a class=\"sk-img\" href=\"https://navigator.sk.ru/orn/1122971\" target=\"_blank\">\n<img alt=\"sk icon\" class=\"footer-img\" height=\"34\" src=\"sk-resident.svg\" width=\"117\"/>\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<a class=\"arrow-top\" href=\"#\"></a>\n</div>\n</footer>\n<!--    <script type=\"text/javascript\" src=\"jquery1.min.js\"></script>-->\n<iframe name=\"hmnavigation\" style=\"display:none!important\"></iframe>\n<!--<script src=\"./jquery-ui.js\"></script> -->\n<script src=\"./jquery-ui.min.js\"></script>\n<!--script src=\"//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js\" type=\"text/javascript\" charset=\"utf-8\"></script-->\n<script src=\"./jquery.tocify.min.js\"></script>\n<script src=\"./TypoReporter.min.js\"></script>\n<script src=\"./google-search.js\"></script>\n<script src=\"./main.js\"></script>\n</body>\n</html>\n",
  "plain_text": "Установка ELMA365 stack ﻿ Платформа CSP CRM+CX Проекты Service КЭДО Бизнес-решения Academy Community API SDK Сайт ELMA365 ELMA365 On-Premises > Дополнительные настройки ELMA365 On-Premises / Установка ELMA365 stack Установка ELMA365 stack ELMA365 On-Premises можно установить в уже существующий Kubernetes-кластер. ELMA365 поставляется в виде Helm-чартов: elma365-stack — полный стэк ELMA365, включает в себя Helm-пакеты elma365 , elma365-dbs и elma365-addons ; elma365 — пакет приложения ELMA365; elma365-dbs — набор баз данных и хранилищ, необходимых для работы ELMA365. Также есть возможность использовать собственные базы данных PostgreSQL, MongoDB, Redis, RabbitMQ, хранилище S3, указав строки подключения к ним values пакета elma365 . При этом в файле values.yaml установку соответствующих компонентов можно отключить, выставив значение false , например, для PostgreSQL global.postgresql.enabled . Если все пять компонентов чарта будут выставлены в false , установка этого чарта не требуется. О создании баз данных читайте в разделе «Подготовка внешних баз данных» ; elma365-addons — дополнения для ELMA365 Enterprise, включающие в себя систему маршрутизации (Service Mesh) Linkerd , систему мониторинга Prometheus + Grafana , а также Descheduler , NodeLocal DNSCache и модуль Аудит безопасности . начало внимание Чарты elma365-extension больше не поддерживаются. Переход на чарты elma365-dbs с новыми версиями баз данных выполняется с помощью дампа и его восстановления. конец внимание Требования к конфигурации Kubernetes Система устанавливается при помощи Helm в Kubernetes-кластер, который содержит следующие компоненты: ingress-nginx контроллер , coredns , rbac , storageclass . Поддерживаемые версии Kubernetes и Helm смотрите в статье «Системные требования ELMA365 On-Premises» . Кроме того, должно быть разрешено проксирование из подов во внешнюю сеть. Установка ELMA365 с помощью чарта elma365-stack Добавьте репозиторий Helm ELMA365 и извлеките список переменных пакета приложения со всеми необходимыми компонентами в файл: helm repo add elma365 https://charts.elma365.tech helm repo update helm show values elma365/elma365-stack > values-elma365-stack.yaml Заполните переменные в файле values-elma365-stack.yaml , заменив как минимум следующие параметры: elma365.global.host — домен (FQDN) или IP-адрес, по которому будет доступна система; elma365.bootstrapCompany.email — электронная почта администратора; elma365.bootstrapCompany.password — пароль администратора; elma365.db.psqlUrl — строка подключения к БД PostgreSQL; elma365.db.mongoUrl — строка подключения к БД MongoDB для приложения; elma365.db.vahterMongoUrl — строка подключения к БД MongoDB для сервера авторизации; elma365.db.redisUrl — строка подключения к Redis; elma365.db.amqpUrl — строка подключения к RabbitMQ; elma365.db.s3.method — метод запросов к S3; elma365.db.s3.accesskeyid — имя пользователя S3; elma365.db.s3.secretaccesskey — пароль для пользователя S3; elma365.db.s3.bucket — бакет S3; elma365.db.s3.backend.address — адрес S3; elma365.db.s3.backend.region — регион S3; elma365.db.s3.ssl.enabled — включение SSL S3. Если требуется создать отдельный namespace , укажите его во всех командах установки. Сохраните файл values-elma365-stack.yaml для последующих обновлений. Установка баз данных При использовании своих баз данных установку встроенных баз можно пропустить, изменив значение в параметре global.elma365-dbs.enabled на false в файле values-elma365-stack.yaml . В случае использования одной или нескольких внешних баз, например, PostgreSQL, можно пропустить его установку, изменив параметр global.postgresql.enabled на false . Выполните установку баз данных. На этом шаге необходимо отключить установку приложения ELMA365 следующей командой (обратите внимание на параметр --set global.elma365.enabled=false ): helm upgrade --install elma365-stack elma365/elma365-stack \\ -f values-elma365-stack.yaml \\ --set global.elma365.enabled= false \\ --timeout=30m --wait \\ [-n namespace] Установка приложения ELMA365 Если необходимо восстановить дамп, перед установкой ELMA365 вы можете воспользоваться утилитой elma365-backupper или выполнить скрипт elma365db.sh из чарта elma365 . Пример выполнения скрипта: helm pull elma365/elma365-stack --untar ./elma365-stack/charts/elma365/elma365db.sh --restore --path /backup/path/ \\ [--kubeconfig /path/to/config --context prod] [-n namespace] Выполните установку приложения ELMA365 командой: helm upgrade --install elma365-stack elma365/elma365-stack \\ -f values-elma365-stack.yaml \\ --timeout=30m --wait [-n namespace] Для создания дампа можно воспользоваться утилитой elma365-backupper или выполнить скрипт elma365db.sh из чарта elma365. Пример использования скрипта: helm pull elma365/elma365-stack --untar ./elma365-stack/charts/elma365/elma365db.sh --dump --path /backup/path/ \\ [--kubeconfig /path/to/config --context prod] [-n namespace] Установка средств мониторинга (опционально) В файле values-elma365-stack.yaml отключите неиспользуемые компоненты, изменив значение в параметрах global.linkerd2.enabled , global.descheduler.enabled , global.node-local-dns.enabled и global.audit.enabled на false , так как для их установки необходимы предварительные настройки. В параметрах elma365-addons.kube-prometheus-stack и elma365-addons.grafana укажите требуемый namespace для сервиса мониторинга (например, namespaceOverride: monitoring ), адрес, по которому будет доступен сервис мониторинга и включите дэшборды, изменив значение в параметре elma365.global.dashboard.enabled на true . Создайте namespace для сервиса мониторинга командой: kubectl create namespace monitoring Выполните установку следующей командой (обратите внимание на параметр --set global.elma365-addons.enabled=true ): helm upgrade --install elma365-stack elma365/elma365-stack \\ -f values-elma365-stack.yaml \\ --set global.elma365-addons.enabled= true \\ --timeout=30m --wait \\ [-n namespace] Установка Linkerd и автомасштабирование сервисов (опционально) Linkerd — это выделенный уровень инфраструктуры, который помогает обрабатывать связь между сервисами, автоматически шифровать соединения, обрабатывать повторные запросы и тайм-ауты, использовать телеметрию (коэффициент успешности, задержки) и т. д. Сгенерируйте сертификаты с помощью openssl , выполнив команды ниже. Linkerd требует сертификат привязки доверия и сертификаты эмитента с соответствующим ключом для поддержки взаимных TLS-соединений между сервисами, для всех сертификатов требуется алгоритм ECDSA P-256 . # Создать закрытый ключ CA openssl ecparam -name prime256v1 -genkey -noout -out ca- private .pem # Создать открытый ключ CA openssl ec - in ca- private .pem -pubout -out ca- public .pem # Создать самоподписанный сертификат CA openssl req -x509 - new -key ca- private .pem -days 365 \\ -out ca.crt -subj \"/CN=root.linkerd.cluster.local\" # Создать закрытый ключ эмитента openssl ecparam -name prime256v1 -genkey -noout -out issuer- private .pem # Создать открытый ключ эмитента openssl ec - in issuer- private .pem -pubout -out issuer- public .pem # Создать запрос на подпись сертификата openssl req - new -key issuer- private .pem -out issuer.csr \\ -subj \"/CN=identity.linkerd.cluster.local\" \\ -addext basicConstraints=critical,CA:TRUE # Создать сертификат эмитента, подписав запрос openssl x509 \\ -extfile /etc/ssl/openssl.cnf \\ -extensions v3_ca \\ -req \\ - in issuer.csr \\ -days 180 \\ -CA ca.crt \\ -CAkey ca- private .pem \\ -CAcreateserial \\ -extensions v3_ca \\ -out issuer.crt # Удалить запрос на подпись сертификата rm issuer.csr В файле values-elma365-stack.yaml отключите неиспользуемые компоненты, изменив значение в параметрах global.kube-prometheus-stack.enabled , global.grafana.enabled , global.descheduler.enabled , global.node-local-dns.enabled и global.audit.enabled на false , так как для их установки необходимы предварительные настройки. В параметрах elma365-addons.linkerd2 укажите требуемый namespace для сервиса Linkerd (например, namespace: linkerd ), содержимое сертификатов, ключа и срок действия сертификата crtExpiry . Обратите внимание, значение должно соответствовать дате истечения срока действия сертификата эмитента. identityTrustAnchorsPEM: | -----BEGIN CERTIFICATE----- содержимое сертификата ca.crt -----END CERTIFICATE----- identity: issuer: crtExpiry: 2023-03-30T05:28:39Z tls: crtPEM: | -----BEGIN CERTIFICATE----- содержимое сертификата issuer.crt -----END CERTIFICATE----- keyPEM: | -----BEGIN EC PRIVATE KEY----- содержимое сертификата issuer- private .pem -----END EC PRIVATE KEY----- Включите автомасштабирование сервисов, изменив значение в параметре elma365.global.autoscaling.enabled на true . Выполните установку следующей командой (обратите внимание на параметр --set global.elma365-addons.enabled=true ): helm upgrade --install elma365-stack elma365/elma365-stack \\ -f values-elma365-stack.yaml --set global.elma365-addons.enabled= true \\ --timeout=30m --wait [-n namespace] Добавьте аннотацию на namespace с приложением ELMA365 для автоматической инъекции контейнеров Linkerd-proxy в сервисы ELMA365 командой: kubectl annotate namespace default linkerd.io/inject=enabled Перезапустите все сервисы командой: kubectl rollout restart deploy [-n namespace] && kubectl rollout restart ds [-n namespace] Установка NodeLocal DNS Cache (опционально) Установка NodeLocal DNS Cache позволяет снизить нагрузку по DNS-запросам в кластере Kubernetes и повысить стабильность преобразования DNS-имён. Это позволит избежать правил DNAT, connection tracking и ограничений по количеству соединений. Получите IP-адрес сервиса kube-dns : kubectl get svc kube-dns -n kube-system -o jsonpath={.spec.clusterIP} В файле values-elma365-stack.yaml отключите неиспользуемые компоненты, изменив значение в параметрах global.kube-prometheus-stack.enabled , global.grafana.enabled , global.descheduler.enabled , global.linkerd2.enabled и global.audit.enabled на false , так как для их установки необходимы предварительные настройки. В параметрах elma365-addons.node-local-dns укажите следующие параметры: pillar_dns_domain — домен кластера; pillar_dns_server — IP-адрес сервиса kube-dns ; pillar_local_dns — локальный IP-адрес для NodeLocal DNS Cache. Выполните установку командой (обратите внимание на параметр --set global.elma365-addons.enabled=true ): helm upgrade --install elma365-stack elma365/elma365-stack \\ -f values-elma365-stack.yaml --set global.elma365-addons.enabled= true \\ --timeout=30m --wait [-n namespace] Установка Kyverno (опционально) Kyverno позволяет управлять специфическими конфигурациями среды независимо от конфигураций ресурсов, применять передовые методы настройки для своих кластеров, в частности, путём блокировки или изменения запросов API. Политика добавления пользовательских сертификатов CA во все контейнеры В некоторых случаях требуется доверять пользовательским сертификатам CA. Kyverno позволяет автоматически монтировать их в контейнеры. Политика добавляет том, содержащий сертификат, ко всем контейнерам с меткой tier=elma365 . Создайте ConfigMap с сертификатом корневого CA. kubectl create configmap elma365-onpremise-ca --from-file=/etc/ssl/certs/rootCA.pem [-n namespace] В файле values-elma365-stack.yaml включите Kyverno, изменив значение параметра global.kyverno.enabled на true . Затем отключите неиспользуемые компоненты, изменив значение у дополнения в параметре global на false , так как для их установки необходимы предварительные настройки. В параметрах elma365-addons.kyverno укажите требуемый namespace для сервиса Kyverno , например, namespace: kyverno . Затем включите политику добавления сертификатов, изменив значение в параметре elma365-addons.kyverno.injectСerts.enabled на true , укажите имя ConfigMap с сертификатом корневого CA. В параметре injectNamespace укажите список namespace , в которых будет применена политика добавления сертификатов. Создайте namespace для сервиса Kyverno командой: kubectl create namespace kyverno Выполните установку следующей командой (обратите внимание на параметр --set global.elma365-addons.enabled=true : helm upgrade --install elma365-stack elma365/elma365-stack \\ -f values-elma365-stack.yaml --set global.elma365-addons.enabled= true \\ --timeout=30m --wait [-n namespace] Перезапустите все сервисы командой: kubectl rollout restart deploy [-n namespace] && kubectl rollout restart ds [-n namespace] Обновление версии ELMA365 Обновите список чартов в репозитории, выполнив команду: helm repo update Используйте файл values-elma365-stack.yaml , сохранённый на этапе установки, а затем выполните команду: helm upgrade --install elma365-stack elma365/elma365-stack -f values-elma365-stack.yaml --timeout=30m --wait [-n namespace] В случае изменения строк подключения (сonnection strings) к БД при обновлении приложения перезапустите все сервисы командой: kubectl default rollout restart deploy [-n namespace] && kubectl default rollout restart ds [-n namespace] Удаление чарта elma365 Для удаления пакета ELMA365 посмотрите список установленных релизов, а затем выполните команду удаления: helm list [-n namespace] helm uninstall elma365-stack [-n namespace] Параметры чарта elma365-stack Имя Описание Значение по умолчанию Глобальные параметры global.elma365.enabled Включить установку приложения ELMA365 true global.elma365-dbs.enabled Включить установку баз данных true global.postgresql.enabled Включить PostgreSQL в установку баз данных true global.mongodb.enabled Включить MongoDB в установку баз данных true global.redis.enabled Включить Redis в установку баз данных true global.rabbitmq.enabled Включить RabbitMQ в установку баз данных true global.minio. Включить MinIO для S3 хранилища в установку баз данных true global.elasticsearch.enabled Включить Elasticsearch в установку баз данных (включается для ELMA Bot) false global.elma365-addons.enabled Включить установку дополнений для ELMA365 false global.kube-prometheus-stack.enabled Включить Prometheus в установку дополнений для ELMA365 (перед установкой необходимо создать namespace monitoring ) true global.grafana.enabled Включить Grafana в установку дополнений для ELMA365 true global.linkerd2.enabled Включить Linkerd в установку дополнений для ELMA365 true global.descheduler.enabled Включить Descheduler в установку дополнений для ELMA365 (необходимо не менее 3 узлов в кластере) false global.node-local-dns.enabled Включить NodeLocal DNS Cache в установку дополнений для ELMA365 true global.audit.enabled Включить сервис Аудит безопасности в установку дополнений для ELMA365 true Глобальные параметры ELMA365 elma365.global.host Домен (FQDN) или IP-адрес, по которому будет доступна система example.ru elma365.global.ingress.hostEnabled Включение host в ingress (значение берётся из global.host ). false elma365.global.ingress.onpremiseTls.enabled Включение https false elma365.global.ingress.onpremiseTls.secret Имя секрета с сертификатами для работы https \"elma365-onpremise-tls\" elma365.global.ingress.onpremiseTls.enabledCA Включение сертификата корневого CA для работы https с самоподписанным сертификатом false elma365.global.ingress.onpremiseTls.configCA Имя конфигмапы с сертификатом корневого CA для работы https с самоподписанным сертификатом \"elma365-onpremise-ca\" elma365.global.ingress.annotations Аннотации для ingress {\"kubernetes.io/ingress.class\": \"nginx\"} elma365.global.autoscaling.enabled Включение автомасштабирования сервисов true elma365.global.autoscaling.minReplicas Минимальное количество реплик 1 elma365.global.autoscaling.maxReplicas Максимальное количество реплик 9 elma365.global.dashboard.enabled Включение дэшбордов для Grafana false elma365.global.image.repository Адрес для registry hub.elma365.tech elma365.global.image.dockerRegistry Адрес для registry \" \" elma365.global.image.pullSecret Секрет с правами доступа к приватному registry, должен быть создан вручную, зашифрованный в Base64 [yandexsecret] Дополнительные параметры elma365.global.postgres.maxIdleConns Максимальное количество подключений к главному узлу PostgreSQL в пуле незанятых подключений 50 elma365.global.postgres.maxOpenConns Максимальное количество открытых подключений к главному узлу PostgreSQL из пула 150 elma365.global.postgres.maxConnLife Максимальное время жизни подключения к главному узлу PostgreSQL из пула 1m elma365.global.postgres.poolMaxIdleConns Максимальное количество подключений к репликам PostgreSQL в пуле незанятых подключений 50 elma365.global.postgres.poolMaxOpenConns Максимальное количество открытых подключений к репликам PostgreSQL из пула 150 elma365.global.postgres.poolConnMaxLifetime Максимальное время жизни подключения к репликам PostgreSQL из пула 5m elma365.global.maxGrpcMessageSize Максимальный размер ответов 8388608 elma365.global.maxGrpcBackoffDelay Максимальная задержка между попытками установки GRPC-соединения 2s elma365.global.activeDeadlineSeconds Количество секунд, которое отводится всему Job на выполнение 3000 elma365.global.curlCreateCompanyMaxTime Количество секунд, которое отводится Job на выполнение создания компании 1800 elma365.global.curlMigrationsMaxTime Количество секунд, которое отводится Job на выполнение миграции 3000 Общие параметры elma365.debug Включить режим отладки платформы false elma365.bootstrapCompany.email Электронная почта администратора admin@mail.com elma365.bootstrapCompany.password Пароль администратора test elma365.bootstrapCompany.locale Язык установленной системы, возможные варианты: ru-RU, en-US, sk-SK ru-RU elma365.language.default Язык установленной системы, возможные варианты: ru-RU, en-US, sk-SK ru-RU Строки подключения (сonnection strings) для подключения к БД elma365.db.psqlUrl Строка подключения к БД PostgreSQL \"db.psqlUrl: 'postgres:// postgres:pgpassword@ postgres.default.svc.cluster. local:5432/elma365?sslmode=disable\" elma365.db.psqlSecret Имя секрета со строкой подключения к БД PostgreSQL, зашифрованной в Base64 (ключ PSQL_URL) \" \" elma365.db.roPsqlUrl Строка подключения к БД PostgreSQL только для чтения \" \" elma365.db.roPsqlSecret Имя секрета со строкой подключения к БД PostgreSQL только для чтения, зашифрованной в Base64 (ключ RO_POSTGRES_URL) \" \" elma365.db.mongoUrl Строка подключения к БД MongoDB для приложения \"mongodb://elma365:mongopassword@ mongo.default.svc.cluster.local: 27017/elma365?ssl=false&replicaSet= rs0&readPreference= secondaryPreferred\" elma365.db.mongoSecret Имя секрета со строкой подключения к БД MongoDB для приложения, зашифрованной в Base64 (ключ MONGO_URL) \" \" elma365.db.vahterMongoUrl Строка подключения к БД MongoDB для сервера авторизации \"mongodb://elma365:mongopassword@ mongo.default.svc.cluster.local: 27017/elma365?ssl=false&replicaSet= rs0&readPreference= secondaryPreferred\" elma365.db.vahterMongoSecret Имя секрета со строкой подключения к БД MongoDB для сервера авторизации \" \" elma365.db.redisUrl Строка подключения к Redis \"redis://redis.default.svc.cluster.local:6379/0\" elma365.db.redisSecret Имя секрета со строкой подключения к Redis, зашифрованной в Base64 (ключ REDIS_URL) \" \" elma365.db.amqpUrl Строка подключения к RabbitMQ \"amqp://elma365:rmqpassword@ rabbitmq.default.svc. cluster.local:5672/elma365\" elma365.db.amqpSecret Имя секрета со строкой подключения к RabbitMQ, зашифрованной в Base64 (ключ AMQP_URL) \" \" elma365.db.s3.method Метод запросов PUT elma365.db.s3.accesskeyid Имя пользователя PZSF73JG72Ksd955JKU1HIA elma365.db.s3.secretaccesskey Пароль для пользователя aFDkj28Jbs2JKbnvJH678MNwiz88zKjsuNBHHs elma365.db.s3.bucket Список бакетов s3elma365 elma365.db.s3.backend.address Адрес S3 example.ru elma365.db.s3.backend.region Регион us-east-1 elma365.db.s3.ssl.enabled Включение SSL \" false \" elma365.db.s3Secret Имя секрета с подключением к S3 хранилищу файлов, зашифрованной в Base64 # (ключи S3_BACKEND_ADDRESS, S3_REGION, S3_KEY, S3_SECRET, S3_BUCKET, S3_SSL_ENABLED, S3_UPLOAD_METHOD) \" \" Настройки для подключения к SMTP-серверу отправки почты elma365.mailer.smtp.host Адрес SMTP-сервера \" \" elma365.mailer.smtp.port Порт SMTP-сервера \" \" elma365.mailer.smtp.from Адрес отправителя электронной почты \" \" elma365.mailer.smtp.user Пользователь для авторизации на SMTP-сервере \" \" elma365.mailer.smtp.password Пароль для авторизации на SMTP-сервере \" \" elma365.mailer.smtp.needTLS Используется ли шифрование false Глобальные параметры сервиса «Аудит безопасности» elma365-addons.audit.global.psql_url Строка подключения к БД PostgreSQL \"postgresql://postgres:pgpassword@ postgres.default.svc.cluster. local:5432/audit?sslmode=disable\" elma365-addons.audit.image.repository Адрес для registry hub.elma365.tech elma365-addons.audit.image.pullSecret Секрет с правами доступа к приватному registry, должен быть создан вручную, зашифрованный в Base64 [yandexsecret] install-kontur-tunnel.html install-kubernetes.html Была ли статья полезной? Спасибо за ваш отзыв! × Ваш отзыв успешно отправлен! Спасибо за обратную связь. × Уточните, почему: Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина × Расскажите, что вам не понравилось в статье: Да Нет Выберите вариант Рекомендации не помогли Текст трудно понять Нет ответа на мой вопрос Содержание статьи не соответствует заголовку Другая причина В этой статье API TS SDK Community Академия Платформа ECM Service Проекты Отправить фидбэк Задать вопрос Ваш фидбэк отправлен. © 2025 ELMA365 © 2025 ELMA365 elma365.com",
  "links": [
    "https://elma365.com/ru/help",
    "https://elma365.com/ru/help/platform/get-trial.html",
    "https://elma365.com/ru/help/ecm/ecm-functions.html",
    "https://elma365.com/ru/help/crm/crm-functions.html",
    "https://elma365.com/ru/help/projects/projects-functions.html",
    "https://elma365.com/ru/help/service/service-functions.html",
    "https://elma365.com/ru/help/kedo/kedo.html",
    "https://elma365.com/ru/help/business_solutions/-elma365-store.html",
    "https://elma-academy.com/ru/",
    "https://community.elma365.com/ru/",
    "https://api.elma365.com/ru/",
    "https://tssdk.elma365.com/latest/",
    "https://elma365.com/ru/",
    "https://elma365.com/ru/help/ecm/ru/help/platform/elma365-on-premises.html",
    "https://elma365.com/ru/help/ecm/ru/help/platform/postgresql.html",
    "https://elma365.com/ru/help/ecm/ru/help/platform/elma365-enterprise-on-premises.html",
    "https://elma365.com/ru/help/ecm/ru/help/platform/database-backup-and-recovery.html",
    "https://elma365.com/ru/help/ecm/ru/help/platform/install-kontur-tunnel.html",
    "https://elma365.com/ru/help/ecm/ru/help/platform/install-kubernetes.html",
    "https://tssdk.elma365.com/",
    "https://community.elma365.com/",
    "https://elma-academy.com/ru/elma365",
    "https://navigator.sk.ru/orn/1122971",
    "https://vkvideo.ru/@elma_bpm",
    "https://vk.com/elma_bpm",
    "https://t.me/elmaday",
    "https://dzen.ru/elma"
  ],
  "last_crawled": "2025-11-29T21:51:51.540929",
  "metadata": {
    "depth": 10,
    "saved_at": "2025-11-29T21:51:51.602536"
  }
}